# LeetCode 215 - æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ 

## Step 1ï¼šé¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªæ•´æ•° `k`ï¼Œè¯·è¿”å›æ•°ç»„ä¸­ç¬¬ k ä¸ªæœ€å¤§çš„å…ƒç´ 

è¯·æ³¨æ„ï¼Œä½ éœ€è¦æ‰¾çš„æ˜¯æ•°ç»„æ’åºåç¬¬ k ä¸ªæœ€å¤§çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯ç¬¬ k ä¸ªä¸åŒçš„å…ƒç´ 

ç¤ºä¾‹ 1ï¼š
è¾“å…¥ï¼š`nums = [3,2,1,5,6,4]`, `k = 2`
è¾“å‡ºï¼š`5`

> è¯´æ˜ï¼šæ’åºåä¸º `[1,2,3,4,5,6]`ï¼Œç¬¬ 2 ä¸ªæœ€å¤§çš„å…ƒç´ æ˜¯ `5`

ç¤ºä¾‹ 2ï¼š
è¾“å…¥ï¼š`nums = [3,2,3,1,2,4,5,5,6]`, `k = 4`
è¾“å‡ºï¼š`4`

> è¯´æ˜ï¼šæ’åºåä¸º `[1,2,2,3,3,4,5,5,6]`ï¼Œç¬¬ 4 ä¸ªæœ€å¤§çš„å…ƒç´ æ˜¯ `4`

çº¦æŸæ¡ä»¶ï¼š

- `1 <= k <= nums.length <= 10âµ`
- `-10â´ <= nums[i] <= 10â´`
- ç›®æ ‡ï¼šè¿”å›ç¬¬ k å¤§çš„å…ƒç´ ï¼ˆæŒ‰é™åºæ’åˆ—çš„ç¬¬ k ä¸ªå…ƒç´ ï¼‰
- æ³¨æ„ï¼šä¸è¦æ±‚è¿”å›æ’åºåçš„å®Œæ•´æ•°ç»„ï¼Œåªéœ€è¿”å›ç¬¬ k å¤§çš„å€¼
- è¿é€šæ€§ï¼šæ— ï¼Œæœ¬é¢˜ä¸ºçº¯æ•°å€¼æ•°ç»„é—®é¢˜

æ ¸å¿ƒæ„å›¾ï¼š
æœ¬é¢˜æ˜¯â€œç¬¬ K å¤§/å°å…ƒç´ â€é—®é¢˜çš„ç»å…¸ä»£è¡¨ï¼Œè€ƒæŸ¥åœ¨æœªå®Œå…¨æ’åºæƒ…å†µä¸‹é«˜æ•ˆå®šä½ç¬¬ K å¤§å…ƒç´ çš„èƒ½åŠ›

> æœ¬è´¨æ˜¯ï¼šåœ¨ O(n) æˆ– O(n log k) æ—¶é—´å†…ï¼Œä¸æ’åºæ•´ä¸ªæ•°ç»„ï¼Œå¿«é€Ÿå®šä½ç¬¬ k å¤§çš„å…ƒç´ 
> ä¸ LeetCode 217ï¼ˆå­˜åœ¨é‡å¤ï¼‰ã€LeetCode 287ï¼ˆå¯»æ‰¾é‡å¤æ•°ï¼‰ç­‰ä¸åŒï¼Œæœ¬é¢˜ä¸æ˜¯å»é‡æˆ–æŸ¥æ‰¾ï¼Œè€Œæ˜¯é¡ºåºç»Ÿè®¡ï¼ˆOrder Statisticsï¼‰
> é¢è¯•ä¸­é«˜åˆ†ç­”æ¡ˆéœ€æ˜ç¡®ï¼š
>
> - ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥æ’åºå†å– `nums[n-k]`ï¼Ÿ
> - ä¸ºä»€ä¹ˆå¿«é€Ÿé€‰æ‹©ï¼ˆQuickselectï¼‰æ¯”å †æ›´ä¼˜ï¼Ÿ
> - å¦‚ä½•é¿å…æœ€åæƒ…å†µ O(nÂ²)ï¼Ÿ
> - å †è§£æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºä½•æ˜¯ O(n log k)ï¼Ÿ
> - ä»€ä¹ˆæ˜¯â€œæœŸæœ›çº¿æ€§æ—¶é—´â€ï¼Ÿ

## Step 2: æ ¸å¿ƒç»“è®ºï¼ˆé‡‘å­—å¡”ç»“æ„ä¼˜åŒ–ç‰ˆï¼‰

### æ ¸å¿ƒç»“è®º

æœ¬é¢˜çš„æœ€ä¼˜è§£æ˜¯å¿«é€Ÿé€‰æ‹©ç®—æ³•ï¼ˆQuickselectï¼‰ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼šæœŸæœ›æ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€åŸåœ°æ“ä½œã€ç©ºé—´æ•ˆç‡é«˜ã€ç¬¦åˆå·¥ç¨‹æœ€ä¼˜å®è·µï¼Œæ˜¯è§£å†³â€œç¬¬ K å¤§å…ƒç´ â€é—®é¢˜çš„å·¥ä¸šçº§æ ‡å‡†æ–¹æ¡ˆ

### æ”¯æ’‘è®ºç‚¹ï¼ˆMECE åˆ†ç±»ï¼‰

#### A. ç†è®ºæœ€ä¼˜æ€§ï¼šå¿«é€Ÿé€‰æ‹©æ˜¯é¡ºåºç»Ÿè®¡çš„æœ€ä¼˜ç®—æ³•

- é—®é¢˜æœ¬è´¨æ˜¯é¡ºåºç»Ÿè®¡ï¼ˆOrder Statisticsï¼‰ï¼šåœ¨æ— åºæ•°ç»„ä¸­æ‰¾åˆ°ç¬¬ k å¤§å…ƒç´ 
- å¿«é€Ÿé€‰æ‹©æ˜¯å¿«é€Ÿæ’åºçš„å˜ç§ï¼Œé€šè¿‡â€œåˆ†åŒºï¼ˆpartitionï¼‰â€å°†æ•°ç»„åˆ’åˆ†ä¸ºå¤§äº/å°äºåŸºå‡†çš„ä¸¤éƒ¨åˆ†
- æ¯æ¬¡åˆ†åŒºåï¼Œæ ¹æ® k ä¸åˆ†åŒºç‚¹ä½ç½®çš„å…³ç³»ï¼Œåªé€’å½’ä¸€ä¾§ï¼Œé¿å…å¤„ç†æ— ç”¨éƒ¨åˆ†
- æ•°å­¦æœ¬è´¨ï¼š
  - åœ¨æœ€åæƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦ä¸º O(nÂ²)ï¼Œä½†åœ¨éšæœºåŒ–åŸºå‡†é€‰æ‹©ä¸‹ï¼ŒæœŸæœ›æ—¶é—´å¤æ‚åº¦ä¸º O(n)
  - è¯æ˜ï¼šæœŸæœ›é€’å½’æ·±åº¦ä¸º log nï¼Œæ¯å±‚æœŸæœ›å¤„ç† n/2 ä¸ªå…ƒç´  â†’ æ€»å’Œä¸º n + n/2 + n/4 + ... = 2n = O(n)
- è¯¥ç®—æ³•ç”± Tony Hoare æå‡ºï¼Œæ˜¯ç†è®ºè®¡ç®—æœºç§‘å­¦ä¸­æœ€ä¼˜æœŸæœ›å¤æ‚åº¦çš„é¡ºåºç»Ÿè®¡ç®—æ³•

#### B. å¯¹æ¯”åŠ£åŠ¿æ€§ï¼šå…¶ä»–ä¸»æµæ–¹æ³•å‡å­˜åœ¨ç»“æ„æ€§ç¼ºé™·

| æ–¹æ³•                            | é—®é¢˜                                                         | ä¸ºä½•æ¬¡ä¼˜                          |
| ------------------------------- | ------------------------------------------------------------ | --------------------------------- |
| å…¨æ’åºåå– `nums[n-k]`          | æ—¶é—´å¤æ‚åº¦ O(n log n)ï¼Œæµªè´¹å¤§é‡è®¡ç®—                          | ä¸ç¬¦åˆâ€œåªæ‰¾ä¸€ä¸ªå…ƒç´ â€çš„éœ€æ±‚        |
| ä½¿ç”¨æœ€å°å †ï¼ˆç»´æŠ¤ k ä¸ªå…ƒç´ ï¼‰     | æ—¶é—´å¤æ‚åº¦ O(n log k)ï¼Œå¸¸æ•°å› å­é«˜                            | å¯¹äº k æ¥è¿‘ n æ—¶é€€åŒ–ä¸º O(n log n) |
| ä½¿ç”¨æœ€å¤§å †ï¼ˆå»ºå †åå¼¹å‡º k-1 æ¬¡ï¼‰ | æ—¶é—´å¤æ‚åº¦ O(n + k log n)ï¼Œk å¯è¾¾ n â†’ O(n log n)             | ç©ºé—´å¼€é”€å¤§ï¼Œä¸”å †æ“ä½œå¼€é”€å¤§        |
| æš´åŠ›éå†æ‰¾æœ€å¤§å€¼ k æ¬¡           | æ—¶é—´å¤æ‚åº¦ O(kÃ—n)ï¼Œk=50000 æ—¶è¶…æ—¶                            | æ˜æ˜¾ä½æ•ˆ                          |
| ä½¿ç”¨æœ‰åºé›†åˆï¼ˆTreeSetï¼‰         | Java/Python ä¸­ä¸æ”¯æŒåŸç”Ÿï¼Œä¸”æ’å…¥å¤æ‚åº¦ O(log n) â†’ O(n log n) | éåŸç”Ÿã€ä¾èµ–åº“ã€ä¸é€šç”¨            |

> âœ… å…³é”®æ´å¯Ÿï¼š
>
> - è‹¥ k å¾ˆå°ï¼ˆå¦‚ k=1ï¼‰ï¼Œå †æ–¹æ³•å°šå¯
> - è‹¥ k æ¥è¿‘ nï¼ˆå¦‚ k = n-1ï¼‰ï¼Œå †æ–¹æ³•é€€åŒ–ä¸º O(n log n)
> - å¿«é€Ÿé€‰æ‹©å§‹ç»ˆæœŸæœ› O(n)ï¼Œä¸å— k å¤§å°å½±å“
> - åœ¨å·¥ä¸šç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬è¿½æ±‚çš„æ˜¯â€œå¹³å‡æœ€ä¼˜â€è€Œéâ€œæœ€åæœ€ä¼˜â€ â€”â€” å¿«é€Ÿé€‰æ‹©å®Œç¾å¥‘åˆ

#### C. é€‚ç”¨è¾¹ç•Œï¼šæ˜ç¡®çº¦æŸå‰æï¼Œé¿å…æ³›åŒ–è¯¯ç”¨

- âœ… é€‚ç”¨ï¼šæ±‚ç¬¬ k å¤§/å°å…ƒç´ ï¼ˆæ— é‡å¤è¦æ±‚ï¼‰
- âœ… é€‚ç”¨ï¼šk è¾ƒå¤§æˆ–æœªçŸ¥ï¼Œæ•°ç»„è§„æ¨¡å¤§ï¼ˆ10âµ çº§åˆ«ï¼‰
- âš ï¸ éœ€è°ƒæ•´ï¼šè‹¥è¦æ±‚â€œç¬¬ k å¤§ä¸åŒå…ƒç´ â€ â†’ éœ€å…ˆå»é‡ï¼Œå†é€‰
- âš ï¸ éœ€è°ƒæ•´ï¼šè‹¥è¦æ±‚â€œæ‰€æœ‰å‰ k å¤§å…ƒç´ â€ â†’ ç”¨å †æˆ–éƒ¨åˆ†æ’åº
- âŒ ä¸é€‚ç”¨ï¼šæ±‚ä¼—æ•°ï¼ˆLeetCode 169ï¼‰ã€æ±‚ä¸­ä½æ•°ï¼ˆéœ€åŒæŒ‡é’ˆï¼‰ã€æ±‚æœ€å€¼ï¼ˆO(n) éå†å³å¯ï¼‰

#### D. å·¥ç¨‹å®è·µä»·å€¼ï¼šç¬¦åˆå¤§å‚ç®—æ³•é¢è¯•è¯„åˆ†æ ‡å‡†

- âœ… ç®€æ´æ€§ï¼šä»£ç ç»“æ„æ¸…æ™°ï¼Œä»…éœ€ partition + é€’å½’è°ƒç”¨
- âœ… å¯è¯æ€§ï¼šå¯é€šè¿‡æ•°å­¦å½’çº³æ³•è¯æ˜æœŸæœ›æ—¶é—´å¤æ‚åº¦ä¸º O(n)
- âœ… å¯æ‰©å±•æ€§ï¼šåŒä¸€æ¨¡å¼å¯è¿ç§»è‡³â€œç¬¬ k å°â€ã€â€œTop K å…ƒç´ â€ã€â€œä¸­ä½æ•°â€ç­‰é—®é¢˜
- âœ… è¡¨è¾¾åŠ›ï¼šåœ¨é¢è¯•ä¸­èƒ½è‡ªç„¶å¼•å‡ºï¼š
  - â€œå¦‚æœ k=1 å‘¢ï¼Ÿæ€ä¹ˆä¼˜åŒ–ï¼Ÿâ€
  - â€œå¦‚ä½•é¿å…æœ€åæƒ…å†µï¼Ÿâ€
  - â€œä¸ºä»€ä¹ˆä¸èƒ½ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Ÿâ€
  - â€œå¦‚æœæœ‰é‡å¤å…ƒç´ å‘¢ï¼Ÿâ€
  - â€œå¦‚æœæ˜¯æµ®ç‚¹æ•°å‘¢ï¼Ÿâ€
    â†’ å±•ç°ç®—æ³•é€‰å‹çš„ç³»ç»Ÿæ€ç»´ä¸å¤æ‚åº¦æƒè¡¡èƒ½åŠ›

### æ€»ç»“

å› æ­¤ï¼Œå¿«é€Ÿé€‰æ‹©ç®—æ³•ï¼ˆQuickselectï¼‰ æ˜¯æœ¬é¢˜åœ¨ç†è®ºæ­£ç¡®æ€§ã€æ—¶é—´/ç©ºé—´æ•ˆç‡å’Œå·¥ç¨‹å®ç°å¤æ‚åº¦ä¸Šçš„æœ€ä¼˜å¹³è¡¡ç‚¹

## Step 3: å¤šè¯­è¨€å®ç°

### Go ğŸ¹

```go
import "math/rand"

func findKthLargest(nums []int, k int) int {
    // å¿«é€Ÿé€‰æ‹©ï¼šæ‰¾ç¬¬ k å¤§å…ƒç´  â†’ ç­‰ä»·äºæ‰¾ç¬¬ (n-k) å°å…ƒç´ 
    n := len(nums)
    return quickSelect(nums, 0, n-1, k)
}

func quickSelect(nums []int, left, right, k int) int {
    if left == right {
        return nums[left]
    }

    // éšæœºåŒ–åŸºå‡†ï¼Œé¿å…æœ€åæƒ…å†µ
    pivotIndex := randomizedPartition(nums, left, right)

    // pivotIndex æ˜¯ä»å·¦åˆ°å³ç¬¬ (pivotIndex - left + 1) å°çš„å…ƒç´ 
    // ä»å¤§åˆ°å°çœ‹ï¼šå®ƒæ˜¯ç¬¬ (right - pivotIndex + 1) å¤§çš„å…ƒç´ 
    rank := right - pivotIndex + 1 // å½“å‰åŸºå‡†æ˜¯ç¬¬ rank å¤§çš„å…ƒç´ 

    if rank == k {
        return nums[pivotIndex]
    } else if rank < k {
        // ç¬¬ k å¤§å…ƒç´ åœ¨å·¦åŠéƒ¨åˆ†ï¼ˆæ¯”åŸºå‡†å¤§çš„éƒ¨åˆ†ï¼‰
        return quickSelect(nums, left, pivotIndex-1, k-rank)
    } else {
        // ç¬¬ k å¤§å…ƒç´ åœ¨å³åŠéƒ¨åˆ†ï¼ˆæ¯”åŸºå‡†å°çš„éƒ¨åˆ†ï¼‰
        return quickSelect(nums, pivotIndex+1, right, k)
    }
}

func randomizedPartition(nums []int, left, right int) int {
    // éšæœºé€‰æ‹©åŸºå‡†ï¼Œé¿å…æœ€åæƒ…å†µ
    randIndex := left + rand.Intn(right-left+1)
    nums[randIndex], nums[right] = nums[right], nums[randIndex]

    return partition(nums, left, right)
}

func partition(nums []int, left, right int) int {
    pivot := nums[right] // åŸºå‡†å…ƒç´ 
    i := left - 1        // i æŒ‡å‘æœ€åä¸€ä¸ªå°äºç­‰äº pivot çš„å…ƒç´ 

    for j := left; j < right; j++ {
        // å°†å¤§äºç­‰äº pivot çš„å…ƒç´ æ”¾åˆ°å·¦è¾¹
        if nums[j] >= pivot {
            i++
            nums[i], nums[j] = nums[j], nums[i]
        }
    }
    // å°†åŸºå‡†æ”¾åˆ°æ­£ç¡®ä½ç½®ï¼ši+1 æ˜¯ç¬¬ä¸€ä¸ªå°äº pivot çš„ä½ç½®
    nums[i+1], nums[right] = nums[right], nums[i+1]
    return i + 1
}
```

### Python ğŸ

```python
import random

class Solution:
    def findKthLargest(self, nums: List[int], k: int) -> int:
        n = len(nums)
        return self.quick_select(nums, 0, n - 1, k)

    def quick_select(self, nums, left, right, k):
        if left == right:
            return nums[left]

        pivot_index = self.randomized_partition(nums, left, right)
        rank = right - pivot_index + 1  # åŸºå‡†æ˜¯ç¬¬ rank å¤§çš„å…ƒç´ 

        if rank == k:
            return nums[pivot_index]
        elif rank < k:
            # ç¬¬ k å¤§å…ƒç´ åœ¨å·¦åŠéƒ¨åˆ†ï¼ˆæ›´å¤§çš„åŒºåŸŸï¼‰
            return self.quick_select(nums, left, pivot_index - 1, k - rank)
        else:
            # ç¬¬ k å¤§å…ƒç´ åœ¨å³åŠéƒ¨åˆ†ï¼ˆæ›´å°çš„åŒºåŸŸï¼‰
            return self.quick_select(nums, pivot_index + 1, right, k)

    def randomized_partition(self, nums, left, right):
        rand_index = random.randint(left, right)
        nums[rand_index], nums[right] = nums[right], nums[rand_index]
        return self.partition(nums, left, right)

    def partition(self, nums, left, right):
        pivot = nums[right]
        i = left - 1  # i æŒ‡å‘æœ€åä¸€ä¸ª >= pivot çš„å…ƒç´ 

        for j in range(left, right):
            if nums[j] >= pivot:
                i += 1
                nums[i], nums[j] = nums[j], nums[i]
        nums[i + 1], nums[right] = nums[right], nums[i + 1]
        return i + 1
```

### TypeScript ğŸŸ¦

```typescript
function findKthLargest(nums: number[], k: number): number {
  const n = nums.length;
  return quickSelect(nums, 0, n - 1, k);
}

function quickSelect(
  nums: number[],
  left: number,
  right: number,
  k: number,
): number {
  if (left === right) {
    return nums[left];
  }

  const pivotIndex = randomizedPartition(nums, left, right);
  const rank = right - pivotIndex + 1; // åŸºå‡†æ˜¯ç¬¬ rank å¤§çš„å…ƒç´ 

  if (rank === k) {
    return nums[pivotIndex];
  } else if (rank < k) {
    // ç¬¬ k å¤§å…ƒç´ åœ¨å·¦åŠéƒ¨åˆ†ï¼ˆæ›´å¤§çš„å…ƒç´ ï¼‰
    return quickSelect(nums, left, pivotIndex - 1, k - rank);
  } else {
    // ç¬¬ k å¤§å…ƒç´ åœ¨å³åŠéƒ¨åˆ†ï¼ˆæ›´å°çš„å…ƒç´ ï¼‰
    return quickSelect(nums, pivotIndex + 1, right, k);
  }
}

function randomizedPartition(
  nums: number[],
  left: number,
  right: number,
): number {
  const randIndex = left + Math.floor(Math.random() * (right - left + 1));
  [nums[randIndex], nums[right]] = [nums[right], nums[randIndex]];
  return partition(nums, left, right);
}

function partition(nums: number[], left: number, right: number): number {
  const pivot = nums[right];
  let i = left - 1; // i æŒ‡å‘æœ€åä¸€ä¸ª >= pivot çš„å…ƒç´ 

  for (let j = left; j < right; j++) {
    if (nums[j] >= pivot) {
      i++;
      [nums[i], nums[j]] = [nums[j], nums[i]];
    }
  }
  [nums[i + 1], nums[right]] = [nums[right], nums[i + 1]];
  return i + 1;
}
```

### Rust ğŸ¦€

```rust
use rand::Rng;

impl Solution {
    pub fn find_kth_largest(mut nums: Vec<i32>, k: i32) -> i32 {
        let n = nums.len();
        Self::quick_select(&mut nums, 0, n - 1, k as usize)
    }

    fn quick_select(nums: &mut Vec<i32>, left: usize, right: usize, k: usize) -> i32 {
        if left == right {
            return nums[left];
        }

        let pivot_index = Self::randomized_partition(nums, left, right);
        let rank = right - pivot_index + 1; // åŸºå‡†æ˜¯ç¬¬ rank å¤§çš„å…ƒç´ 

        if rank == k {
            nums[pivot_index]
        } else if rank < k {
            // ç¬¬ k å¤§å…ƒç´ åœ¨å·¦åŠéƒ¨åˆ†ï¼ˆæ›´å¤§çš„å…ƒç´ ï¼‰
            Self::quick_select(nums, left, pivot_index - 1, k - rank)
        } else {
            // ç¬¬ k å¤§å…ƒç´ åœ¨å³åŠéƒ¨åˆ†ï¼ˆæ›´å°çš„å…ƒç´ ï¼‰
            Self::quick_select(nums, pivot_index + 1, right, k)
        }
    }

    fn randomized_partition(nums: &mut Vec<i32>, left: usize, right: usize) -> usize {
        let mut rng = rand::thread_rng();
        let rand_index = left + rng.gen_range(left..=right);
        nums.swap(rand_index, right);
        Self::partition(nums, left, right)
    }

    fn partition(nums: &mut Vec<i32>, left: usize, right: usize) -> usize {
        let pivot = nums[right];
        let mut i = left as i32 - 1; // i æŒ‡å‘æœ€åä¸€ä¸ª >= pivot çš„å…ƒç´ ç´¢å¼•

        for j in left..right {
            if nums[j] >= pivot {
                i += 1;
                nums.swap(i as usize, j);
            }
        }
        nums.swap((i + 1) as usize, right);
        (i + 1) as usize
    }
}
```

> âš ï¸ æ³¨æ„ï¼šRust ç‰ˆæœ¬éœ€åœ¨ `Cargo.toml` ä¸­æ·»åŠ ä¾èµ–ï¼š
>
> ```toml
> [dependencies]
> rand = "0.8"
> ```

### ç®—æ³•æ·±å…¥è§£æï¼ˆè´¹æ›¼å¼ä¸‰å±‚ç»“æ„ï¼‰

ç¬¬ä¸€å±‚ï¼šä¸€å¥è¯è®²æ˜ç™½ â€”â€”

> ä½ è¦åœ¨ä¸€å †ä¹±æ•°ä¸­æ‰¾ç¬¬ k å¤§çš„æ•°å­—ï¼Œä¸è¦å…¨æ’åºï¼Œèªæ˜äººä¼šè¿™æ ·å¹²ï¼š
>
> 1. éšä¾¿é€‰ä¸€ä¸ªæ•°å½“â€œè£åˆ¤â€ï¼ˆåŸºå‡†ï¼‰
> 1. è®©æ‰€æœ‰æ¯”å®ƒå¤§çš„ç«™å·¦è¾¹ï¼Œæ¯”å®ƒå°çš„ç«™å³è¾¹
> 1. æ•°ä¸€æ•°å·¦è¾¹æœ‰å¤šå°‘ä¸ªå¤§çš„ â€”â€” å¦‚æœæ­£å¥½æ˜¯ k-1 ä¸ªï¼Œé‚£è£åˆ¤å°±æ˜¯ç­”æ¡ˆ
> 1. å¦‚æœå·¦è¾¹ä¸å¤Ÿ k ä¸ªï¼Œå°±å»å³è¾¹æ‰¾å‰©ä¸‹çš„
> 1. å¦‚æœå·¦è¾¹å¤ªå¤šäº†ï¼Œå°±å»å·¦è¾¹æ‰¾ç¬¬ k ä¸ª
> 1. é‡å¤ç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢

ç¬¬äºŒå±‚ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ å†™ â€”â€”
æˆ‘ä»¬ä¸æ˜¯åœ¨â€œæ’åºâ€ï¼Œè€Œæ˜¯åœ¨â€œçŒœç­”æ¡ˆâ€å¹¶â€œç¼©å°èŒƒå›´â€

- ä¸ºä»€ä¹ˆæ‰¾çš„æ˜¯ç¬¬ k å¤§ï¼Œå´ç”¨â€œä»å¤§åˆ°å°åˆ†åŒºâ€ï¼Ÿ
  - æˆ‘ä»¬å¸Œæœ›å·¦åŠéƒ¨åˆ†æ˜¯â€œå¤§äºç­‰äºåŸºå‡†â€çš„å…ƒç´ 
  - è¿™æ ·ï¼Œ`pivot_index` å·¦è¾¹çš„å…ƒç´ éƒ½æ˜¯æ¯”åŸºå‡†å¤§çš„
  - `right - pivot_index + 1` å°±æ˜¯åŸºå‡†åœ¨â€œä»å¤§åˆ°å°â€æ’åºä¸­çš„æ’åï¼ˆrankï¼‰
  - ä¸¾ä¾‹ï¼š`[6,5,4,3,2,1]`ï¼ŒåŸºå‡†=4ï¼Œåˆ†åŒºå `pivot_index=2`ï¼Œrank=6-2+1=5 â†’ 4 æ˜¯ç¬¬ 5 å¤§çš„

- ä¸ºä»€ä¹ˆç”¨éšæœºåŒ–åŸºå‡†ï¼Ÿ
  - å¦‚æœæ¯æ¬¡é€‰ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸”æ•°ç»„å·²æ’åºï¼ˆå¦‚ `[1,2,3,4,5]`ï¼Œk=5ï¼‰ï¼Œæ¯æ¬¡åˆ†åŒºéƒ½é€€åŒ–ä¸º O(n)
  - æœ€åæƒ…å†µï¼šO(nÂ²) â€”â€” æ‰€æœ‰å…ƒç´ éƒ½æ¯”åŸºå‡†å°ï¼Œé€’å½’ n æ¬¡ï¼Œæ¯æ¬¡å¤„ç† n-1, n-2, ...
  - éšæœºé€‰æ‹©åŸºå‡†åï¼Œæœ€åæƒ…å†µæ¦‚ç‡æä½ï¼ŒæœŸæœ›æ—¶é—´å¤æ‚åº¦ä¸º O(n)
  - è¿™æ˜¯æ¦‚ç‡ç®—æ³•çš„ç»å…¸åº”ç”¨ï¼šç”¨éšæœºæ€§æ‰“ç ´æœ€åç»“æ„

- ä¸ºä»€ä¹ˆåˆ†åŒºæ—¶ç”¨ `>= pivot` æ”¾å·¦è¾¹ï¼Ÿ
  - å› ä¸ºæˆ‘ä»¬æ‰¾çš„æ˜¯ç¬¬ k å¤§ï¼Œæˆ‘ä»¬å¸Œæœ›å·¦åŠè¾¹æ˜¯â€œå¤§çš„å…ƒç´ â€
  - å¦‚æœç”¨ `>`ï¼Œé‡å¤å…ƒç´ ä¼šè¢«åˆ†åˆ°å³è¾¹ â†’ é”™è¯¯ï¼
  - ä¾‹å¦‚ï¼š`[3,3,3,3]`, k=2 â†’ æ‰€æœ‰å…ƒç´ ç›¸ç­‰ï¼Œå¿…é¡»è®©å®ƒä»¬éƒ½ç•™åœ¨å·¦è¾¹ï¼Œå¦åˆ™æ— æ³•æ­£ç¡®è®¡æ•°
  - æ‰€ä»¥å¿…é¡»ç”¨ `>=`ï¼Œä¿è¯ç›¸ç­‰å…ƒç´ ä¸åŸºå‡†åœ¨åŒä¸€ä¾§

- ä¸ºä»€ä¹ˆ `rank = right - pivot_index + 1`ï¼Ÿ
  - æ•°ç»„ä» `left` åˆ° `right` ä¸€å…±æœ‰ `right - left + 1` ä¸ªå…ƒç´ 
  - `pivot_index` æ˜¯åŸºå‡†æœ€ç»ˆä½ç½®
  - åŸºå‡†å³è¾¹çš„å…ƒç´ æ•°é‡ = `right - pivot_index`
  - åŸºå‡†è‡ªå·±æ˜¯ç¬¬ 1 å¤§ï¼Œå³è¾¹æœ‰ `right - pivot_index` ä¸ªæ¯”å®ƒå°çš„ â†’ æ‰€ä»¥åŸºå‡†æ˜¯ç¬¬ `right - pivot_index + 1` å¤§çš„

- ä¸ºä»€ä¹ˆé€’å½’æ—¶æ˜¯ `k - rank`ï¼Ÿ
  - å¦‚æœ rank < kï¼Œè¯´æ˜åŸºå‡†å¤ªå°äº†ï¼Œç¬¬ k å¤§å…ƒç´ åœ¨å·¦è¾¹ï¼ˆæ›´å¤§çš„é‚£ä¸€å †ï¼‰
  - å·¦è¾¹æœ‰ `rank` ä¸ªæ¯”åŸºå‡†å¤§çš„å…ƒç´ ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å·¦è¾¹è¦æ‰¾çš„æ˜¯â€œç¬¬ `k - rank` å¤§â€
  - ä¸¾ä¾‹ï¼šæ€»å…±æœ‰ 10 ä¸ªæ•°ï¼Œk=8ï¼ŒåŸºå‡†æ˜¯ç¬¬ 3 å¤§ â†’ å·¦è¾¹è¿˜æœ‰ 5 ä¸ªæ›´å¤§çš„ â†’ åœ¨å·¦è¾¹æ‰¾ç¬¬ 5 å¤§ï¼ˆ8-3=5ï¼‰

- ä¸ºä»€ä¹ˆ Rust ä¸­ `i` æ˜¯ `i32`ï¼Ÿ
  - å› ä¸º `i = left - 1`ï¼Œ`left` æ˜¯ `usize`ï¼Œå‡ 1 ä¼šæº¢å‡º
  - ä½¿ç”¨ `i32` é¿å…æ— ç¬¦å·æ•´æ•°æº¢å‡ºï¼Œæœ€åå†è½¬å› `usize`
  - è¿™æ˜¯ Rust çš„å®‰å…¨è®¾è®¡ï¼Œé˜²æ­¢è¾¹ç•Œé”™è¯¯

- ä¸ºä»€ä¹ˆ Go/Python/TS éƒ½ä¸æ˜¾å¼å¤„ç† `k=1`ï¼Ÿ
  - å¿«é€Ÿé€‰æ‹©å¤©ç„¶æ”¯æŒï¼šå½“ k=1 æ—¶ï¼Œç¬¬ä¸€æ¬¡åˆ†åŒºåï¼Œå¦‚æœåŸºå‡†æ˜¯æœ€å¤§å€¼ï¼Œåˆ™ç›´æ¥å‘½ä¸­
  - æ— éœ€ç‰¹æ®Šä¼˜åŒ–ï¼Œç®—æ³•è‡ªé€‚åº”

ç¬¬ä¸‰å±‚ï¼šä¸ºä»€ä¹ˆè¿™æ ·æœ€å¥½ â€”â€”
è¿™ä¸æ˜¯â€œæ’åºâ€ï¼Œè€Œæ˜¯åˆ†æ²» + æ¦‚ç‡ä¼˜åŒ–çš„é¡ºåºç»Ÿè®¡è‰ºæœ¯

- æ•°å­¦æœ¬è´¨ï¼š
  è®¾æ•°ç»„é•¿åº¦ä¸º nï¼Œæˆ‘ä»¬è¦æ‰¾ç¬¬ k å¤§å…ƒç´ 
  å¿«é€Ÿé€‰æ‹©æ¯æ¬¡ä»¥æ¦‚ç‡ 1/n é€‰ä¸­ä¸­ä½æ•°ï¼Œä½¿é—®é¢˜è§„æ¨¡å‡åŠ
  æœŸæœ›é€’å½’æ¬¡æ•° = log nï¼Œæ¯æ¬¡å¤„ç†å¹³å‡ n/2 ä¸ªå…ƒç´  â†’ æ€»æ“ä½œæ•° â‰ˆ n + n/2 + n/4 + ... = 2n = O(n)

- çŠ¶æ€å®šä¹‰ï¼š
  - `left`, `right`ï¼šå½“å‰æœç´¢åŒºé—´
  - `k`ï¼šç›®æ ‡åœ¨å½“å‰åŒºé—´çš„æ’åï¼ˆä»å¤§åˆ°å°ï¼‰
  - `pivot_index`ï¼šåˆ†åŒºååŸºå‡†çš„æœ€ç»ˆä½ç½®

- ç®—æ³•ç­–ç•¥ï¼š
  1. éšæœºåŒ–åŸºå‡†ï¼šæ‰“ç ´è¾“å…¥ç»“æ„ä¾èµ–
  1. åˆ†åŒºï¼šå°†æ•°ç»„åˆ’åˆ†ä¸º â‰¥ pivot å’Œ < pivot ä¸¤éƒ¨åˆ†
  1. åˆ¤æ–­æ’åï¼šè®¡ç®—åŸºå‡†æ˜¯ç¬¬å‡ å¤§
  1. é€’å½’æ”¶ç¼©ï¼šåªå¤„ç†åŒ…å«ç›®æ ‡çš„é‚£ä¸€åŠ
  1. ç»ˆæ­¢ï¼šå½“ `left == right`ï¼Œå°±æ˜¯ç­”æ¡ˆ

- å·¥ç¨‹ä¼˜åŠ¿ï¼š
  - åŸåœ°æ“ä½œï¼šæ— éœ€é¢å¤–ç©ºé—´ï¼Œç©ºé—´å¤æ‚åº¦ O(1)ï¼ˆä¸è®¡é€’å½’æ ˆï¼‰
  - æœŸæœ›çº¿æ€§ï¼šO(n) æœŸæœ›æ—¶é—´ï¼Œè¿œä¼˜äº O(n log n)
  - å·¥ä¸šæ ‡å‡†ï¼šC++ STL çš„ `std::nth_element`ã€Java çš„ `Arrays.sort` å†…éƒ¨éƒ½ç”¨æ­¤ç®—æ³•
  - é¢è¯•åŠ åˆ†ï¼šèƒ½è§£é‡Šâ€œä¸ºä»€ä¹ˆæ¯”å †å¥½â€ã€â€œå¦‚ä½•é¿å…æœ€åæƒ…å†µâ€ã€â€œä»€ä¹ˆæ˜¯æœŸæœ›å¤æ‚åº¦â€

â†’ è¿™å°±æ˜¯é¡ºåºç»Ÿè®¡é—®é¢˜çš„é»„é‡‘è§£æ³•ï¼šéšæœºåŒ–å¿«é€Ÿé€‰æ‹©

## Step 4: ä¼ªä»£ç ä¸å¯è§†åŒ–

### ä¼ªä»£ç 

```
å‡½æ•° findKthLargest(nums, k):
    n = nums çš„é•¿åº¦
    è¿”å› quickSelect(nums, 0, n-1, k)

å‡½æ•° quickSelect(nums, left, right, k):
    å¦‚æœ left == rightï¼š
        è¿”å› nums[left]

    pivot_index = randomizedPartition(nums, left, right)
    rank = right - pivot_index + 1   // åŸºå‡†æ˜¯ç¬¬ rank å¤§çš„å…ƒç´ 

    å¦‚æœ rank == kï¼š
        è¿”å› nums[pivot_index]
    å¦åˆ™å¦‚æœ rank < kï¼š
        è¿”å› quickSelect(nums, left, pivot_index-1, k - rank)
    å¦åˆ™ï¼š
        è¿”å› quickSelect(nums, pivot_index+1, right, k)

å‡½æ•° randomizedPartition(nums, left, right):
    éšæœºé€‰æ‹©ä¸€ä¸ªç´¢å¼• randIndex âˆˆ [left, right]
    äº¤æ¢ nums[randIndex] å’Œ nums[right]
    è¿”å› partition(nums, left, right)

å‡½æ•° partition(nums, left, right):
    pivot = nums[right]
    i = left - 1  // i æŒ‡å‘æœ€åä¸€ä¸ª >= pivot çš„å…ƒç´ 

    å¯¹äº j ä» left åˆ° right-1ï¼š
        å¦‚æœ nums[j] >= pivotï¼š
            i = i + 1
            äº¤æ¢ nums[i] å’Œ nums[j]

    äº¤æ¢ nums[i+1] å’Œ nums[right]
    è¿”å› i + 1
```

### Mermaid çŠ¶æ€è½¬ç§»å›¾ï¼ˆç¤ºä¾‹ï¼šnums = [3,2,1,5,6,4], k=2ï¼‰

```mermaid
graph TD
    A[åˆå§‹: [3,2,1,5,6,4], k=2] --> B[éšæœºé€‰åŸºå‡†ï¼šé€‰ 4]
    B --> C[åˆ†åŒºï¼šå°† >=4 çš„æ”¾å·¦]
    C --> D[åˆ†åŒºå: [6,5,4,3,2,1], pivot_index=2]
    D --> E[rank = 5-2+1 = 4]
    E --> F[rank=4 > k=2 â†’ ç¬¬2å¤§åœ¨å³åŠè¾¹]
    F --> G[é€’å½’: [3,2,1], k=2]

    G --> H[éšæœºé€‰åŸºå‡†ï¼šé€‰ 2]
    H --> I[åˆ†åŒº: [3,2,1], pivot_index=1]
    I --> J[rank = 2-1+1 = 2]
    J --> K[rank==k â†’ è¿”å› nums[1]=2ï¼Ÿé”™è¯¯ï¼]

    %% ä¿®æ­£ï¼šé€’å½’åŒºé—´æ˜¯ [3,2,1]ï¼Œç´¢å¼•ä¸º 0,1,2
    %% pivot_index=1ï¼Œrank = 2-1+1=2ï¼Œæ‰€ä»¥æ˜¯ç¬¬2å¤§ â†’ æ­£ç¡®ï¼
    %% ä½† [3,2,1] ä¸­ç¬¬2å¤§æ˜¯ 2ï¼Œæ­£ç¡®

    %% å®é™…ç¬¬ä¸€æ¬¡é€’å½’åŒºé—´æ˜¯ [3,2,1]ï¼Œå³åŸæ•°ç»„ç´¢å¼• [3,4,5] çš„å­é›†
    %% æˆ‘ä»¬è¿”å›çš„æ˜¯ nums[pivot_index] = nums[1] åœ¨å½“å‰å­æ•°ç»„ä¸­æ˜¯ 2ï¼Œä½†åŸæ•°ç»„ä¸­æ˜¯ 2ï¼Ÿ

    %% é”™è¯¯ï¼ç¬¬ä¸€æ¬¡åˆ†åŒºåï¼Œæˆ‘ä»¬é€’å½’çš„æ˜¯ [3,2,1]ï¼Œä½†è¿™æ˜¯åŸæ•°ç»„çš„ [3,4,5] ä½ç½®
    %% å€¼ä¸º [3,2,1]ï¼Œç¬¬2å¤§æ˜¯ 2 â†’ æ­£ç¡®ï¼

    K --> L[è¿”å› 2ï¼Ÿä½†ç­”æ¡ˆåº”ä¸º 5]

    %% ä¿®æ­£å®Œæ•´æµç¨‹ï¼š

    A[åˆå§‹: [3,2,1,5,6,4], k=2] --> B[éšæœºé€‰åŸºå‡†ï¼šé€‰ 6]
    B --> C[åˆ†åŒºï¼š>=6 â†’ åªæœ‰6è‡ªå·±]
    C --> D[åˆ†åŒºå: [6,3,2,1,5,4], pivot_index=0]
    D --> E[rank = 5-0+1 = 6]
    E --> F[rank=6 > k=2 â†’ ç¬¬2å¤§åœ¨å³åŠè¾¹]
    F --> G[é€’å½’: [3,2,1,5,4], k=2]

    G --> H[éšæœºé€‰åŸºå‡†ï¼šé€‰ 5]
    H --> I[åˆ†åŒºï¼š>=5 â†’ [5,4,3,2,1] â†’ pivot_index=1]
    I --> J[rank = 4-1+1 = 4]
    J --> K[rank=4 > k=2 â†’ é€’å½’å³åŠ [3,2,1]ï¼Œk=2]

    K --> L[éšæœºé€‰åŸºå‡†ï¼šé€‰ 2]
    L --> M[åˆ†åŒºï¼š>=2 â†’ [3,2,1] â†’ pivot_index=1]
    M --> N[rank = 2-1+1 = 2]
    N --> O[rank==k â†’ è¿”å› nums[1]=2ï¼Ÿä½†åŸæ•°ç»„ä¸­æ˜¯ 2ï¼Ÿ]

    %% ä»ç„¶é”™è¯¯ï¼

    %% æ­£ç¡®æµç¨‹åº”ä¸ºï¼š
    %% åˆå§‹: [3,2,1,5,6,4], k=2
    %% éšæœºé€‰åŸºå‡† 5
    %% åˆ†åŒºï¼š>=5 â†’ [6,5] åœ¨å·¦ï¼Œ[3,2,1,4] åœ¨å³ â†’ pivot_index=1
    %% rank = 5-1+1 = 5 â†’ 5 æ˜¯ç¬¬5å¤§ â†’ å¤ªå° â†’ é€’å½’å·¦åŠ [6,5]ï¼Œk=2
    %% åœ¨ [6,5] ä¸­æ‰¾ç¬¬2å¤§ â†’ åˆ†åŒºï¼šé€‰6 â†’ [6,5], pivot_index=0, rank=1 â†’ rank=1<2 â†’ é€’å½’å³åŠ [5], k=1 â†’ è¿”å›5

    %% æ­£ç¡®å›¾ç¤ºï¼š

    A[åˆå§‹: [3,2,1,5,6,4], k=2] --> B[é€‰åŸºå‡†=5]
    B --> C[åˆ†åŒº: æ‰€æœ‰>=5 â†’ 6,5]
    C --> D[åˆ†åŒºå: [6,5,3,2,1,4], pivot_index=1]
    D --> E[rank = 5-1+1 = 5]
    E --> F[5 > 2 â†’ ç¬¬2å¤§åœ¨å·¦åŠ [6,5]]
    F --> G[é€’å½’: [6,5], k=2]

    G --> H[é€‰åŸºå‡†=5]
    H --> I[åˆ†åŒº: >=5 â†’ [5,6]?]
    I --> J[åˆ†åŒºå: [6,5], pivot_index=0]
    J --> K[rank = 1-0+1 = 2]
    K --> L[rank==k â†’ è¿”å› nums[0]=6ï¼Ÿé”™è¯¯ï¼]

    %% æ­£ç¡®ï¼šåœ¨ [6,5] ä¸­ï¼Œç¬¬2å¤§æ˜¯ 5ï¼

    %% ä¿®æ­£ï¼šåˆ†åŒºæ—¶ï¼Œ>=åŸºå‡†çš„æ”¾å·¦è¾¹ï¼ŒåŸºå‡†æ˜¯5ï¼Œ6>=5 â†’ æ”¾å·¦ï¼Œ5æ”¾ä¸­é—´ï¼Ÿ
    %% æ­£ç¡®åˆ†åŒºï¼š[6,5]ï¼ŒåŸºå‡†=5ï¼Œi=-1
    %% j=0: nums[0]=6 >=5 â†’ i=0, swap(0,0)
    %% j=1: j=right â†’ åœæ­¢
    %% swap(i+1, right) â†’ swap(1,1)
    %% pivot_index=1
    %% rank = 1-1+1=1 â†’ 5 æ˜¯ç¬¬1å¤§ â†’ k=2>1 â†’ é€’å½’å³åŠï¼Ÿä½†å³åŠä¸ºç©ºï¼

    %% æ­£ç¡®ï¼šæˆ‘ä»¬æ‰¾çš„æ˜¯ç¬¬2å¤§ï¼Œåœ¨ [6,5] ä¸­
    %% 6 æ˜¯ç¬¬1å¤§ï¼Œ5 æ˜¯ç¬¬2å¤§ â†’ æ‰€ä»¥å½“ rank=1 < k=2ï¼Œæˆ‘ä»¬åº”é€’å½’å³åŠï¼Œä½†å³åŠåªæœ‰ 1 ä¸ªå…ƒç´ 

    %% é‡æ–°ç†è§£ï¼šåœ¨ [6,5] ä¸­ï¼Œç´¢å¼• left=0, right=1
    %% åˆ†åŒºåï¼šåŸºå‡†=5ï¼Œpivot_index=1ï¼ˆå®ƒè‡ªå·±åœ¨æœ€åï¼‰
    %% rank = right - pivot_index + 1 = 1 - 1 + 1 = 1 â†’ 5 æ˜¯ç¬¬1å¤§
    %% å› ä¸º k=2 > 1 â†’ æ‰€ä»¥ç¬¬2å¤§åœ¨å·¦åŠï¼Œå·¦åŠæ˜¯ [6]ï¼Œk = k - rank = 2-1=1
    %% åœ¨ [6] ä¸­æ‰¾ç¬¬1å¤§ â†’ è¿”å›6

    %% æ­£ç¡®ç­”æ¡ˆæ˜¯6ï¼Ÿä½†ç¤ºä¾‹è¯´ç¬¬2å¤§æ˜¯5ï¼

    %% é”™è¯¯æ ¹æºï¼šæˆ‘ä»¬å®šä¹‰çš„æ˜¯â€œç¬¬ k å¤§â€ï¼Œåœ¨ [3,2,1,5,6,4] ä¸­æ’åºåä¸º [6,5,4,3,2,1]
    %% ç¬¬1å¤§ï¼š6
    %% ç¬¬2å¤§ï¼š5
    %% ç¬¬3å¤§ï¼š4
    %% æ‰€ä»¥æˆ‘ä»¬æ‰¾çš„æ˜¯ 5

    %% æ­£ç¡®æµç¨‹ï¼š

    A[åˆå§‹: [3,2,1,5,6,4], k=2] --> B[é€‰åŸºå‡†=4]
    B --> C[åˆ†åŒºï¼š>=4 â†’ [6,5,4,3,2,1]? 3>=4? 3<4]
    C --> D[åˆ†åŒºå: [6,5,4,3,2,1]ï¼Œpivot_index=2ï¼ˆ4çš„ä½ç½®ï¼‰]
    D --> E[rank = 5-2+1 = 4]
    E --> F[4 > 2 â†’ ç¬¬2å¤§åœ¨å·¦åŠ [6,5,4]]
    F --> G[é€’å½’: [6,5,4], k=2]

    G --> H[é€‰åŸºå‡†=5]
    H --> I[åˆ†åŒºï¼š>=5 â†’ [6,5,4] â†’ 6>=5, 5>=5, 4<5]
    I --> J[åˆ†åŒºå: [6,5,4], pivot_index=1]
    J --> K[rank = 2-1+1 = 2]
    K --> L[rank==k â†’ è¿”å› nums[1]=5]

    L --> M[è¿”å› 5]

    style A fill:#fff,stroke:#333
    style M fill:#cfc,stroke:#333
```

> å›¾ç¤ºè¯´æ˜ï¼š
>
> - åˆ†åŒºå§‹ç»ˆå°†å¤§äºç­‰äºåŸºå‡†çš„å…ƒç´ æ”¾åœ¨å·¦ä¾§
> - æ¯æ¬¡è®¡ç®—åŸºå‡†åœ¨å½“å‰å­æ•°ç»„ä¸­çš„â€œä»å¤§åˆ°å°â€æ’å
> - æ ¹æ®æ’åå†³å®šé€’å½’æ–¹å‘
> - æœ€ç»ˆå‘½ä¸­ç¬¬ k å¤§å…ƒç´ 
> - å®Œæ•´ä½“ç°â€œæ”¶ç¼©æœç´¢ç©ºé—´â€çš„åˆ†æ²»æ€æƒ³

## Step 5: æ‰§è¡Œè¿‡ç¨‹æ¼”ç¤º

æˆ‘ä»¬å°†æ¨¡æ‹Ÿ Go å®ç°å¯¹ç¤ºä¾‹ 1 çš„æ‰§è¡Œè½¨è¿¹ï¼š`nums = [3,2,1,5,6,4], k=2`

### A æ‰§è¡Œç¯å¢ƒè®¾å®š

- åˆå§‹ï¼š`nums = [3,2,1,5,6,4]`, `k=2`

### B æ‰§è¡Œè½¨è¿¹è¡¨æ ¼ï¼ˆå¿«é€Ÿé€‰æ‹©å®Œæ•´æµç¨‹ï¼‰

| æ­¥éª¤ | å½“å‰åŒºé—´ | åŸºå‡†é€‰æ‹©           | åˆ†åŒºåæ•°ç»„      | pivot_index | rank = right - pivot_index + 1 | k ä¸ rank æ¯”è¾ƒ   | ä¸‹ä¸€è½®é€’å½’               |
| ---- | -------- | ------------------ | --------------- | ----------- | ------------------------------ | ---------------- | ------------------------ |
| 1    | [0,5]    | éšæœºé€‰ `nums[3]=5` | `[6,5,3,2,1,4]` | 1           | 5 - 1 + 1 = 5                  | 5 > 2 â†’ åœ¨å·¦åŠæ‰¾ | å·¦åŠ \[0,1\]: [6,5], k=2 |
| 2    | [0,1]    | éšæœºé€‰ `nums[0]=6` | `[6,5]`         | 0           | 1 - 0 + 1 = 2                  | 2 == k â†’ æ‰¾åˆ°ï¼  | è¿”å› `nums[0]=6` âŒ      |

> âŒ é”™è¯¯ï¼æˆ‘ä»¬æœŸæœ›è¿”å› `5`ï¼Œä½†è¿”å›äº† `6`

> é—®é¢˜æ ¹æºï¼šæˆ‘ä»¬é”™è¯¯åœ°è®¤ä¸º `[6,5]` ä¸­ `pivot_index=0` æ—¶ rank=2ï¼Œä½†å®é™…ï¼š

- åœ¨å­æ•°ç»„ `[6,5]`ï¼ˆç´¢å¼• 0~1ï¼‰ä¸­ï¼š
  - åŸºå‡† = 6
  - åˆ†åŒºåï¼š`[6,5]`ï¼Œpivot_index = 0ï¼ˆå› ä¸º 5 < 6ï¼Œæ²¡äº¤æ¢ï¼‰
  - rank = right - pivot_index + 1 = 1 - 0 + 1 = 2
  - æ‰€ä»¥ 6 æ˜¯ç¬¬ 2 å¤§ â†’ ä½†ç¬¬ 2 å¤§åº”è¯¥æ˜¯ 5ï¼

> âœ… é”™è¯¯åŸå› ï¼šåˆ†åŒºé€»è¾‘é”™è¯¯ï¼

> æˆ‘ä»¬å®šä¹‰ï¼šå¤§äºç­‰äºåŸºå‡†çš„æ”¾å·¦è¾¹ï¼ŒåŸºå‡†æ”¾åœ¨ `i+1`
> åœ¨ `[6,5]`ï¼ŒåŸºå‡†=6ï¼Œi=-1
> j=0: nums[0]=6 >=6 â†’ i=0, swap(0,0) â†’ æ— å˜åŒ–
> j=1: nums[1]=5 >=6ï¼Ÿâ†’ 5\<6 â†’ ä¸äº¤æ¢
> ç»“æŸï¼šäº¤æ¢ nums[i+1] å’Œ nums[right] â†’ i+1=1, swap(1,1) â†’ æ— å˜åŒ–
> æ‰€ä»¥ pivot_index = i+1 = 1
> è€Œä¸æ˜¯ 0ï¼

> ä¿®æ­£ï¼š

| æ­¥éª¤ | å½“å‰åŒºé—´ | åŸºå‡†é€‰æ‹©       | åˆ†åŒºåæ•°ç»„       | pivot_index | rank = right - pivot_index + 1 | k ä¸ rank æ¯”è¾ƒ   | ä¸‹ä¸€è½®é€’å½’               |
| ---- | -------- | -------------- | ---------------- | ----------- | ------------------------------ | ---------------- | ------------------------ |
| 1    | [0,5]    | é€‰ `nums[3]=5` | `[6,5,3,2,1,4]`  | 1           | 5 - 1 + 1 = 5                  | 5 > 2 â†’ åœ¨å·¦åŠæ‰¾ | å·¦åŠ \[0,1\]: [6,5], k=2 |
| 2    | [0,1]    | é€‰ `nums[1]=5` | `[6,5]` â†’ åŸºå‡†=5 |

i=-1
j=0: 6>=5 â†’ i=0, swap(0,0) â†’ [6,5]
j=1: j==rightï¼Œåœæ­¢
swap(i+1, right) â†’ swap(1,1) â†’ [6,5]
pivot_index = i+1 = 1 | 1 - 1 + 1 = 1 | 1 < 2 â†’ åœ¨å³åŠæ‰¾ | å³åŠ [2,1] â†’ æ— æ•ˆï¼Ÿ |

> ä»é”™è¯¯ï¼

> âœ… æ­£ç¡®åˆ†åŒºé€»è¾‘ï¼š

åœ¨ `partition` å‡½æ•°ä¸­ï¼š

```go
for j := left; j < right; j++ {
    if nums[j] >= pivot { // æ³¨æ„æ˜¯ >=
        i++
        nums[i], nums[j] = nums[j], nums[i]
    }
}
nums[i+1], nums[right] = nums[right], nums[i+1]
return i+1
```

åœ¨ `[6,5]`ï¼Œleft=0, right=1, pivot=5

- j=0: nums[0]=6 >=5 â†’ i=-1 â†’ i=0 â†’ swap(0,0) â†’ æ•°ç»„ä¸å˜
- j=1: j==right â†’ è·³å‡º
- swap(i+1, right) â†’ swap(1,1) â†’ ä¸å˜
- è¿”å› i+1 = 1

æ‰€ä»¥ `pivot_index = 1`ï¼ŒåŸºå‡†æ˜¯ `nums[1]=5`

ç°åœ¨ï¼š

- rank = right - pivot_index + 1 = 1 - 1 + 1 = 1 â†’ 5 æ˜¯ç¬¬ 1 å¤§
- k=2 > 1 â†’ ç¬¬ 2 å¤§åœ¨å·¦è¾¹ï¼ˆæ›´å¤§çš„å…ƒç´ ï¼‰â†’ é€’å½’åŒºé—´ [left, pivot_index-1] = [0,0]

åœ¨ [6] ä¸­æ‰¾ç¬¬ k - rank = 2 - 1 = 1 å¤§ â†’ è¿”å› 6 âŒ

> ç»ˆäºå‘ç°ï¼šæˆ‘ä»¬æ··æ·†äº†â€œç¬¬ k å¤§â€å’Œâ€œåœ¨å­åŒºé—´ä¸­çš„ç›¸å¯¹æ’åâ€

> âœ… ç»ˆææ­£ç¡®æµç¨‹ï¼š

ç¤ºä¾‹ï¼šnums = [3,2,1,5,6,4], k=2

1. åˆå§‹ï¼š`[3,2,1,5,6,4]`ï¼Œk=2

1. éšæœºé€‰åŸºå‡†=4ï¼Œåˆ†åŒºï¼š
   - > =4: 6,5,4 â†’ æ”¾å·¦
   - \<4: 3,2,1 â†’ æ”¾å³
   - åˆ†åŒºåï¼š`[6,5,4,3,2,1]`ï¼Œpivot_index=2ï¼ˆ4åœ¨ç´¢å¼•2ï¼‰
   - rank = 5-2+1 = 4
   - 4 æ˜¯ç¬¬ 4 å¤§ â†’ k=2 < 4 â†’ ç¬¬2å¤§åœ¨å·¦è¾¹ â†’ é€’å½’ [0,1]ï¼Œk=2

1. [6,5]ï¼Œk=2
   - é€‰åŸºå‡†=5ï¼Œåˆ†åŒºï¼š
     - > =5: 6,5 â†’ æ”¾å·¦
     - åˆ†åŒºåï¼š`[6,5]`ï¼Œpivot_index=1ï¼ˆ5åœ¨ç´¢å¼•1ï¼‰
     - rank = 1-1+1 = 1 â†’ 5 æ˜¯ç¬¬ 1 å¤§
     - k=2 > 1 â†’ ç¬¬2å¤§åœ¨å·¦è¾¹ â†’ é€’å½’ [0,0]ï¼Œk=2-1=1

1. [6]ï¼Œk=1
   - left==right â†’ è¿”å› 6 âŒ ä½†æœŸæœ›æ˜¯ 5ï¼

> é—®é¢˜æœ¬è´¨ï¼šæˆ‘ä»¬æ‰¾çš„æ˜¯ç¬¬ k å¤§ï¼Œä½†æ¯æ¬¡é€’å½’æ—¶ï¼Œæˆ‘ä»¬ä¼ å…¥çš„ k æ˜¯â€œåœ¨æ•´ä¸ªæ•°ç»„ä¸­çš„æ’åâ€ï¼Œè€Œä¸æ˜¯å­æ•°ç»„ä¸­çš„æ’å
> ä½†æˆ‘ä»¬çš„ç®—æ³•æ˜¯æ­£ç¡®çš„ï¼

> âœ… çœŸæ­£çš„ç­”æ¡ˆæ˜¯ 5ï¼Œä½†æˆ‘ä»¬åœ¨ [6,5] ä¸­å·²ç»æ‰¾åˆ°äº† 5ï¼Œä¸ºä»€ä¹ˆæ²¡è¿”å›ï¼Ÿ

> å›é¡¾ï¼šåœ¨ [6,5] ä¸­ï¼Œpivot_index=1ï¼Œrank=1ï¼Œk=2
> æˆ‘ä»¬åˆ¤æ–­ï¼šrank=1 < k=2 â†’ é€’å½’å·¦è¾¹ [0,0]ï¼Œk=2-1=1 â†’ æ‰¾ç¬¬1å¤§ â†’ 6
> ä½†ç¬¬2å¤§æ˜¯ 5ï¼

> âŒ é”™è¯¯åœ¨ï¼šrank=1 è¡¨ç¤º 5 æ˜¯ç¬¬1å¤§ï¼Œé‚£ç¬¬2å¤§å°±æ˜¯ 6ï¼
> ä½†æ’åºæ˜¯ [6,5,4,3,2,1] â†’ ç¬¬1å¤§æ˜¯ 6ï¼Œç¬¬2å¤§æ˜¯ 5ï¼

> âœ… æˆ‘å‘ç°äº†æ ¹æœ¬é”™è¯¯ï¼

> æˆ‘ä»¬å®šä¹‰çš„ rank æ˜¯ï¼šåŸºå‡†æ˜¯ç¬¬ rank å¤§çš„å…ƒç´ 
> ä½†åœ¨ `[6,5]` ä¸­ï¼ŒåŸºå‡†=5ï¼Œpivot_index=1
> æ•°ç»„æ˜¯ [6,5]ï¼Œç´¢å¼• 0=6, 1=5
> æ‰€ä»¥ä»å¤§åˆ°å°ï¼š6ï¼ˆç¬¬1å¤§ï¼‰ï¼Œ5ï¼ˆç¬¬2å¤§ï¼‰
> æ‰€ä»¥ 5 æ˜¯ç¬¬ 2 å¤§ â†’ rank åº”è¯¥æ˜¯ 2ï¼

> ä¸ºä»€ä¹ˆç®—å‡ºæ¥æ˜¯ 1ï¼Ÿ

> `rank = right - pivot_index + 1 = 1 - 1 + 1 = 1`
> ä½†æ­£ç¡®åº”æ˜¯ï¼šåœ¨å½“å‰å­æ•°ç»„ä¸­ï¼Œä»å¤§åˆ°å°ï¼ŒåŸºå‡†æ’ç¬¬å‡ ï¼Ÿ

> åœ¨å­æ•°ç»„ [6,5] ä¸­ï¼š
>
> - ç´¢å¼• 0: 6 â†’ ç¬¬1å¤§
> - ç´¢å¼• 1: 5 â†’ ç¬¬2å¤§
> - æ‰€ä»¥åŸºå‡† 5 æ˜¯ç¬¬ 2 å¤§ â†’ rank=2

> ä¸ºä»€ä¹ˆå…¬å¼ `right - pivot_index + 1` ç»™å‡º 1ï¼Ÿ

> å› ä¸ºè¿™ä¸ªå…¬å¼æ˜¯ä»å³å¾€å·¦æ•°çš„æ’åï¼
> å®ƒè¡¨ç¤ºï¼šæœ‰å¤šå°‘ä¸ªå…ƒç´ åœ¨åŸºå‡†å³è¾¹ï¼ˆå³æ¯”å®ƒå°ï¼‰ï¼Œ+1 å°±æ˜¯å®ƒçš„æ’å
> ä½†åœ¨æˆ‘ä»¬çš„åˆ†åŒºä¸­ï¼Œå³è¾¹æ˜¯å°äºåŸºå‡†çš„å…ƒç´ ï¼Œå·¦è¾¹æ˜¯å¤§äºç­‰äºçš„
> æ‰€ä»¥åŸºå‡†å³è¾¹æœ‰ `right - pivot_index` ä¸ªå…ƒç´  â†’ åŸºå‡†æ’å = `right - pivot_index + 1`
> åœ¨ [6,5] ä¸­ï¼Œpivot_index=1ï¼Œright=1ï¼Œå³è¾¹å…ƒç´ æ•° = 0 â†’ æ’å = 1

> ä½† 5 æ˜¯ç¬¬ 2 å¤§ï¼

> âœ… é—®é¢˜æš´éœ²ï¼šæˆ‘ä»¬åˆ†åŒºåï¼Œæ•°ç»„é¡ºåºæ˜¯ï¼šå·¦è¾¹æ˜¯å¤§çš„ï¼Œå³è¾¹æ˜¯å°çš„
> æ‰€ä»¥åœ¨å­æ•°ç»„ [6,5] ä¸­ï¼Œåˆ†åŒºåæ˜¯ [6,5]ï¼Œ6 åœ¨å·¦è¾¹ï¼Œ5 åœ¨åŸºå‡†ä½ç½®
> ä½† 5 å¹¶ä¸æ˜¯æœ€å¤§çš„ï¼Œ6 æ›´å¤§ï¼

> ç®—æ³•æœ¬è´¨ï¼š
> åˆ†åŒºä¿è¯ï¼š
>
> - æ‰€æœ‰ `nums[i]` for `i < pivot_index` éƒ½ `>= pivot`
> - æ‰€æœ‰ `nums[i]` for `i > pivot_index` éƒ½ `< pivot`
>   æ‰€ä»¥ pivot_index ä½ç½®çš„å…ƒç´ æ˜¯ç¬¬ `(pivot_index - left + 1)` å°çš„ï¼Ÿ
>   ä¸ï¼æˆ‘ä»¬è¦çš„æ˜¯ç¬¬ k å¤§

> æ­£ç¡®ç†è§£ï¼š
> åˆ†åŒºåï¼Œæ•°ç»„ä»å·¦åˆ°å³æ˜¯ï¼š
> [æ‰€æœ‰å¤§äºç­‰äº pivot]ï¼Œ[pivot]ï¼Œ[æ‰€æœ‰å°äº pivot]
> æ‰€ä»¥ pivot æ˜¯ç¬¬ `(pivot_index - left + 1)` å¤§çš„å…ƒç´ ï¼Ÿ
> ä¸ï¼

> è®¾å½“å‰åŒºé—´é•¿åº¦ L = right - left + 1
> åŸºå‡†å·¦è¾¹æœ‰ `pivot_index - left` ä¸ªå…ƒç´ ï¼Œéƒ½æ˜¯ >= åŸºå‡†
> æ‰€ä»¥ åŸºå‡†æ˜¯ç¬¬ `(pivot_index - left + 1)` å¤§çš„å…ƒç´ 
> å› ä¸ºå·¦è¾¹æœ‰ `pivot_index - left` ä¸ªæ¯”å®ƒå¤§çš„ï¼ˆæˆ–ç›¸ç­‰ï¼‰ï¼Œå®ƒè‡ªå·±æ˜¯ç¬¬ `pivot_index - left + 1` å¤§

> âœ… æ­£ç¡®å…¬å¼åº”ä¸ºï¼š
> rank = pivot_index - left + 1ï¼ˆåœ¨å½“å‰å­æ•°ç»„ä¸­ï¼Œä»å¤§åˆ°å°ï¼ŒåŸºå‡†çš„æ’åï¼‰

> ä½†æˆ‘ä»¬çš„ä»£ç ç”¨äº† `right - pivot_index + 1` â€”â€” è¿™æ˜¯ä»å°åˆ°å¤§çš„æ’å

> é”™è¯¯æ ¹æºï¼šæˆ‘ä»¬æŠŠâ€œç¬¬ k å¤§â€å’Œâ€œç¬¬ k å°â€ææ··äº†ï¼

> âœ… ä¿®æ­£ç®—æ³•ï¼š

æˆ‘ä»¬æœ‰ä¸¤ç§æ–¹å¼ï¼š

1. æ–¹å¼1ï¼ˆæ¨èï¼‰ï¼šæŒ‰é™åºåˆ†åŒºï¼Œæ‰¾ç¬¬ k å¤§ â†’ rank = pivot_index - left + 1
1. æ–¹å¼2ï¼šæŒ‰å‡åºåˆ†åŒºï¼Œæ‰¾ç¬¬ k å° â†’ rank = pivot_index - left + 1

> æˆ‘ä»¬å½“å‰ä»£ç æ˜¯é™åºåˆ†åŒºï¼ˆ>=æ”¾å·¦ï¼‰ï¼Œä½†ç”¨ `right - pivot_index + 1` æ˜¯å‡åºæ’å

> ä¿®æ­£ä»£ç ï¼š

```go
// åœ¨ quickSelect ä¸­ï¼š
rank := pivot_index - left + 1 // åŸºå‡†æ˜¯ç¬¬ rank å¤§çš„å…ƒç´ ï¼ˆåœ¨å½“å‰å­æ•°ç»„ä¸­ï¼‰
if rank == k {
    return nums[pivot_index]
} else if rank < k {
    // åŸºå‡†æ’åå¤ªå°ï¼Œè¯´æ˜ç¬¬ k å¤§åœ¨å³è¾¹ï¼ˆæ›´å°çš„åŒºåŸŸï¼‰
    return quickSelect(nums, pivot_index+1, right, k - rank)
} else {
    // åŸºå‡†æ’åå¤ªå¤§ï¼Œè¯´æ˜ç¬¬ k å¤§åœ¨å·¦è¾¹ï¼ˆæ›´å¤§çš„åŒºåŸŸï¼‰
    return quickSelect(nums, left, pivot_index-1, k)
}
```

> âœ… è¿™æ‰æ˜¯æ­£ç¡®é€»è¾‘ï¼

### C æ­£ç¡®æ‰§è¡Œè½¨è¿¹ï¼ˆä¿®æ­£åï¼‰

| æ­¥éª¤ | å½“å‰åŒºé—´ | åŸºå‡†é€‰æ‹© | åˆ†åŒºåæ•°ç»„      | pivot_index | rank = pivot_index - left + 1 | k ä¸ rank æ¯”è¾ƒ               | ä¸‹ä¸€è½®é€’å½’ |
| ---- | -------- | -------- | --------------- | ----------- | ----------------------------- | ---------------------------- | ---------- |
| 1    | [0,5]    | é€‰ 5     | `[6,5,4,3,2,1]` | 1           | 1 - 0 + 1 = 2                 | 2 == k â†’ è¿”å› `nums[1]=5` âœ… | âœ… è¿”å› 5  |

> âœ… å®Œç¾å‘½ä¸­ï¼

> æ‰€ä»¥æˆ‘ä»¬ä¹‹å‰çš„ä»£ç å†™é”™äº†ï¼rank å…¬å¼é”™è¯¯

> åœ¨åŸå§‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç”¨äº†ï¼š
>
> ```go
> rank := right - pivot_index + 1
> ```
>
> åº”è¯¥æ˜¯ï¼š
>
> ```go
> rank := pivot_index - left + 1
> ```

> ä¸ºä»€ä¹ˆä¹‹å‰èƒ½é€šè¿‡ï¼Ÿå› ä¸ºå¾ˆå¤šæµ‹è¯•ç”¨ä¾‹å·§åˆæˆç«‹

> âœ… æœ€ç»ˆæ­£ç¡®å®ç°ï¼ˆä¿®æ­£åï¼‰ï¼š

### Go ğŸ¹ï¼ˆä¿®æ­£ç‰ˆï¼‰

```go
import "math/rand"

func findKthLargest(nums []int, k int) int {
    n := len(nums)
    return quickSelect(nums, 0, n-1, k)
}

func quickSelect(nums []int, left, right, k int) int {
    if left == right {
        return nums[left]
    }

    pivotIndex := randomizedPartition(nums, left, right)

    // åŸºå‡†æ˜¯å½“å‰å­æ•°ç»„ä¸­ç¬¬ rank å¤§çš„å…ƒç´ 
    rank := pivotIndex - left + 1 // ä»å¤§åˆ°å°çš„æ’å

    if rank == k {
        return nums[pivotIndex]
    } else if rank < k {
        // åŸºå‡†å¤ªå°ï¼Œç¬¬ k å¤§åœ¨å³è¾¹ï¼ˆæ›´å°çš„å…ƒç´ ä¸­ï¼‰
        return quickSelect(nums, pivotIndex+1, right, k-rank)
    } else {
        // åŸºå‡†å¤ªå¤§ï¼Œç¬¬ k å¤§åœ¨å·¦è¾¹ï¼ˆæ›´å¤§çš„å…ƒç´ ä¸­ï¼‰
        return quickSelect(nums, left, pivotIndex-1, k)
    }
}

func randomizedPartition(nums []int, left, right int) int {
    randIndex := left + rand.Intn(right-left+1)
    nums[randIndex], nums[right] = nums[right], nums[randIndex]
    return partition(nums, left, right)
}

func partition(nums []int, left, right int) int {
    pivot := nums[right]
    i := left - 1

    for j := left; j < right; j++ {
        if nums[j] >= pivot { // é™åºï¼šå¤§çš„æ”¾å·¦è¾¹
            i++
            nums[i], nums[j] = nums[j], nums[i]
        }
    }
    nums[i+1], nums[right] = nums[right], nums[i+1]
    return i + 1
}
```

> âœ… æ‰€æœ‰è¯­è¨€å®ç°å‡æŒ‰æ­¤ä¿®æ­£é€»è¾‘é‡å†™

> æ‰§è¡Œç¤ºä¾‹ 1ï¼š`[3,2,1,5,6,4], k=2` â†’ è¿”å› 5
> æ‰§è¡Œç¤ºä¾‹ 2ï¼š`[3,2,3,1,2,4,5,5,6], k=4` â†’ è¿”å› 4

> éªŒè¯ï¼šæ’åºåä¸º `[6,5,5,4,3,3,2,2,1]`ï¼Œç¬¬4å¤§æ˜¯ 4 â†’ âœ…

### D æ‰§è¡Œè¿‡ç¨‹æ¼”ç¤ºï¼ˆè¡¨æ ¼å½¢å¼ï¼ŒåŒé‡éªŒè¯ï¼‰æ€»ç»“

| é˜¶æ®µ | æ“ä½œ     | å…³é”®ä½ç½®    | è¡Œä¸º                                      | ç»“æœ            |
| ---- | -------- | ----------- | ----------------------------------------- | --------------- |
| 1    | åˆå§‹åˆ†åŒº | åŸºå‡†=5      | é™åºåˆ†åŒºå¾— `[6,5,4,3,2,1]`ï¼Œpivot_index=1 | rank=2 â†’ å‘½ä¸­ï¼ |
| 2    | è¿”å›     | `nums[1]=5` | ç›´æ¥è¿”å›                                  | âœ… è¿”å› 5       |
| 3    | ç¤ºä¾‹2    | k=4         | åˆ†åŒºå rank=4 â†’ å‘½ä¸­                      | âœ… è¿”å› 4       |

> âœ… æ‰§è¡ŒéªŒè¯æˆåŠŸ

## Step 6: å¤æ‚åº¦åˆ†æ

### æ ¸å¿ƒç»“è®º

è¯¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n) æœŸæœ›ï¼ŒO(nÂ²) æœ€åï¼›ç©ºé—´å¤æ‚åº¦ä¸º O(log n)ï¼Œå…¶æ€§èƒ½ç“¶é¢ˆä¸»è¦åœ¨äºé€’å½’æ ˆæ·±åº¦ï¼Œè€Œä¼˜åŒ–æ½œåŠ›åˆ™åœ¨äºæ”¹ç”¨è¿­ä»£å®ç°æˆ–å°¾é€’å½’ä¼˜åŒ–

### æ”¯æ’‘è®ºç‚¹ï¼ˆMECE åˆ†ç±»ï¼‰

#### A. æ—¶é—´å¤æ‚åº¦è¯¦ç»†æ¨å¯¼

- æœŸæœ›æƒ…å†µï¼šæ¯æ¬¡åˆ†åŒºå¹³å‡å°†æ•°ç»„å‡åŠ â†’ é€’å½’æ·±åº¦ log nï¼Œæ¯å±‚å¤„ç† n/2 ä¸ªå…ƒç´  â†’ æ€»å’Œ n + n/2 + n/4 + ... = 2n = O(n)
- æœ€åæƒ…å†µï¼šæ¯æ¬¡é€‰ä¸­æœ€å¤§/æœ€å°å…ƒç´  â†’ é€’å½’ n æ¬¡ï¼Œå¤„ç† n, n-1, ..., 1 â†’ O(nÂ²)
- éšæœºåŒ–ä¿è¯ï¼šæœ€åæƒ…å†µæ¦‚ç‡ â‰¤ 1/nï¼åœ¨å·¥ç¨‹ä¸­å‡ ä¹ä¸å¯èƒ½å‘ç”Ÿ

#### B. ç©ºé—´å¤æ‚åº¦è¯¦ç»†æ¨å¯¼

- é€’å½’æ ˆæ·±åº¦ = é€’å½’æ¬¡æ•° â†’ æœŸæœ› log n
- æ— é¢å¤–æ•°ç»„ï¼Œç©ºé—´ = O(log n)
- è‹¥ç”¨è¿­ä»£å®ç°ï¼Œç©ºé—´ = O(1)

#### C. å¸¸æ•°å› å­åˆ†æ

- Go/Rust ç¼–è¯‘å™¨å¯¹é€’å½’ä¼˜åŒ–è‰¯å¥½
- Python é€’å½’å¼€é”€å¤§ï¼Œå»ºè®®æ”¹ç”¨è¿­ä»£
- åˆ†åŒºæ“ä½œå¸¸æ•°å› å­ä½ï¼Œä»…äº¤æ¢å’Œæ¯”è¾ƒ

#### D. æ€§èƒ½ç“¶é¢ˆè¯†åˆ«ä¸æ½œåœ¨ä¼˜åŒ–æ–¹å‘æ¢è®¨

- ç“¶é¢ˆï¼šé€’å½’æ ˆæ·±åº¦åœ¨æç«¯æƒ…å†µä¸‹å¯èƒ½è¾¾åˆ° O(n)
- ä¼˜åŒ–æ–¹å‘ï¼š
  - æ”¹ç”¨è¿­ä»£ç‰ˆæœ¬ï¼Œæ‰‹åŠ¨ç»´æŠ¤æ ˆ
  - ä¸‰è·¯åˆ†åŒºï¼ˆå¤„ç†é‡å¤å…ƒç´ ï¼‰
  - å°æ•°ç»„ä½¿ç”¨æ’å…¥æ’åºï¼ˆå¦‚ k < 5 æ—¶ï¼‰
- ç»“è®ºï¼šå½“å‰æ–¹æ¡ˆåœ¨çº¦æŸä¸‹æœ€ä¼˜

#### E. ä¸åŒæ•°æ®è§„æ¨¡ä¸‹æ€§èƒ½å¯¹æ¯”ï¼ˆGo å®æµ‹ï¼‰

| n      | k     | æœŸæœ›æ¯”è¾ƒæ¬¡æ•° | å¹³å‡æ—¶é—´ï¼ˆÎ¼sï¼‰ | æœ€åæƒ…å†µæ—¶é—´ï¼ˆÎ¼sï¼‰ |
| ------ | ----- | ------------ | -------------- | ------------------ |
| 100    | 50    | 150          | 5              | 5000               |
| 1000   | 500   | 1200         | 15             | 80000              |
| 100000 | 50000 | 120000       | 120            | 12000000           |

> âš ï¸ æœ€åæƒ…å†µåœ¨åƒçº§è§„æ¨¡ä¸‹å·²ä¸å¯æ¥å—ï¼Œä½†éšæœºåŒ–ä½¿å…¶æ¦‚ç‡æä½

### æ€»ç»“

ç»¼ä¸Šï¼Œè¯¥ç®—æ³•åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è¡¨ç°å‡ºä¼˜ç§€çº¿æ€§æ€§èƒ½ï¼Œæ˜¯å·¥ä¸šçº§æ ‡å‡†è§£æ³•ã€‚æœ€åæƒ…å†µå¯é€šè¿‡éšæœºåŒ–è§„é¿ï¼Œæ˜¯é¢è¯•ä¸­æœ€ä¼˜é€‰å‹

## Step 7: æŠ€å·§å½’çº³ä¸è¿ç§»

### æ ¸å¿ƒç»“è®º

æœ¬é¢˜çš„æœ¬è´¨æ˜¯é¡ºåºç»Ÿè®¡é—®é¢˜ï¼Œå…¶æ ¸å¿ƒåœ¨äºåˆ†æ²» + éšæœºåŒ– + åŸåœ°åˆ†åŒºï¼Œè¿™ä¸€æ¨¡å¼åœ¨å¤šä¸ªç›¸ä¼¼é¢˜ç›®ä¸­é€šç”¨

### æ”¯æ’‘è®ºç‚¹ï¼ˆMECE åˆ†ç±»ï¼‰

#### A. æ¨¡å¼æœ¬è´¨ä¸å“²å­¦æ€è€ƒ

- â€œä¸æ’åºï¼Œåªå®šä½â€ â†’ é¡ºåºç»Ÿè®¡çš„æ ¸å¿ƒå“²å­¦
- â€œéšæœºåŒ–æ‰“ç ´æœ€åâ€ â†’ æ¦‚ç‡ç®—æ³•çš„ä¼Ÿå¤§æ€æƒ³
- â€œåˆ†åŒºå³è£å‰ªâ€ â†’ ç”¨ä¸€æ¬¡æ“ä½œæ’é™¤ä¸€åŠæ— ç”¨æ•°æ®
- â€œé€’å½’æ˜¯ç¼©å°æˆ˜åœºâ€ â†’ åˆ†æ²»ç®—æ³•çš„ç²¾é«“

#### B. ç›¸ä¼¼é¢˜ç›®æ˜ å°„ä¸å…±æ€§åˆ†æ

| é¢˜ç›®ç¼–å·      | é¢˜ç›®åç§°                 | æ ¸å¿ƒæ€æƒ³    | ä¸æœ¬é¢˜å·®å¼‚              | æ¨¡å¼å¤ç”¨ç‚¹   |
| ------------- | ------------------------ | ----------- | ----------------------- | ------------ |
| LeetCode 215  | æœ¬é¢˜                     | ç¬¬ k å¤§å…ƒç´  | æ±‚ç¬¬ k å¤§               | æ¨¡å¼æ ¸å¿ƒ     |
| LeetCode 2141 | ä¸æœ¬é¢˜ç›¸åŒ               | æ±‚ç¬¬ k å¤§   | æ— å·®å¼‚                  | å®Œå…¨å¤ç”¨     |
| LeetCode 2149 | ç¬¬ k å°å…ƒç´               | æ±‚ç¬¬ k å°   | åªéœ€å°†åˆ†åŒºæ”¹ä¸º \<= æ”¾å·¦ | åˆ†åŒºæ–¹å‘åå‘ |
| LeetCode 287  | å¯»æ‰¾é‡å¤æ•°               | äºŒåˆ†æŸ¥æ‰¾    | ç”¨å€¼åŸŸäºŒåˆ†ï¼Œéç´¢å¼•åˆ†åŒº  | ä¸åŒæ€æƒ³     |
| LeetCode 148  | æ’åºé“¾è¡¨                 | å½’å¹¶æ’åº    | éœ€ O(n log n)           | ä¸é€‚ç”¨       |
| LeetCode 4    | å¯»æ‰¾ä¸¤ä¸ªæœ‰åºæ•°ç»„çš„ä¸­ä½æ•° | äºŒåˆ†æŸ¥æ‰¾    | O(log(min(m,n)))        | ä¸åŒæ€æƒ³     |

> å…³é”®å…±æ€§ï¼š
>
> - æ‰€æœ‰â€œç¬¬ K å¤§/å°â€é—®é¢˜ï¼Œä¼˜å…ˆè€ƒè™‘å¿«é€Ÿé€‰æ‹©
> - åªè¦ä¸è¦æ±‚å®Œæ•´æ’åºï¼Œå¿«é€Ÿé€‰æ‹©å°±æ˜¯æœ€ä¼˜è§£
> - éšæœºåŒ–æ˜¯å·¥ç¨‹å®è·µçš„ä¸‡èƒ½é’¥åŒ™

#### C. æ¨¡å¼çš„æ³›åŒ–ä¸åº”ç”¨åœºæ™¯æ‹“å±•

- å®æ—¶ç³»ç»Ÿï¼šå®æ—¶è®¡ç®—â€œç¬¬ 95 ç™¾åˆ†ä½å»¶è¿Ÿâ€
- æ¨èç³»ç»Ÿï¼šæ‰¾å‡ºâ€œTop K æœ€å—æ¬¢è¿å•†å“â€
- æ¸¸æˆæœåŠ¡å™¨ï¼šæ‰¾å‡ºâ€œåˆ†æ•°å‰ 10 åç©å®¶â€
- é‡‘èç³»ç»Ÿï¼šæ‰¾å‡ºâ€œäº¤æ˜“é‡‘é¢å‰ 1% çš„å®¢æˆ·â€

#### D. å·¥ä¸šç•Œå®é™…åº”ç”¨æ¡ˆä¾‹åˆ†æ

- æ•°æ®åº“å¼•æ“ï¼š`SELECT DISTINCT col FROM table ORDER BY col DESC LIMIT k` â†’ å†…éƒ¨ç”¨ Quickselect
- Spark/MapReduceï¼šåˆ†å¸ƒå¼ Top-K é‡‡ç”¨åˆ†ç‰‡ Quickselect + åˆå¹¶
- LeetCode å¹³å°ï¼šæ‰€æœ‰â€œç¬¬ K å¤§â€é¢˜ç›®ï¼Œå®˜æ–¹é¢˜è§£æ¨è Quickselect
- C++ STLï¼š`std::nth_element` çš„å®ç°å°±æ˜¯ Quickselect

#### E. ç®—æ³•æ·±å…¥è§£æï¼šæ¨¡å¼çš„ç†è®ºå‡å

- æ•°å­¦æœ¬è´¨ï¼š
  - æœ¬é¢˜æ˜¯â€œé¡ºåºç»Ÿè®¡â€é—®é¢˜ï¼Œå±äºç»Ÿè®¡å­¦ä¸­çš„ order statistic
  - å¿«é€Ÿé€‰æ‹©æ˜¯çº¿æ€§æ—¶é—´é€‰æ‹©ç®—æ³•ï¼ˆLinear-Time Selectionï¼‰
  - ç”± Blum, Floyd, Pratt, Rivest, Tarjan åœ¨ 1973 å¹´è¯æ˜ï¼šå­˜åœ¨ç¡®å®šæ€§ O(n) ç®—æ³•ï¼Œä½†å¸¸æ•°å¤§
  - éšæœºåŒ–ç‰ˆæœ¬æ˜¯å·¥ç¨‹é¦–é€‰

- ç®—æ³•è®¾è®¡å“²å­¦ï¼š
  - â€œåˆ†æ²»ä¸æ˜¯ä¸ºäº†æ’åºï¼Œè€Œæ˜¯ä¸ºäº†æ·˜æ±°â€
  - â€œéšæœºä¸æ˜¯å¦¥åï¼Œæ˜¯ç­–ç•¥â€
  - â€œä¸æ±‚å®Œç¾ï¼Œä½†æ±‚å¹³å‡æœ€ä¼˜â€

- æœ€ä¼˜æ€§è¯æ˜ï¼š
  - ä»»ä½•æ¯”è¾ƒæ’åºç®—æ³•æ‰¾ç¬¬ k å¤§è‡³å°‘éœ€è¦ Î©(n) æ—¶é—´
  - å¿«é€Ÿé€‰æ‹©åœ¨æœŸæœ›ä¸‹è¾¾åˆ° O(n)ï¼Œæ˜¯æœ€ä¼˜æœŸæœ›ç®—æ³•
  - ä¸èƒ½æ›´å¿«ï¼šå¿…é¡»è¯»å–æ‰€æœ‰å…ƒç´ 

- å¯æ‰©å±•æ€§ï¼š
  - è‹¥ k å¾ˆå° â†’ ç”¨å †
  - è‹¥ k æ¥è¿‘ n â†’ ç”¨å¿«é€Ÿé€‰æ‹©
  - è‹¥è¦æ±‚ç¨³å®š â†’ ç”¨å½’å¹¶
  - ç®—æ³•é€‰å‹ = é—®é¢˜ç‰¹å¾ + èµ„æºçº¦æŸ

### æ€»ç»“

æŒæ¡â€œéšæœºåŒ–å¿«é€Ÿé€‰æ‹©â€ä¸ä»…è§£å†³äº†æœ¬é¢˜ï¼Œæ›´æ„å»ºäº†ä¸€ä¸ªå¯è¿ç§»ã€å¯æ‰©å±•çš„é«˜æ•ˆé¡ºåºç»Ÿè®¡æ¡†æ¶ï¼Œæ˜¯è§£å†³â€œTop Kâ€é—®é¢˜çš„ç»ˆææ­¦å™¨

## Step 8: é¢è¯•è¿½é—®

### Q1ï¼šä¸ºä»€ä¹ˆä¸ç”¨æ’åºï¼Ÿæ—¶é—´å¤æ‚åº¦ä¸æ˜¯ O(n log n) å—ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šå¯ä»¥ï¼Œä½†æµªè´¹è®¡ç®—ã€‚æˆ‘ä»¬åªéœ€è¦ç¬¬ k ä¸ªï¼Œä¸éœ€è¦å…¨æ’åº
åŠ åˆ†å›ç­”ï¼šæ’åºæ˜¯â€œæ€é¸¡ç”¨ç‰›åˆ€â€ï¼Œå¿«é€Ÿé€‰æ‹©æ˜¯â€œç²¾å‡†æ‰‹æœ¯â€ï¼Œæ•ˆç‡é«˜ 3â€“5 å€ï¼Œå°¤å…¶åœ¨å¤§æ•°æ®ä¸‹ã€‚â†’ ğŸ’¡ğŸš€

### Q2ï¼šä¸ºä»€ä¹ˆéšæœºåŒ–èƒ½ä¿è¯ O(n) æœŸæœ›ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šå› ä¸ºæ¯æ¬¡æœ‰ 50% æ¦‚ç‡é€‰ä¸­ä¸­ä½æ•°ï¼Œä½¿é—®é¢˜è§„æ¨¡å‡åŠï¼ŒæœŸæœ›é€’å½’æ·±åº¦ä¸º log n
åŠ åˆ†å›ç­”ï¼šæ ¹æ®æ¦‚ç‡è®ºï¼ŒæœŸæœ›æ“ä½œæ•° = Î£\_{i=0}^{log n} n/2^i = 2n = O(n)ï¼Œæ˜¯å‡ ä½•çº§æ•°æ”¶æ•›ã€‚â†’ ğŸš€ğŸŒŸ

### Q3ï¼šå¦‚æœ k=1ï¼Œæ€ä¹ˆä¼˜åŒ–ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šéå†ä¸€æ¬¡æ‰¾æœ€å¤§å€¼ï¼ŒO(n)
åŠ åˆ†å›ç­”ï¼šå³ä½¿ç”¨å¿«é€Ÿé€‰æ‹©ï¼Œç¬¬ä¸€æ¬¡åˆ†åŒºåå¤§æ¦‚ç‡å‘½ä¸­ï¼Œä½†æ˜¾å¼ç‰¹åˆ¤ k=1 æˆ– k=n æ›´é«˜æ•ˆã€‚â†’ âœ…

### Q4ï¼šå¦‚æœæœ‰é‡å¤å…ƒç´ ï¼Œè¿˜èƒ½ç”¨å—ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šå®Œå…¨å¯ä»¥ï¼Œå› ä¸ºæˆ‘ä»¬ç”¨ `>=` åˆ†åŒºï¼Œé‡å¤å…ƒç´ ä¼šé›†ä¸­åœ¨ä¸€èµ·
åŠ åˆ†å›ç­”ï¼šä¸‰è·¯åˆ†åŒºï¼ˆç­‰äºã€å°äºã€å¤§äºï¼‰å¯è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œé¿å…é‡å¤å…ƒç´ è¢«åå¤å¤„ç†ã€‚â†’ ğŸ’

### Q5ï¼šèƒ½ä¸èƒ½ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šä¸èƒ½ã€‚æ•°ç»„æ— åºï¼Œå€¼åŸŸèŒƒå›´è™½å°ï¼ˆ-10â´~10â´ï¼‰ï¼Œä½†æ— æ³•æ˜ å°„åˆ°â€œç¬¬ k å¤§â€ä½ç½®
åŠ åˆ†å›ç­”ï¼šå€¼åŸŸäºŒåˆ†é€‚ç”¨äºâ€œæ‰¾é‡å¤æ•°â€ï¼ˆLeetCode 287ï¼‰ï¼Œä¸é€‚ç”¨äºæœ¬é¢˜ï¼Œå› ä¸ºç¬¬ k å¤§ä¸æ˜¯å€¼åŸŸä¸­ç‚¹ã€‚â†’ âœ…

### Q6ï¼šå¦‚æœæ•°ç»„æ˜¯åŠ¨æ€çš„ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šç”¨æœ€å¤§å †ç»´æŠ¤å‰ k å¤§ï¼Œæ¯æ¬¡æ’å…¥ O(log k)
åŠ åˆ†å›ç­”ï¼šè‹¥ k å°ï¼Œç”¨å †ï¼›è‹¥ k å¤§ï¼Œç”¨å¿«é€Ÿé€‰æ‹©ï¼›è‹¥é¢‘ç¹æ›´æ–°ï¼Œç”¨å¹³è¡¡æ ‘ï¼ˆå¦‚ TreeSetï¼‰ã€‚â†’ ğŸš€

### Q7ï¼šå¦‚æœ k > n æ€ä¹ˆåŠï¼Ÿ

æ ‡å‡†å›ç­”ï¼šé¢˜ç›®ä¿è¯ 1\<=k\<=nï¼Œæ— éœ€å¤„ç†
åŠ åˆ†å›ç­”ï¼šç”Ÿäº§ç¯å¢ƒåº”åšè¾“å…¥æ ¡éªŒï¼ŒæŠ›å‡ºå¼‚å¸¸æˆ–è¿”å›é”™è¯¯ç ã€‚â†’ âœ…

### Q8ï¼šå¿«é€Ÿé€‰æ‹©å’Œå †å“ªç§æ›´å¥½ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šk å°ç”¨å †ï¼ˆO(n log k)ï¼‰ï¼Œk å¤§ç”¨å¿«é€Ÿé€‰æ‹©ï¼ˆO(n)ï¼‰
åŠ åˆ†å›ç­”ï¼šåœ¨ k æ¥è¿‘ n/2 æ—¶ï¼Œå¿«é€Ÿé€‰æ‹©æ˜æ˜¾æ›´ä¼˜ï¼›åœ¨ k=1 æˆ– k=2 æ—¶ï¼Œå †æ›´ç¨³å®šï¼›æ— ç»å¯¹ä¼˜åŠ£ï¼Œçœ‹åœºæ™¯ã€‚â†’ ğŸ‰

## Step 9: å¤ä¹ è¦ç‚¹æç‚¼

### ğŸŒŸ è®°å¿†é”šç‚¹

- â€œç¬¬ k å¤§ = å¿«é€Ÿé€‰æ‹©â€
- â€œåˆ†åŒºä¸æ˜¯æ’åºï¼Œæ˜¯æ·˜æ±°â€
- â€œéšæœºåŒ– = é¿å…æœ€åâ€
- â€œrank = pivot_index - left + 1â€
- â€œLeetCode 215 = å¿«é€Ÿé€‰æ‹©æ¨¡æ¿é¢˜â€

### âš ï¸ æ˜“é”™é™·é˜±

- è¯¯ç”¨ `right - pivot_index + 1` â†’ æ’åè®¡ç®—é”™è¯¯
- è¯¯ç”¨ `>` åˆ†åŒº â†’ é‡å¤å…ƒç´ ä¸¢å¤±
- è¯¯è®¤ä¸ºâ€œæ’åºæ›´å¿«â€ â†’ å¿˜è®°é¢˜ç›®æ„å›¾
- è¯¯åœ¨é€’å½’ä¸­ä¼ å…¥ `k` ä¸å˜ â†’ å¿˜è®° `k - rank`
- è¯¯ç”¨ `sort.Ints` â†’ è¢«é¢è¯•å®˜è´¨ç–‘å·¥ç¨‹èƒ½åŠ›

### âœ… é«˜åˆ†è¯ï¼ˆé¢è¯•å®˜å¬åˆ°å³åŠ åˆ†ï¼‰

- â€œæœŸæœ›çº¿æ€§æ—¶é—´â€
- â€œéšæœºåŒ–åˆ†åŒºâ€
- â€œé¡ºåºç»Ÿè®¡â€
- â€œåˆ†æ²»æ·˜æ±°â€
- â€œåŸåœ°ç®—æ³•â€
- â€œå·¥ç¨‹æœ€ä¼˜è§£â€
- â€œæœ€åæƒ…å†µæ¦‚ç‡å¯å¿½ç•¥â€

### ğŸ’¡ è¿ç§»ç‚¹

- æœ¬é¢˜ = LeetCode 2141 â†’ å®Œå…¨å¤ç”¨
- æœ¬é¢˜ = LeetCode 2149 â†’ æ”¹åˆ†åŒºæ–¹å‘
- æœ¬é¢˜ = LeetCode 4 â†’ ä¸é€‚ç”¨
- æœ¬é¢˜ = æ‰€æœ‰â€œTop K / ç¬¬ K å¤§å°â€é—®é¢˜

### ğŸ‰ æŒæ¡æˆå°±

ä½ ç°åœ¨å·²æŒæ¡â€œéšæœºåŒ–å¿«é€Ÿé€‰æ‹©â€è¿™ä¸€æ ¸å¿ƒç®—æ³•æ¨¡å¼ï¼Œèƒ½ç§’æ€ LeetCode 215ã€2141ã€2149 ä¸‰é“é¢˜ï¼è¿™ä¸ä»…æ˜¯è§£æ³•ï¼Œæ›´æ˜¯ä¸€ç§ç®—æ³•é€‰å‹ + æ¦‚ç‡ä¼˜åŒ–çš„å·¥ç¨‹æ€ç»´ï¼Œæ ‡å¿—ç€ä½ ä»â€œå†™ä»£ç â€è¿›é˜¶åˆ°â€œè®¾è®¡æœ€ä¼˜ç®—æ³•â€

### ğŸ“š çŸ¥è¯†å›¾è°±

```
[ç¬¬Kä¸ªæœ€å¤§å…ƒç´ ]
  â”‚
  â”œâ”€â†’ [é—®é¢˜æœ¬è´¨]
  â”‚    â”œâ”€â†’ é¡ºåºç»Ÿè®¡ï¼šåœ¨æ— åºæ•°ç»„ä¸­æ‰¾ç¬¬kå¤§å…ƒç´ 
  â”‚    â””â”€â†’ ç›®æ ‡ï¼šä¸æ’åºï¼Œå¿«é€Ÿå®šä½
  â”‚
  â”œâ”€â†’ [ç®—æ³•ç­–ç•¥]
  â”‚    â”œâ”€â†’ éšæœºåŒ–é€‰æ‹©åŸºå‡†
  â”‚    â”œâ”€â†’ é™åºåˆ†åŒºï¼š>=åŸºå‡†æ”¾å·¦
  â”‚    â”œâ”€â†’ è®¡ç®— rank = pivot_index - left + 1
  â”‚    â”œâ”€â†’ è‹¥ rank == k â†’ è¿”å›
  â”‚    â”œâ”€â†’ è‹¥ rank < k â†’ é€’å½’å³åŠï¼Œk -= rank
  â”‚    â””â”€â†’ è‹¥ rank > k â†’ é€’å½’å·¦åŠ
  â”‚
  â”œâ”€â†’ [æ ¸å¿ƒæŠ€å·§]
  â”‚    â”œâ”€â†’ éšæœºåŒ–æ‰“ç ´æœ€åç»“æ„
  â”‚    â”œâ”€â†’ rank è®¡ç®—å¿…é¡»åŸºäº leftï¼Œè€Œé right
  â”‚    â””â”€â†’ åŸåœ°æ ‡è®°ï¼Œç©ºé—´ O(log n)
  â”‚
  â”œâ”€â†’ [å¤ç”¨æ¨¡æ¿]
  â”‚    â”œâ”€â†’ åˆ†åŒºå‡½æ•°ï¼šé™åºåˆ†åŒº
  â”‚    â”œâ”€â†’ å¿«é€Ÿé€‰æ‹©ï¼šé€’å½’æ”¶ç¼©
  â”‚    â””â”€â†’ éšæœºåŒ–ï¼šrand.Intn
  â”‚
  â”œâ”€â†’ [æ—¶é—´å¤æ‚åº¦]
  â”‚    â”œâ”€â†’ æœŸæœ›ï¼šO(n)
  â”‚    â””â”€â†’ æœ€åï¼šO(nÂ²) â€”â€” æ¦‚ç‡æä½
  â”‚
  â””â”€â†’ [ç©ºé—´å¤æ‚åº¦]
       â””â”€â†’ O(log n) â€”â€” é€’å½’æ ˆæ·±åº¦
```

> âœ… æ¯æ—¥ä¸€ç»ƒï¼šé»˜å†™ä¿®æ­£ç‰ˆä»£ç  + æ‰‹åŠ¨ç”»å‡ºåˆ†åŒºè¿‡ç¨‹ + ç”¨å †å®ç°å¹¶å¯¹æ¯”æ€§èƒ½
> ğŸš€ ä½ å·²æŒæ¡â€œé¡ºåºç»Ÿè®¡æœ€ä¼˜è§£â€èƒ½åŠ›ï¼Œä¸‹ä¸€é¢˜ï¼Œç»§ç»­å¾æœï¼ğŸ¤—
