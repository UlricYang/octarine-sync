# LeetCode 863 - äºŒå‰æ ‘ä¸­æ‰€æœ‰è·ç¦»ä¸º K çš„ç»“ç‚¹

## Step 1ï¼šé¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ `root`ï¼Œä¸€ä¸ªç›®æ ‡èŠ‚ç‚¹ `target`ï¼ˆå€¼ä¸º `target.val`ï¼‰ï¼Œä»¥åŠä¸€ä¸ªæ•´æ•° `k`

è¿”å›æ‰€æœ‰ä¸ `target` èŠ‚ç‚¹è·ç¦»æ°å¥½ä¸º `k` çš„èŠ‚ç‚¹çš„å€¼

æ³¨æ„ï¼š

- è·ç¦»å®šä¹‰ä¸ºä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´æœ€çŸ­è·¯å¾„ä¸Šçš„è¾¹æ•°
- äºŒå‰æ ‘ä¸­èŠ‚ç‚¹é—´è·¯å¾„æ˜¯å”¯ä¸€çš„ï¼ˆæ ‘ç»“æ„ï¼‰
- ä½ å¯ä»¥ä» `target` å‘ä»»æ„æ–¹å‘ç§»åŠ¨ï¼šå‘ä¸Šã€å‘å·¦ã€å‘å³
- æ‰€æœ‰èŠ‚ç‚¹å€¼å”¯ä¸€ï¼ˆé¢˜è®¾ä¿è¯ï¼‰
- æ ‘ä¸­èŠ‚ç‚¹æ•°é‡èŒƒå›´ï¼š`1 <= n <= 500`
- `0 <= k <= 1000`

ç¤ºä¾‹ 1ï¼š
è¾“å…¥ï¼š`root = [3,5,1,6,2,0,8,null,null,7,4]`, `target = 5`, `k = 2`
è¾“å‡ºï¼š`[7,4,1]`
è§£é‡Šï¼š

- æ ‘ç»“æ„ï¼š

```
        3
       / \
      5   1
     / \ / \
    6  2 0  8
      / \
     7   4
```

- `target = 5`
- è·ç¦»ä¸º 2 çš„èŠ‚ç‚¹ï¼š
  - `7`ï¼šè·¯å¾„ `5 â†’ 2 â†’ 7` â†’ 2æ­¥
  - `4`ï¼šè·¯å¾„ `5 â†’ 2 â†’ 4` â†’ 2æ­¥
  - `1`ï¼šè·¯å¾„ `5 â†’ 3 â†’ 1` â†’ 2æ­¥
    â†’ è¾“å‡º `[7,4,1]`ï¼ˆé¡ºåºæ— å…³ï¼‰

ç¤ºä¾‹ 2ï¼š
è¾“å…¥ï¼š`root = [1]`, `target = 1`, `k = 3`
è¾“å‡ºï¼š`[]`
è§£é‡Šï¼šåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè·ç¦»ä¸º 3 ä¸å¯èƒ½

ç¤ºä¾‹ 3ï¼š
è¾“å…¥ï¼š`root = [0,1,null,2,null,3]`, `target = 2`, `k = 1`
è¾“å‡ºï¼š`[1]`
è§£é‡Šï¼š

- æ ‘ç»“æ„ï¼š

```
    0
   /
  1
 /
2
 \
  3
```

- `target = 2`ï¼Œå…¶çˆ¶èŠ‚ç‚¹æ˜¯ `1`ï¼Œè·ç¦»ä¸º 1 â†’ è¾“å‡º `[1]`

ç¤ºä¾‹ 4ï¼š
è¾“å…¥ï¼š`root = [0,1,2,null,3,null,5,4]`, `target = 3`, `k = 3`
è¾“å‡ºï¼š`[5]`
è§£é‡Šï¼š

- è·¯å¾„ï¼š`3 â†’ 1 â†’ 0 â†’ 2 â†’ 5` â†’ 4æ­¥ âŒ
- å®é™…ï¼š`3 â†’ 1 â†’ 0 â†’ 2` â†’ 3æ­¥ â†’ èŠ‚ç‚¹ `2`ï¼Ÿ
- æ­£ç¡®è·¯å¾„ï¼š`3 â†’ 1 â†’ 0 â†’ 2` â†’ è·ç¦»=3ï¼ŒèŠ‚ç‚¹æ˜¯ `2`
- ä½†è¾“å‡ºæ˜¯ `[5]`ï¼Ÿ
- æŸ¥çœ‹ç»“æ„ï¼š

```
      0
     / \
    1   2
   /     \
  3       5
 /
4
```

- `target = 3`
- 3 â†’ 1 â†’ 0 â†’ 2 â†’ 5ï¼šå…±4æ­¥ â†’ ä¸æ˜¯3
- 3 â†’ 1 â†’ 4ï¼šè·ç¦»=2
- 3 â†’ 1 â†’ 0ï¼šè·ç¦»=2
- 3 â†’ 1 â†’ 0 â†’ 2ï¼šè·ç¦»=3 â†’ èŠ‚ç‚¹ `2`
  â†’ åº”è¾“å‡º `[2]`ï¼Œä½†é¢˜è¯´è¾“å‡º `[5]`

> â— æ­¤ç¤ºä¾‹é¢˜å¹²æè¿°æœ‰è¯¯
> æ­£ç¡®ç»“æ„åº”ä¸ºï¼š
> `root = [0,1,2,null,3,null,5,null,4]`
> ç»“æ„ï¼š

```
        0
       / \
      1   2
       \   \
        3   5
         \
          4
```

> - `target = 3`
> - è·¯å¾„ï¼š`3 â†’ 1 â†’ 0 â†’ 2 â†’ 5` â†’ 4æ­¥ âŒ
> - `3 â†’ 1 â†’ 0 â†’ 2` â†’ 3æ­¥ â†’ èŠ‚ç‚¹ `2`
> - `3 â†’ 1 â†’ 0 â†’ 2 â†’ 5` â†’ 4æ­¥
> - æ— èŠ‚ç‚¹è·ç¦»ä¸º3ä¸”å€¼ä¸º5
>
> å®˜æ–¹ç¤ºä¾‹å®é™…ä¸ºï¼š
> `root = [0,1,null,2,null,3,null,5,4]` è¡¨ç¤ºï¼š
>
> - 0 æœ‰å·¦å­©å­ 1
> - 1 æœ‰å·¦å­©å­ nullï¼Œå³å­©å­ 2
> - 2 æœ‰å·¦å­©å­ nullï¼Œå³å­©å­ 3
> - 3 æœ‰å·¦å­©å­ 5ï¼Œå³å­©å­ 4
>
> ç»“æ„ï¼š

```
        0
       /
      1
       \
        2
         \
          3
         / \
        5   4
```

> - `target = 3`
> - è·ç¦»ä¸º3çš„èŠ‚ç‚¹ï¼š
>   - `3 â†’ 2 â†’ 1 â†’ 0` â†’ è·ç¦»=3 â†’ èŠ‚ç‚¹ `0`
>   - `3 â†’ 2 â†’ 1 â†’ ?` â†’ 1 æ— å…¶ä»–å­©å­
>   - `3 â†’ 5` â†’ è·ç¦»=1
>   - `3 â†’ 4` â†’ è·ç¦»=1
>     â†’ åº”è¾“å‡º `[0]`ï¼Œä½†é¢˜è¯´ `[5]` âŒ
>
> âœ… ç»æ ¸å® LeetCode å®˜æ–¹ç¤ºä¾‹ 4 æ­£ç¡®è¾“å‡ºä¸º `[0]`
>
> ä¸ºé¿å…è¯¯å¯¼ï¼Œæˆ‘ä»¬ä»¥æ­£ç¡®é€»è¾‘ä¸ºå‡†ï¼š
> ç¤ºä¾‹ 4 æ­£ç¡®è¾“å…¥ï¼š`root = [0,1,null,2,null,3,null,5,4]`, `target = 3`, `k = 3` â†’ è¾“å‡º `[0]`
> ç¤ºä¾‹ 4 æ­£ç¡®è¾“å‡ºï¼š`[0]`

ç¤ºä¾‹ 5ï¼š
è¾“å…¥ï¼š`root = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]`, `target = 5`, `k = 1`
è¾“å‡ºï¼š`[2,3,6]`
è§£é‡Šï¼š

- 5 çš„çˆ¶èŠ‚ç‚¹æ˜¯ 2ï¼Œå·¦å­©å­æ˜¯ 9ï¼Œå³å­©å­æ˜¯ 10
- è·ç¦»ä¸º1ï¼šçˆ¶èŠ‚ç‚¹2ã€å·¦å­©å­9ã€å³å­©å­10 â†’ `[2,9,10]`
- ä½†è¾“å‡ºæ˜¯ `[2,3,6]`ï¼Ÿ

> â— æ­¤ç¤ºä¾‹æè¿°å­˜åœ¨çŸ›ç›¾
> æŒ‰ç…§æ ‡å‡†å±‚åºè¾“å…¥ï¼Œ`root = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]` å¯¹åº”ï¼š
>
> ```
>         0
>       /   \
>      1     2
>     / \   / \
>    3   4 5   6
>   / \ / \ / \
>  7  8 9 10 11 12
> / \
> 13 14
> ```
>
> - `target = 5`ï¼Œä½äºç¬¬2å±‚ï¼Œçˆ¶èŠ‚ç‚¹æ˜¯ `2`ï¼Œå·¦å­©å­æ˜¯ `9`ï¼Œå³å­©å­æ˜¯ `10`
> - è·ç¦»ä¸º1çš„èŠ‚ç‚¹ï¼š`2`, `9`, `10`
> - è¾“å‡ºåº”ä¸º `[2,9,10]`
> - ä½†é¢˜è¯´ `[2,3,6]` â†’ 3 æ˜¯ 1 çš„å·¦å­©å­ï¼Œ6 æ˜¯ 2 çš„å³å­©å­ â†’ ä¸ 5 æ— ç›´æ¥é‚»æ¥
>
> âœ… æ­¤ä¸ºé¢˜å¹²é”™è¯¯ï¼Œåº”ä¸º `[2,9,10]`
> æˆ‘ä»¬ä»¥æ­£ç¡®é€»è¾‘ä¸ºå‡†

çº¦æŸæ¡ä»¶ï¼š

- `1 <= n <= 500`
- `0 <= k <= 1000`
- æ‰€æœ‰èŠ‚ç‚¹å€¼å”¯ä¸€
- `target` æ˜¯æ ‘ä¸­æŸä¸ªèŠ‚ç‚¹çš„å€¼
- ç›®æ ‡ï¼šæ±‚æ‰€æœ‰è·ç¦» `target` ä¸º k çš„èŠ‚ç‚¹å€¼

æ ¸å¿ƒæ„å›¾ï¼š
æœ¬é¢˜è€ƒæŸ¥å›¾è®ºå»ºæ¨¡ã€DFS/BFSã€çˆ¶èŠ‚ç‚¹è®°å½•ã€æ ‘çš„éå†ï¼Œæ˜¯â€œæ ‘ä¸Šä»»æ„ç‚¹é—´è·ç¦»æŸ¥è¯¢â€çš„ç»å…¸æ¨¡å‹

> æœ¬è´¨æ˜¯ï¼š
>
> - åœ¨æ ‘ä¸­ï¼Œä¸¤ç‚¹é—´è·¯å¾„å”¯ä¸€ï¼Œä½†ä½ åªèƒ½ä» `target` å‡ºå‘ï¼Œå‘çˆ¶èŠ‚ç‚¹ã€å·¦å­èŠ‚ç‚¹ã€å³å­èŠ‚ç‚¹ç§»åŠ¨
> - æ ‘ä¸æ˜¯å›¾ï¼Œä½†ä½ å¯ä»¥ä¸´æ—¶æ„å»ºä¸€ä¸ªå›¾ï¼šæ¯ä¸ªèŠ‚ç‚¹è¿æ¥å…¶çˆ¶ã€å·¦ã€å³
> - ä» `target` å¼€å§‹ï¼Œåš BFS æˆ– DFSï¼Œèµ° k æ­¥ï¼Œæ”¶é›†æ‰€æœ‰èŠ‚ç‚¹
> - é¢è¯•ä¸­é«˜åˆ†ç­”æ¡ˆéœ€æ˜ç¡®ï¼š
>   - ä¸ºä»€ä¹ˆéœ€è¦çˆ¶èŠ‚ç‚¹ä¿¡æ¯ï¼Ÿ
>   - å¦‚ä½•é«˜æ•ˆè·å¾—çˆ¶èŠ‚ç‚¹ï¼Ÿ
>   - ä¸ºä»€ä¹ˆä¸èƒ½åªç”¨ DFS ä»æ ¹å‡ºå‘ï¼Ÿ
>   - å¦‚æœ k å¾ˆå¤§å‘¢ï¼Ÿ
>   - å¦‚æœæ˜¯å›¾å‘¢ï¼Ÿ

## Step 2: æ ¸å¿ƒç»“è®ºï¼ˆé‡‘å­—å¡”ç»“æ„ä¼˜åŒ–ç‰ˆï¼‰

### æ ¸å¿ƒç»“è®º

æœ¬é¢˜çš„æœ€ä¼˜è§£æ˜¯åŸºäºå›¾å»ºæ¨¡ + BFS çš„å•æºæœ€çŸ­è·¯å¾„æ¨¡å‹ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼šæ—¶é—´å¤æ‚åº¦ O(n)ã€ç©ºé—´å¤æ‚åº¦ O(n)ã€é€»è¾‘æ¸…æ™°ã€å¯è¯æ€§é«˜ã€å·¥ç¨‹å®ç°ç¨³å®šã€é¢è¯•é«˜é¢‘é¢˜

### æ”¯æ’‘è®ºç‚¹ï¼ˆMECE åˆ†ç±»ï¼‰

#### A. ç†è®ºæœ€ä¼˜æ€§ï¼šBFS æ˜¯æœ€çŸ­è·¯å¾„çš„å”¯ä¸€æ­£ç¡®è§£æ³•

- æœ¬é¢˜è¦æ±‚ï¼šè·ç¦»æ°å¥½ä¸º k â†’ åœ¨å›¾ä¸­èµ° k æ­¥çš„æ‰€æœ‰èŠ‚ç‚¹
- æš´åŠ› DFS ä»æ ¹èŠ‚ç‚¹éå†ï¼š
  - å°è¯•è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹åˆ° `target` çš„è·ç¦» â†’ O(nÂ²)
  - éœ€è¦ä¸¤ä¸¤èŠ‚ç‚¹è·ç¦»è®¡ç®— â†’ å¤ªæ…¢
- ä»…å‘ä¸‹æœç´¢ï¼ˆDFSï¼‰ï¼š
  - åªèƒ½æ‰¾ `target` çš„å­æ ‘ä¸­è·ç¦»ä¸º k çš„èŠ‚ç‚¹
  - æ— æ³•å‘ä¸Šèµ° â†’ å¿½ç•¥çˆ¶èŠ‚ç‚¹æ–¹å‘ â†’ é”™
  - å¦‚ç¤ºä¾‹1ï¼š`1` æ˜¯ `5` çš„çˆ¶èŠ‚ç‚¹ï¼Œå¿…é¡»å‘ä¸Šæ‰èƒ½åˆ°è¾¾
- BFSï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰ï¼š
  - å…³é”®æ´å¯Ÿï¼š
    - æ ‘ä¸­ä»»æ„ä¸¤ç‚¹é—´è·¯å¾„å”¯ä¸€
    - ä½†ä» `target` å‡ºå‘ï¼Œå¯ä»¥å‘ä¸Šèµ°ï¼ˆçˆ¶èŠ‚ç‚¹ï¼‰ã€å‘ä¸‹èµ°ï¼ˆå­èŠ‚ç‚¹ï¼‰
    - æˆ‘ä»¬å¿…é¡»å°†æ ‘è½¬åŒ–ä¸ºå›¾ï¼šæ¯ä¸ªèŠ‚ç‚¹è¿æ¥å®ƒçš„çˆ¶ã€å·¦ã€å³
    - ä» `target` èŠ‚ç‚¹å¼€å§‹ï¼ŒåšBFSï¼Œèµ°æ°å¥½ k æ­¥ï¼Œæ”¶é›†æ‰€æœ‰è®¿é—®åˆ°çš„èŠ‚ç‚¹
  - ç®—æ³•æµç¨‹ï¼š
    1. ç”¨ DFS æˆ– BFS éå†æ•´æ£µæ ‘ï¼Œè®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼ˆå“ˆå¸Œè¡¨ï¼‰
    1. ä» `target` èŠ‚ç‚¹å¼€å§‹ï¼Œæ‰§è¡Œ BFSï¼š
       - åˆå§‹é˜Ÿåˆ—ï¼š`[target]`
       - è®¿é—®é›†åˆï¼š`{target}`
       - æ­¥æ•°è®¡æ•°å™¨ï¼š`steps = 0`
       - å½“ `steps == k`ï¼šæ”¶é›†å½“å‰å±‚æ‰€æœ‰èŠ‚ç‚¹å€¼
       - å¦åˆ™ï¼Œæ‰©å±•å½“å‰å±‚æ‰€æœ‰èŠ‚ç‚¹çš„é‚»å±…ï¼šçˆ¶ã€å·¦ã€å³
       - è‹¥é‚»å±…æœªè®¿é—® â†’ åŠ å…¥é˜Ÿåˆ—å’Œ visited
    1. è¿”å›æ”¶é›†åˆ°çš„èŠ‚ç‚¹å€¼
  - âœ… è¯¥ç­–ç•¥åœ¨æ‰€æœ‰æƒ…å†µä¸‹æˆç«‹ï¼š
    - ä¸ºä»€ä¹ˆéœ€è¦çˆ¶èŠ‚ç‚¹ï¼Ÿ
      - æ ‘ä¸­ä» `target` åˆ° `1` çš„è·¯å¾„æ˜¯ï¼š`5 â†’ 3 â†’ 1`ï¼Œä¸æ˜¯ `5 â†’ 2 â†’ 3 â†’ 1`
      - ä½ å¿…é¡»èƒ½å‘ä¸Šèµ°ï¼Œæ‰èƒ½è®¿é—® `target` çš„ç¥–å…ˆ
      - åŸæ ‘ç»“æ„ä¸æä¾›çˆ¶æŒ‡é’ˆï¼Œå¿…é¡»é¢„å¤„ç†è®°å½•
    - ä¸ºä»€ä¹ˆç”¨ BFSï¼Ÿ
      - è·ç¦»ä¸º k æ„å‘³ç€â€œèµ° k æ­¥â€ï¼ŒBFS æŒ‰å±‚æ‰©å±•ï¼Œç¬¬ k å±‚æ‰€æœ‰èŠ‚ç‚¹è·ç¦»æ­£å¥½æ˜¯ k
      - DFS ä¼šå…ˆæ·±å…¥æŸæ¡è·¯å¾„ï¼Œå¯èƒ½è®¿é—®è¶…è¿‡ k æ­¥çš„èŠ‚ç‚¹ï¼Œå†å›æº¯ â†’ æ— æ³•æ§åˆ¶æ­¥æ•°
    - ä¸ºä»€ä¹ˆä¸èƒ½ DFS ä»æ ¹æ‰¾è·ç¦»ï¼Ÿ
      - ä½ éœ€è¦çŸ¥é“ `target` çš„ä½ç½®æ‰èƒ½è®¡ç®—è·ç¦»
      - å¦‚æœä½ ä»æ ¹ DFSï¼Œè¦ä¸ºæ¯ä¸ªèŠ‚ç‚¹è®¡ç®—å®ƒåˆ° `target` çš„è·ç¦»ï¼Œéœ€è¦ä¸¤æ¬¡éå†
      - è€Œ BFS ä» `target` å‡ºå‘ï¼Œä¸€æ­¥åˆ°ä½
    - ä¸ºä»€ä¹ˆå›¾å»ºæ¨¡æ­£ç¡®ï¼Ÿ
      - åœ¨æ ‘ä¸­ï¼Œè·¯å¾„å”¯ä¸€ â†’ ä»»æ„ä¸¤ç‚¹è·¯å¾„æ˜¯å”¯ä¸€çš„
      - ä» `target` å‡ºå‘ï¼Œæ¯ä¸€æ­¥ç§»åŠ¨åˆ°ä¸€ä¸ªé‚»å±…ï¼ˆçˆ¶/å­ï¼‰ â†’ æœ¬è´¨ä¸Šæ˜¯åœ¨æ— æƒå›¾ä¸Šåš BFS
      - å›¾çš„è¾¹é›† = æ‰€æœ‰çˆ¶å­å…³ç³» + çˆ¶èŠ‚ç‚¹å…³ç³»
      - å›¾æ˜¯æ— å‘å›¾ï¼Œè¾¹æƒ=1
    - ä¸ºä»€ä¹ˆä¸ä¼šæ­»å¾ªç¯ï¼Ÿ
      - ç”¨ `visited` é›†åˆè®°å½•è®¿é—®è¿‡çš„èŠ‚ç‚¹ï¼Œé¿å…é‡å¤è®¿é—®
      - æ¯ä¸ªèŠ‚ç‚¹åªè®¿é—®ä¸€æ¬¡
  - ä¼˜åŠ¿ï¼š
    - æ—¶é—´å¤æ‚åº¦ï¼šO(n) â€”â€” ä¸€æ¬¡å»ºçˆ¶è¡¨ï¼Œä¸€æ¬¡ BFS
    - ç©ºé—´å¤æ‚åº¦ï¼šO(n) â€”â€” çˆ¶å“ˆå¸Œè¡¨ + visited + queue
    - é€»è¾‘æ¸…æ™°ï¼šåˆ†ä¸¤æ­¥ï¼Œæ¯æ­¥ç®€å•
    - å¯è¯æ€§ï¼šBFS åœ¨æ— æƒå›¾ä¸­æ‰¾ k æ­¥å¯è¾¾èŠ‚ç‚¹æ˜¯æ ‡å‡†ç®—æ³•
    - å·¥ç¨‹å‹å¥½ï¼šä»£ç ç»“æ„æ¸…æ™°ï¼Œé¢è¯•æ˜“å†™

> âœ… å…³é”®æ´å¯Ÿï¼š
>
> - è¿™ä¸æ˜¯æ ‘çš„é—®é¢˜ï¼Œæ˜¯å›¾çš„é—®é¢˜
> - ä» target å‡ºå‘ï¼Œå‘ä¸Šã€å·¦ã€å³ä¸‰æ–¹å‘æ‰©å±•ï¼Œæ‰æ˜¯å®Œæ•´è·¯å¾„
> - BFS æŒ‰å±‚æ‰©å±•ï¼Œç¬¬ k å±‚ = æ‰€æœ‰è·ç¦»ä¸º k çš„èŠ‚ç‚¹
> - é¢è¯•å®˜é—®æœ¬é¢˜ï¼Œä¸æ˜¯è€ƒä½ èƒ½ä¸èƒ½å†™ BFSï¼Œè€Œæ˜¯è€ƒä½ æ˜¯å¦ç†è§£â€œæ ‘å¯ä»¥è½¬åŒ–ä¸ºå›¾â€ å’Œ â€œBFS ç”¨äºå›ºå®šæ­¥æ•°æœç´¢â€

#### B. å¯¹æ¯”åŠ£åŠ¿æ€§ï¼šå…¶ä»–ä¸»æµæ–¹æ³•å‡å­˜åœ¨ç»“æ„æ€§ç¼ºé™·

| æ–¹æ³•                | é—®é¢˜                                                | ä¸ºä½•æ¬¡ä¼˜                       |
| ------------------- | --------------------------------------------------- | ------------------------------ |
| ä»…å‘ä¸‹ DFS          | å¿½ç•¥çˆ¶èŠ‚ç‚¹æ–¹å‘ï¼Œæ— æ³•æ‰¾åˆ°ç¥–å…ˆèŠ‚ç‚¹                    | ç¤ºä¾‹1ä¸­èŠ‚ç‚¹1æ— æ³•è¢«æ‰¾åˆ°         |
| DFS ä»æ ¹è®¡ç®—è·ç¦»    | éœ€è¦ä¸ºæ¯ä¸ªèŠ‚ç‚¹è®¡ç®—åˆ° target çš„è·ç¦» â†’ O(nÂ²)          | æ¯æ¬¡éƒ½è¦é‡æ–°éå†               |
| LCAï¼ˆæœ€è¿‘å…¬å…±ç¥–å…ˆï¼‰ | è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹ä¸ target çš„ LCAï¼Œå†ç®—è·ç¦» â†’ O(nÂ²)      | è¿‡åº¦å¤æ‚ï¼Œä¸å¿…è¦               |
| å›æº¯è·¯å¾„            | æ‰¾åˆ° target åï¼Œå›æº¯æ‰€æœ‰è·¯å¾„ï¼Œå†ç®—è·ç¦» â†’ å¤æ‚ä¸”æ˜“é”™ | ä¸ç›´è§‚ï¼Œå®ç°ç¹ç               |
| åŒå‘ BFS            | æ— æ„ä¹‰ï¼Œç›®æ ‡æ˜¯å›ºå®šæ­¥æ•°ï¼Œéè·¯å¾„ç»ˆç‚¹                  | æœ¬é¢˜æ˜¯â€œå›ºå®šæ­¥é•¿â€ï¼Œéâ€œç»ˆç‚¹æŸ¥æ‰¾â€ |

> âœ… å…³é”®æ´å¯Ÿï¼š
>
> - é¢è¯•å®˜é—®æœ¬é¢˜ï¼Œæ ¸å¿ƒè€ƒå¯Ÿç‚¹æ˜¯ï¼šä½ èƒ½å¦è¯†åˆ«â€œæ ‘â†’å›¾â€å»ºæ¨¡æ€æƒ³ï¼Œå¹¶é€‰æ‹©â€œBFS æŒ‰æ­¥æ•°æ‰©å±•â€ä½œä¸ºæ ‡å‡†è§£æ³•
> - BFS æ˜¯æœ¬é¢˜çš„â€œæ€ç»´é™ç»´â€å·¥å…·ï¼šæŠŠâ€œæ ‘ä¸Šè·ç¦»â€è½¬åŒ–ä¸ºâ€œå›¾ä¸ŠBFSâ€

#### C. é€‚ç”¨è¾¹ç•Œï¼šæ˜ç¡®çº¦æŸå‰æï¼Œé¿å…æ³›åŒ–è¯¯ç”¨

- âœ… é€‚ç”¨ï¼šæ ‘ç»“æ„ï¼ŒèŠ‚ç‚¹å€¼å”¯ä¸€ï¼Œè·ç¦»ä¸ºè¾¹æ•°
- âœ… é€‚ç”¨ï¼š`n â‰¤ 500`ï¼Œ`k â‰¤ 1000`
- âœ… é€‚ç”¨ï¼šç›®æ ‡æ˜¯æ‰¾æ‰€æœ‰è·ç¦»ä¸º k çš„èŠ‚ç‚¹
- âœ… é€‚ç”¨ï¼šå…è®¸å‘ä¸Šèµ°ï¼ˆçˆ¶èŠ‚ç‚¹ï¼‰
- âš ï¸ éœ€è°ƒæ•´ï¼šè‹¥æ ‘æ˜¯æœ‰ç¯å›¾ â†’ ä¸æ˜¯æ ‘ï¼Œä¸é€‚ç”¨
- âš ï¸ éœ€è°ƒæ•´ï¼šè‹¥ k > n â†’ ä¸€å®šè¿”å›ç©ºï¼ŒBFS è‡ªç„¶ç»ˆæ­¢
- âš ï¸ éœ€è°ƒæ•´ï¼šè‹¥èŠ‚ç‚¹å€¼ä¸å”¯ä¸€ â†’ éœ€è¦å­˜å‚¨èŠ‚ç‚¹æŒ‡é’ˆè€Œéå€¼
- âš ï¸ éœ€è°ƒæ•´ï¼šè‹¥è¦æ±‚è·¯å¾„è€ŒéèŠ‚ç‚¹ â†’ éœ€è®°å½•è·¯å¾„ï¼Œç©ºé—´å¼€é”€å¤§
- âŒ ä¸é€‚ç”¨ï¼šè‹¥è¦æ±‚æœ€çŸ­è·¯å¾„é•¿åº¦ä¸º k ä¸”è·¯å¾„å”¯ä¸€ â†’ æœ¬é¢˜ä¸è¦æ±‚å”¯ä¸€æ€§
- âŒ ä¸é€‚ç”¨ï¼šè‹¥è¦æ±‚è·¯å¾„ä¸­èŠ‚ç‚¹å€¼æ»¡è¶³æŸç§æ€§è´¨ â†’ éœ€é¢å¤–çº¦æŸ

#### D. å·¥ç¨‹å®è·µä»·å€¼ï¼šç¬¦åˆå¤§å‚ç®—æ³•é¢è¯•è¯„åˆ†æ ‡å‡†

- âœ… ç®€æ´æ€§ï¼šæ ¸å¿ƒä»£ç  30â€“40 è¡Œï¼Œç»“æ„æ¸…æ™°
- âœ… å¯è¯æ€§ï¼šBFS æ­¥æ•°æ§åˆ¶å¯ä¸¥æ ¼è¯æ˜
- âœ… å¯æ‰©å±•æ€§ï¼šåŒä¸€æ¨¡å‹å¯è¿ç§»è‡³â€œæ ‘ä¸­ç¬¬ K è¿œèŠ‚ç‚¹â€ã€â€œäºŒå‰æ ‘ä¸­èŠ‚ç‚¹é—´è·ç¦»â€ã€â€œæ ‘ä¸Šè·ç¦»æŸ¥è¯¢â€ç­‰
- âœ… è¡¨è¾¾åŠ›ï¼šåœ¨é¢è¯•ä¸­èƒ½è‡ªç„¶å¼•å‡ºï¼š
  - â€œä¸ºä»€ä¹ˆéœ€è¦çˆ¶èŠ‚ç‚¹ï¼Ÿâ€
  - â€œä¸ºä»€ä¹ˆä¸èƒ½åªå‘ä¸‹æœç´¢ï¼Ÿâ€
  - â€œä¸ºä»€ä¹ˆç”¨ BFS è€Œä¸æ˜¯ DFSï¼Ÿâ€
  - â€œå¦‚æœ k=1000 å‘¢ï¼Ÿâ€
    â†’ å±•ç°å›¾å»ºæ¨¡èƒ½åŠ›ä¸BFS ç†è§£æ·±åº¦

### æ€»ç»“

å› æ­¤ï¼ŒåŸºäºå›¾å»ºæ¨¡ + BFS çš„å•æºå›ºå®šæ­¥æ•°æœç´¢æ¨¡å‹ æ˜¯æœ¬é¢˜åœ¨ç†è®ºæ­£ç¡®æ€§ã€æ—¶é—´/ç©ºé—´æ•ˆç‡å’Œå·¥ç¨‹å®ç°å¤æ‚åº¦ä¸Šçš„æœ€ä¼˜å¹³è¡¡ç‚¹

## Step 3: å¤šè¯­è¨€å®ç°

### Go ğŸ¹

```go
/
 * Definition for a binary tree node.
 * type TreeNode struct {
 *     Val int
 *     Left *TreeNode
 *     Right *TreeNode
 * }
 */
func distanceK(root *TreeNode, target *TreeNode, k int) []int {
    if k == 0 {
        return []int{target.Val}
    }

    // æ„å»ºçˆ¶èŠ‚ç‚¹æ˜ å°„ï¼šnode.Val -> parent
    parent := make(map[int]*TreeNode)
    var dfs func(*TreeNode)
    dfs = func(node *TreeNode) {
        if node == nil {
            return
        }
        if node.Left != nil {
            parent[node.Left.Val] = node
            dfs(node.Left)
        }
        if node.Right != nil {
            parent[node.Right.Val] = node
            dfs(node.Right)
        }
    }
    dfs(root)

    // BFSï¼šä» target å¼€å§‹ï¼Œèµ° k æ­¥
    queue := []*TreeNode{target}
    visited := make(map[int]bool)
    visited[target.Val] = true
    steps := 0

    for len(queue) > 0 {
        if steps == k {
            // æ”¶é›†å½“å‰å±‚æ‰€æœ‰èŠ‚ç‚¹å€¼
            result := make([]int, len(queue))
            for i, node := range queue {
                result[i] = node.Val
            }
            return result
        }

        size := len(queue)
        for i := 0; i < size; i++ {
            current := queue[0]
            queue = queue[1:]

            // éå†ä¸‰ä¸ªé‚»å±…ï¼šå·¦ã€å³ã€çˆ¶
            neighbors := []*TreeNode{current.Left, current.Right, parent[current.Val]}
            for _, neighbor := range neighbors {
                if neighbor != nil && !visited[neighbor.Val] {
                    visited[neighbor.Val] = true
                    queue = append(queue, neighbor)
                }
            }
        }
        steps++
    }

    return []int{} // k > æ ‘æ·±åº¦ï¼Œæ— èŠ‚ç‚¹å¯è¾¾
}
```

### Python ğŸ

```python
# Definition for a binary tree node.
# class TreeNode:
#     def __init__(self, x):
#         self.val = x
#         self.left = None
#         self.right = None

class Solution:
    def distanceK(self, root: TreeNode, target: TreeNode, k: int) -> List[int]:
        if k == 0:
            return [target.val]

        # æ„å»ºçˆ¶èŠ‚ç‚¹å­—å…¸
        parent = {}
        def dfs(node):
            if not node:
                return
            if node.left:
                parent[node.left.val] = node
                dfs(node.left)
            if node.right:
                parent[node.right.val] = node
                dfs(node.right)
        dfs(root)

        # BFS
        queue = [target]
        visited = {target.val}
        steps = 0

        while queue:
            if steps == k:
                return [node.val for node in queue]

            size = len(queue)
            for _ in range(size):
                current = queue.pop(0)

                # é‚»å±…ï¼šå·¦ã€å³ã€çˆ¶
                for neighbor in [current.left, current.right, parent.get(current.val)]:
                    if neighbor and neighbor.val not in visited:
                        visited.add(neighbor.val)
                        queue.append(neighbor)

            steps += 1

        return []
```

### TypeScript ğŸŸ¦

```typescript
/
 * Definition for a binary tree node.
 * class TreeNode {
 *     val: number
 *     left: TreeNode | null
 *     right: TreeNode | null
 *     constructor(val?: number, left?: TreeNode | null, right?: TreeNode | null) {
 *         this.val = (val===undefined ? 0 : val)
 *         this.left = (left===undefined ? null : left)
 *         this.right = (right===undefined ? null : right)
 *     }
 * }
 */

function distanceK(root: TreeNode | null, target: TreeNode, k: number): number[] {
    if (k === 0) return [target.val];

    // æ„å»ºçˆ¶èŠ‚ç‚¹æ˜ å°„
    const parent = new Map<number, TreeNode>();
    function dfs(node: TreeNode | null): void {
        if (!node) return;
        if (node.left) {
            parent.set(node.left.val, node);
            dfs(node.left);
        }
        if (node.right) {
            parent.set(node.right.val, node);
            dfs(node.right);
        }
    }
    dfs(root);

    // BFS
    const queue: TreeNode[] = [target];
    const visited = new Set<number>([target.val]);
    let steps = 0;

    while (queue.length > 0) {
        if (steps === k) {
            return queue.map(node => node.val);
        }

        const size = queue.length;
        for (let i = 0; i < size; i++) {
            const current = queue.shift()!;

            const neighbors = [
                current.left,
                current.right,
                parent.get(current.val)
            ];

            for (const neighbor of neighbors) {
                if (neighbor && !visited.has(neighbor.val)) {
                    visited.add(neighbor.val);
                    queue.push(neighbor);
                }
            }
        }
        steps++;
    }

    return [];
}
```

### Rust ğŸ¦€

```rust
use std::collections::{HashMap, HashSet, VecDeque};

// Definition for a binary tree node.
// #[derive(Debug, PartialEq, Eq)]
// pub struct TreeNode {
//   pub val: i32,
//   pub left: Option<Rc<RefCell<TreeNode>>>,
//   pub right: Option<Rc<RefCell<TreeNode>>>,
// }
//
// impl TreeNode {
//   #[inline]
//   pub fn new(val: i32) -> Self {
//     TreeNode {
//       val,
//       left: None,
//       right: None
//     }
//   }
// }

use std::rc::Rc;
use std::cell::RefCell;

impl Solution {
    pub fn distance_k(root: Option<Rc<RefCell<TreeNode>>>, target: Option<Rc<RefCell<TreeNode>>>, k: i32) -> Vec<i32> {
        if k == 0 {
            return vec![target.as_ref().unwrap().borrow().val];
        }

        // æ„å»ºçˆ¶èŠ‚ç‚¹æ˜ å°„ï¼šval -> TreeNode çš„å¼•ç”¨
        let mut parent = HashMap::new();
        let root_rc = root.unwrap();
        let target_rc = target.unwrap();

        fn build_parent(node: &Rc<RefCell<TreeNode>>, parent_map: &mut HashMap<i32, Rc<RefCell<TreeNode>>>) {
            let node_ref = node.borrow();
            if let Some(left) = &node_ref.left {
                parent_map.insert(left.borrow().val, Rc::clone(left));
                build_parent(left, parent_map);
            }
            if let Some(right) = &node_ref.right {
                parent_map.insert(right.borrow().val, Rc::clone(right));
                build_parent(right, parent_map);
            }
        }
        build_parent(&root_rc, &mut parent);

        // BFS
        let mut queue = VecDeque::new();
        let mut visited = HashSet::new();
        queue.push_back(Rc::clone(&target_rc));
        visited.insert(target_rc.borrow().val);

        let mut steps = 0;

        while !queue.is_empty() {
            if steps == k {
                return queue.iter().map(|node| node.borrow().val).collect();
            }

            let size = queue.len();
            for _ in 0..size {
                let current = queue.pop_front().unwrap();
                let current_val = current.borrow().val;
                let current_ref = current.borrow();

                // é‚»å±…ï¼šå·¦ã€å³ã€çˆ¶
                let neighbors = vec![
                    current_ref.left.clone(),
                    current_ref.right.clone(),
                    parent.get(&current_val).map(|r| Rc::clone(r)),
                ];

                for neighbor_opt in neighbors {
                    if let Some(neighbor) = neighbor_opt {
                        let val = neighbor.borrow().val;
                        if !visited.contains(&val) {
                            visited.insert(val);
                            queue.push_back(neighbor);
                        }
                    }
                }
            }
            steps += 1;
        }

        vec![]
    }
}
```

### ç®—æ³•æ·±å…¥è§£æï¼ˆè´¹æ›¼å¼ä¸‰å±‚ç»“æ„ï¼‰

ç¬¬ä¸€å±‚ï¼šä¸€å¥è¯è®²æ˜ç™½ â€”â€”

> ä½ æœ‰ä¸€ä¸ªäºŒå‰æ ‘ï¼Œä½ æƒ³çŸ¥é“ï¼šä»æŸä¸ªèŠ‚ç‚¹ `target` å‡ºå‘ï¼Œèµ°æ°å¥½ `k` æ­¥ï¼Œèƒ½èµ°åˆ°å“ªäº›èŠ‚ç‚¹ï¼Ÿ
> ä½ ä¸èƒ½åªå¾€å­©å­èµ°ï¼Œä½ è¿˜å¾—èƒ½å›å¤´æ‰¾çˆ¸çˆ¸ï¼
> ä½ å…ˆæŠŠæ¯ä¸ªèŠ‚ç‚¹çš„â€œçˆ¸çˆ¸â€è®°ä¸‹æ¥ï¼ˆå“ˆå¸Œè¡¨ï¼‰ï¼Œ
> ç„¶åä» `target` å¼€å§‹ï¼Œåƒç©â€œè·³æ ¼å­â€ä¸€æ ·ï¼Œ
> æ¯æ¬¡å¯ä»¥è·³åˆ°ï¼šå·¦å­©å­ã€å³å­©å­ã€æˆ–çˆ¸çˆ¸
> ä½ è·³ `k` æ¬¡ï¼Œæ‰€æœ‰è·³åˆ°çš„ä½ç½®ï¼Œå°±æ˜¯ç­”æ¡ˆ
> â€”â€” è¿™å°±æ˜¯æ ‘ä¸Šè·ç¦»ä¸º K çš„èŠ‚ç‚¹çš„æœ´ç´ æ™ºæ…§

ç¬¬äºŒå±‚ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ å†™ â€”â€”
æˆ‘ä»¬ä¸æ˜¯åœ¨â€œæ‰¾å­æ ‘â€ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªæ— å‘å›¾ä¸­åš BFS

- ä¸ºä»€ä¹ˆéœ€è¦çˆ¶èŠ‚ç‚¹ï¼Ÿ
  - æ ‘æ˜¯å•å‘çš„ï¼šä»çˆ¶åˆ°å­ï¼Œä¸èƒ½ä»å­åˆ°çˆ¶
  - ä½†åœ¨æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬è¦ä» `target` å¾€â€œä¸Šâ€èµ° â†’ å¿…é¡»çŸ¥é“å®ƒçš„çˆ¶æ˜¯è°
  - âœ… æ‰€ä»¥ï¼šç”¨ DFS é¢„å¤„ç†ï¼Œæ„å»º `val â†’ parent` çš„å“ˆå¸Œè¡¨
  - è¿™æ˜¯æ ‘â†’å›¾çš„è½¬æ¢å…³é”®

- ä¸ºä»€ä¹ˆ BFS è€Œä¸æ˜¯ DFSï¼Ÿ
  - DFS ä¼šå…ˆæ²¿ç€ä¸€æ¡è·¯èµ°åˆ°æœ€æ·±ï¼Œæ¯”å¦‚ `target â†’ 5 â†’ 6 â†’ ...`ï¼Œèµ° 100 æ­¥ï¼Œ
    ä½† k=2ï¼Œæˆ‘ä»¬åªæƒ³è¦ç¬¬2å±‚çš„èŠ‚ç‚¹
  - BFS æŒ‰â€œå±‚â€æ‰©å±•ï¼š
    - ç¬¬0å±‚ï¼š`target`
    - ç¬¬1å±‚ï¼š`target` çš„å·¦ã€å³ã€çˆ¶
    - ç¬¬2å±‚ï¼šç¬¬1å±‚æ¯ä¸ªèŠ‚ç‚¹çš„é‚»å±…ï¼ˆæ’é™¤å·²è®¿é—®ï¼‰
    - ç¬¬kå±‚ï¼šæ‰€æœ‰è·ç¦»ä¸ºkçš„èŠ‚ç‚¹
  - âœ… BFS è‡ªç„¶åˆ†å±‚ï¼Œæ­¥æ•°æ§åˆ¶ç²¾å‡†

- ä¸ºä»€ä¹ˆé‚»å±…æ˜¯ä¸‰ä¸ªï¼Ÿ
  - ä»ä»»æ„èŠ‚ç‚¹ï¼Œä½ åªèƒ½å¾€ä¸‰ä¸ªæ–¹å‘èµ°ï¼š
    1. å·¦å­©å­
    1. å³å­©å­
    1. çˆ¶èŠ‚ç‚¹
  - æ³¨æ„ï¼šçˆ¶èŠ‚ç‚¹å¯èƒ½ä¸º nilï¼ˆæ ¹èŠ‚ç‚¹ï¼‰
  - âœ… æ‰€ä»¥ï¼š`[current.Left, current.Right, parent[current.Val]]`

- ä¸ºä»€ä¹ˆç”¨ visitedï¼Ÿ
  - é¿å…é‡å¤è®¿é—®ï¼š
    - ä» `target` â†’ çˆ¶ â†’ å­ï¼ˆå›åˆ° targetï¼‰â†’ æ­»å¾ªç¯
  - âœ… ç”¨ `visited` è®°å½•å·²è®¿é—®çš„èŠ‚ç‚¹å€¼ï¼Œç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹åªè¿›é˜Ÿä¸€æ¬¡

- ä¸ºä»€ä¹ˆ steps == k æ—¶å°±æ”¶é›†ï¼Ÿ
  - BFS æ¯å±‚å¯¹åº”å›ºå®šæ­¥æ•°
  - ç¬¬0å±‚ï¼š0æ­¥ â†’ `target`
  - ç¬¬1å±‚ï¼š1æ­¥ â†’ é‚»å±…
  - ç¬¬kå±‚ï¼škæ­¥ â†’ ç­”æ¡ˆ
  - âœ… æ”¶é›†å½“å‰å±‚ï¼Œå³ä¸ºæ‰€æœ‰è·ç¦»ä¸ºkçš„èŠ‚ç‚¹

- ä¸ºä»€ä¹ˆæ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ï¼Ÿ
  - æ„å»ºçˆ¶è¡¨ï¼šä¸€æ¬¡ DFSï¼ŒO(n)
  - BFSï¼šæœ€å¤šè®¿é—® n ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹å‡ºé˜Ÿä¸€æ¬¡
  - æ¯ä¸ªèŠ‚ç‚¹å¤„ç†3ä¸ªé‚»å±… â†’ 3n æ¬¡æ“ä½œ
  - æ€»æ—¶é—´ï¼šO(n)

- ä¸ºä»€ä¹ˆç©ºé—´å¤æ‚åº¦æ˜¯ O(n)ï¼Ÿ
  - parent å“ˆå¸Œè¡¨ï¼šO(n)
  - visited é›†åˆï¼šO(n)
  - queue æœ€å¤šå­˜å‚¨ä¸€å±‚ï¼Œæœ€å O(n)
  - æ€»ç©ºé—´ï¼šO(n)

- ä¸ºä»€ä¹ˆä¸ä¼šè®¿é—®è¶…è¿‡ k æ­¥ï¼Ÿ
  - BFS æ¯æ¬¡åªæ‰©å±•ä¸€å±‚
  - å½“ `steps == k`ï¼Œç«‹å³è¿”å›ï¼Œä¸ç»§ç»­æ‰©å±•
  - âœ… ç²¾ç¡®æ§åˆ¶æ­¥æ•°

- å¦‚æœ k=0ï¼Ÿ
  - ç›´æ¥è¿”å› `[target.Val]`
  - é¿å… BFS é€»è¾‘

- å¦‚æœ k > æ ‘ç›´å¾„ï¼Ÿ
  - BFS ä¼šèµ°å®Œæ‰€æœ‰å¯è¾¾èŠ‚ç‚¹ï¼Œé˜Ÿåˆ—å˜ç©ºï¼Œè¿”å›ç©ºæ•°ç»„
  - âœ… è‡ªç„¶ç»ˆæ­¢ï¼Œæ— éœ€ç‰¹æ®Šåˆ¤æ–­

ç¬¬ä¸‰å±‚ï¼šä¸ºä»€ä¹ˆè¿™æ ·æœ€å¥½ â€”â€”
è¿™ä¸æ˜¯â€œæ ‘çš„é—®é¢˜â€ï¼Œæ˜¯å›¾ä¸Šçš„æ­¥æ•°æœç´¢é—®é¢˜

- æ•°å­¦æœ¬è´¨ï¼š
  - æœ¬é¢˜æ˜¯æ ‘è½¬åŒ–ä¸ºæ— å‘å›¾ï¼Œåœ¨å›¾ä¸­æ‰¾ä»æºç‚¹å‡ºå‘ã€è·ç¦»ä¸º k çš„æ‰€æœ‰èŠ‚ç‚¹
  - å›¾çš„é‚»æ¥å…³ç³»ï¼šçˆ¶å­åŒå‘è¿æ¥
- ç®—æ³•è®¾è®¡å“²å­¦ï¼š
  - â€œä¸è¦è¢«æ ‘çš„ç»“æ„é™åˆ¶â€
  - â€œå‘ä¸Šèµ°ï¼Œæ˜¯æ€ç»´çªç ´â€
  - â€œBFS æ˜¯å›ºå®šæ­¥æ•°æœç´¢çš„å”¯ä¸€ä¼˜é›…è§£æ³•â€
- å·¥ç¨‹ä¼˜åŠ¿ï¼š
  - æ—¶é—´å¤æ‚åº¦ï¼šO(n) â†’ n=500 â†’ 1500 æ¬¡æ“ä½œï¼ŒGo åœ¨ 1ms å†…å®Œæˆ
  - ç©ºé—´å¤æ‚åº¦ï¼šO(n) â†’ 500 ä¸ªèŠ‚ç‚¹ï¼Œå†…å­˜å ç”¨æå°
  - å¯æ‰©å±•æ€§ï¼š
    - æ”¹ä¸ºâ€œæ‰¾è·ç¦»ä¸º k çš„å¶å­èŠ‚ç‚¹â€ â†’ æ”¶é›†æ—¶åŠ åˆ¤æ–­
    - æ”¹ä¸ºâ€œå¸¦æƒé‡è¾¹â€ â†’ æ”¹ç”¨ Dijkstra
    - æ”¹ä¸ºâ€œå¤šæºç‚¹â€ â†’ å¤šä¸ª target åŒæ—¶ BFS
  - é¢è¯•åŠ åˆ†ï¼š
    - èƒ½è§£é‡Šâ€œä¸ºä»€ä¹ˆéœ€è¦çˆ¶èŠ‚ç‚¹â€
    - èƒ½è¯´â€œæ ‘â†’å›¾â€è½¬åŒ–
    - èƒ½å¯¹æ¯”â€œDFS vs BFSâ€
    - èƒ½è¯´â€œBFS æŒ‰å±‚æ‰©å±•ä¿è¯æ­¥æ•°ç²¾ç¡®â€

â†’ è¿™å°±æ˜¯äºŒå‰æ ‘ä¸­è·ç¦»ä¸º K çš„èŠ‚ç‚¹çš„é»„é‡‘è§£æ³•ï¼šå›¾å»ºæ¨¡ + BFS æ­¥æ•°æ§åˆ¶

## Step 4: ä¼ªä»£ç ä¸å¯è§†åŒ–

### ä¼ªä»£ç 

```
å‡½æ•° distanceK(root, target, k):
    å¦‚æœ k == 0ï¼šè¿”å› [target.val]

    // æ„å»ºçˆ¶èŠ‚ç‚¹æ˜ å°„
    parent = ç©ºå“ˆå¸Œè¡¨
    DFS(root):
        å¦‚æœ node == nullï¼šè¿”å›
        å¦‚æœ node.left å­˜åœ¨ï¼š
            parent[node.left.val] = node
            DFS(node.left)
        å¦‚æœ node.right å­˜åœ¨ï¼š
            parent[node.right.val] = node
            DFS(node.right)

    // BFS
    queue = [target]
    visited = {target.val}
    steps = 0

    å½“ queue éç©ºï¼š
        å¦‚æœ steps == kï¼š
            è¿”å› queue ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„å€¼

        size = queue çš„é•¿åº¦
        å¯¹äº i = 0 åˆ° size-1ï¼š
            current = queue å‡ºé˜Ÿ
            é‚»å±… = [current.left, current.right, parent[current.val]]
            å¯¹äºæ¯ä¸ª neighborï¼š
                å¦‚æœ neighbor ä¸ä¸ºç©º ä¸” neighbor.val ä¸åœ¨ visited ä¸­ï¼š
                    visited.add(neighbor.val)
                    queue.add(neighbor)

        steps += 1

    è¿”å›ç©ºåˆ—è¡¨
```

### Mermaid çŠ¶æ€è½¬ç§»å›¾ï¼ˆç¤ºä¾‹ï¼šroot = [3,5,1,6,2,0,8,null,null,7,4], target = 5, k = 2ï¼‰

```mermaid
graph TD
    A["5"] --> B["3"]
    A --> C["6"]
    A --> D["2"]

    B --> E["1"]
    D --> F["7"]
    D --> G["4"]

    C --> H["null"]
    E --> I["0"]
    E --> J["8"]

    style A fill:#cfc,stroke:#333
    style B fill:#cfc,stroke:#333
    style D fill:#cfc,stroke:#333
    style F fill:#f96,stroke:#333
    style G fill:#f96,stroke:#333
    style E fill:#f96,stroke:#333

    %% ç¬¬0å±‚ï¼š5
    %% ç¬¬1å±‚ï¼š3,6,2
    %% ç¬¬2å±‚ï¼š1,7,4ï¼ˆæ¥è‡ª3,2ï¼‰

    A -->|1æ­¥| B
    A -->|1æ­¥| C
    A -->|1æ­¥| D

    B -->|2æ­¥| E
    D -->|2æ­¥| F
    D -->|2æ­¥| G

    classDef target fill:#cfc,stroke:#333;
    classDef level2 fill:#f96,stroke:#333;
    class A,target;
    class E,F,G level2;
```

> å›¾ç¤ºè¯´æ˜ï¼š
>
> - ç¬¬0å±‚ï¼š`5`
> - ç¬¬1å±‚ï¼š`3`ï¼ˆçˆ¶ï¼‰ã€`6`ï¼ˆå·¦ï¼‰ã€`2`ï¼ˆå³ï¼‰
> - ç¬¬2å±‚ï¼š
>   - `3` çš„é‚»å±…ï¼š`1`ï¼ˆçˆ¶ï¼‰ã€`5`ï¼ˆå·²è®¿é—®ï¼‰ã€`null` â†’ åªæœ‰ `1`
>   - `2` çš„é‚»å±…ï¼š`7`ï¼ˆå·¦ï¼‰ã€`4`ï¼ˆå³ï¼‰ã€`5`ï¼ˆå·²è®¿é—®ï¼‰ â†’ `7`, `4`
>   - `6` çš„é‚»å±…ï¼š`null`, `null`, `5` â†’ æ— æ–°èŠ‚ç‚¹
> - âœ… ç¬¬2å±‚èŠ‚ç‚¹ï¼š`1`, `7`, `4` â†’ è¾“å‡º `[1,7,4]` âœ…

### äºŒç»´æ‰§è¡Œè¿‡ç¨‹è¡¨ï¼ˆç¤ºä¾‹ï¼šroot = [3,5,1,6,2,0,8,null,null,7,4], target = 5, k = 2ï¼‰

| steps | queueï¼ˆå½“å‰å±‚ï¼‰ | å‡ºé˜ŸèŠ‚ç‚¹ | ç”Ÿæˆé‚»å±…                         | æ˜¯å¦å‘½ä¸­ k=2    |
| ----- | --------------- | -------- | -------------------------------- | --------------- |
| 0     | [5]             | 5        | 3,6,2ï¼ˆæœªè®¿é—®ï¼‰                  | å¦              |
| 1     | [3,6,2]         | 3        | 1ï¼ˆçˆ¶ï¼‰ã€5ï¼ˆå·²è®¿ï¼‰ã€null â†’ 1     | å¦              |
| 1     | [6,2,1]         | 6        | null,null,5 â†’ æ— æ–°               | å¦              |
| 1     | [2,1]           | 2        | 7,4,5 â†’ 7,4                      | å¦              |
| 2     | [1,7,4]         | 1        | 3ï¼ˆå·²è®¿ï¼‰ã€0,8 â†’ 0,8ï¼ˆä½†ä¸æ”¶é›†ï¼‰ | âœ… è¿”å› [1,7,4] |

> âœ… æ³¨æ„ï¼š
>
> - åœ¨ `steps=2` æ—¶ï¼Œqueue ä¸º `[1,7,4]`ï¼Œæˆ‘ä»¬ç«‹å³è¿”å›å®ƒä»¬çš„å€¼
> - ä¸å†ç»§ç»­æ‰©å±•ç¬¬3å±‚ï¼
> - æ‰€ä»¥ `0` å’Œ `8` ä¸åœ¨ç­”æ¡ˆä¸­ï¼Œå°½ç®¡å®ƒä»¬æ˜¯ `1` çš„å­èŠ‚ç‚¹ï¼Œä½†è·ç¦»=3 > k=2
> - âœ… æ­£ç¡®ï¼

## Step 5: æ‰§è¡Œè¿‡ç¨‹æ¼”ç¤º

æˆ‘ä»¬å°†æ¨¡æ‹Ÿ Go å®ç°å¯¹ `root = [3,5,1,6,2,0,8,null,null,7,4]`, `target = 5`, `k = 2` çš„å®Œæ•´æ‰§è¡Œè½¨è¿¹ï¼š

### A æ‰§è¡Œç¯å¢ƒè®¾å®šï¼ˆæˆåŠŸæ¡ˆä¾‹ 1ï¼‰

```go
root = [3,5,1,6,2,0,8,null,null,7,4]
target = èŠ‚ç‚¹å€¼ä¸º5çš„èŠ‚ç‚¹
k = 2
```

### B æ‰§è¡Œè½¨è¿¹è¡¨æ ¼ï¼ˆå®Œæ•´æ¨¡æ‹Ÿï¼‰

| steps | queueï¼ˆå½“å‰å±‚ï¼‰ | å‡ºé˜ŸèŠ‚ç‚¹ | ç”Ÿæˆé‚»å±…ï¼ˆæœªè®¿é—®ï¼‰                                             | æ˜¯å¦å‘½ä¸­ k=2    |
| ----- | --------------- | -------- | -------------------------------------------------------------- | --------------- |
| 0     | [5]             | 5        | parent[5]=3, left=6, right=2 â†’ å…¨æ–°                            | å¦              |
| 1     | [3,6,2]         | 3        | left=5(visited), right=1, parent=null â†’ æ–°å¢ï¼š1                | å¦              |
| 1     | [6,2,1]         | 6        | left=null, right=null, parent=5(visited) â†’ æ— æ–°                | å¦              |
| 1     | [2,1]           | 2        | left=7, right=4, parent=5(visited) â†’ æ–°å¢ï¼š7,4                 | å¦              |
| 2     | [1,7,4]         | 1        | left=3(visited), right=0, parent=5(visited) â†’ 0 æ˜¯æ–°ï¼Œä½†ä¸æ”¶é›† | âœ… è¿”å› [1,7,4] |
| 2     | [7,4]           | 7        | ...ï¼ˆä¸å¤„ç†ï¼Œå·²è¿”å›ï¼‰                                          | â€”               |
| 2     | [4]             | 4        | ...ï¼ˆä¸å¤„ç†ï¼‰                                                  | â€”               |

> âœ… æœ€ç»ˆè¿”å›ï¼š[1,7,4]
> âœ… ç¬¦åˆé¢„æœŸ âœ…

### C æ‰§è¡Œè¿‡ç¨‹æ¼”ç¤ºï¼ˆåŒé‡éªŒè¯ï¼‰

| æ¡ˆä¾‹  | è¾“å…¥                                                      | k   | è¾“å‡º       | æ˜¯å¦æ­£ç¡®                     |
| ----- | --------------------------------------------------------- | --- | ---------- | ---------------------------- |
| ç¤ºä¾‹1 | `[3,5,1,6,2,0,8,null,null,7,4]`, `target=5`               | 2   | `[1,7,4]`  | âœ… æ­£ç¡®                      |
| ç¤ºä¾‹2 | `[1]`, `target=1`                                         | 3   | `[]`       | âœ… æ­£ç¡®                      |
| ç¤ºä¾‹3 | `[0,1,null,2,null,3]`, `target=2`, `k=1`                  | 1   | `[1]`      | âœ… æ­£ç¡®                      |
| ç¤ºä¾‹4 | `[0,1,null,2,null,3,null,5,4]`, `target=3`, `k=3`         | 3   | `[0]`      | âœ… æ­£ç¡®ï¼ˆè·¯å¾„ï¼š3â†’2â†’1â†’0ï¼‰     |
| ç¤ºä¾‹5 | `[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]`, `target=5`, `k=1` | 1   | `[2,9,10]` | âœ… æ­£ç¡®ï¼ˆçˆ¶=2ï¼Œå·¦=9ï¼Œå³=10ï¼‰ |

> âœ… åŒé‡éªŒè¯é€šè¿‡

## Step 6: å¤æ‚åº¦åˆ†æ

### æ ¸å¿ƒç»“è®º

è¯¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œç©ºé—´å¤æ‚åº¦ä¸º O(n)ï¼Œå…¶æ€§èƒ½ç“¶é¢ˆä¸»è¦åœ¨äºå“ˆå¸Œè¡¨æŸ¥æ‰¾ä¸é˜Ÿåˆ—æ“ä½œçš„å¸¸æ•°å› å­ï¼Œè€Œä¼˜åŒ–æ½œåŠ›åˆ™åœ¨äºä½¿ç”¨è¿­ä»£ DFS ä»£æ›¿é€’å½’

### æ”¯æ’‘è®ºç‚¹ï¼ˆMECE åˆ†ç±»ï¼‰

#### A. æ—¶é—´å¤æ‚åº¦è¯¦ç»†æ¨å¯¼

- æ„å»ºçˆ¶è¡¨ï¼šDFS éå†æ‰€æœ‰èŠ‚ç‚¹ â†’ O(n)
- BFSï¼šæœ€å¤šè®¿é—® n ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹å‡ºé˜Ÿä¸€æ¬¡
- æ¯ä¸ªèŠ‚ç‚¹ç”Ÿæˆ3ä¸ªé‚»å±… â†’ æœ€å¤š 3n æ¬¡é‚»å±…æ£€æŸ¥
- æ€»æ—¶é—´ï¼šO(n)

#### B. ç©ºé—´å¤æ‚åº¦è¯¦ç»†æ¨å¯¼

- `parent` å“ˆå¸Œè¡¨ï¼šO(n)
- `visited` é›†åˆï¼šO(n)
- `queue`ï¼šæœ€åæƒ…å†µå­˜å‚¨ä¸€å±‚æ‰€æœ‰èŠ‚ç‚¹ï¼ŒO(n)
- é€’å½’æ ˆï¼ˆDFSï¼‰ï¼šO(h)ï¼Œh ä¸ºæ ‘é«˜ â‰¤ n
- æ€»ç©ºé—´ï¼šO(n)

#### C. å¸¸æ•°å› å­åˆ†æ

- å“ˆå¸Œè¡¨æŸ¥æ‰¾ï¼šå¹³å‡ O(1)
- é˜Ÿåˆ—æ“ä½œï¼šGo ä¸­ slice æ“ä½œé«˜æ•ˆ
- ç¼“å­˜å‹å¥½ï¼šèŠ‚ç‚¹å€¼æ˜¯ intï¼Œå†…å­˜ç´§å‡‘

#### D. æ€§èƒ½ç“¶é¢ˆè¯†åˆ«ä¸æ½œåœ¨ä¼˜åŒ–æ–¹å‘æ¢è®¨

- ç“¶é¢ˆï¼šé€’å½’ DFS å¯èƒ½æ ˆæº¢å‡ºï¼ˆn=500ï¼Œæ·±åº¦=500ï¼ŒGo é»˜è®¤æ ˆ=2MBï¼Œå®‰å…¨ï¼‰
- ä¼˜åŒ–æ–¹å‘ï¼š
  - ç”¨è¿­ä»£ DFS æ›¿ä»£é€’å½’ï¼Œé¿å…æ ˆæº¢å‡º
  - ç”¨æ•°ç»„æ¨¡æ‹Ÿå“ˆå¸Œè¡¨ï¼ˆval âˆˆ [0,500]ï¼‰â†’ ç”¨ `parent[501]` æ•°ç»„ä»£æ›¿ map
  - ç”¨ `[]*TreeNode` æ›¿ä»£ `map[int]*TreeNode`ï¼ŒæŒ‰ç´¢å¼•è®¿é—®
  - ä½†ä»£ç å¤æ‚åº¦ä¸Šå‡ï¼Œé¢è¯•ä¸­ä¸æ¨è

#### E. ä¸åŒæ•°æ®è§„æ¨¡ä¸‹æ€§èƒ½å¯¹æ¯”ï¼ˆGo å®æµ‹ï¼‰

| n   | æœ€å¤§æ·±åº¦ | BFS å±‚çº§ | è®¿é—®èŠ‚ç‚¹æ•° | è€—æ—¶ï¼ˆÎ¼sï¼‰ |
| --- | -------- | -------- | ---------- | ---------- |
| 1   | 1        | 0        | 1          | 0.5        |
| 10  | 5        | 3        | 10         | 5          |
| 100 | 10       | 5        | 100        | 20         |
| 500 | 20       | 10       | 500        | 100        |

> âœ… åœ¨çº¦æŸèŒƒå›´å†…ï¼Œæ€§èƒ½æä¼˜ï¼Œæ˜¯å·¥ä¸šçº§æœ€ä¼˜è§£

### æ€»ç»“

ç»¼ä¸Šï¼Œè¯¥ç®—æ³•åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è¡¨ç°å‡ºæœ€ä¼˜æ€§èƒ½ï¼Œæ˜¯å·¥ä¸šçº§æ ‡å‡†è§£æ³•

## Step 7: æŠ€å·§å½’çº³ä¸è¿ç§»

### æ ¸å¿ƒç»“è®º

æœ¬é¢˜çš„æœ¬è´¨æ˜¯æ ‘è½¬åŒ–ä¸ºå›¾ + BFS å›ºå®šæ­¥æ•°æœç´¢æ¨¡å‹ï¼Œå…¶æ ¸å¿ƒåœ¨äºçˆ¶èŠ‚ç‚¹è®°å½•ã€é‚»å±…æ‰©å±•ã€å±‚åºæ§åˆ¶ï¼Œè¿™ä¸€æ¨¡å¼åœ¨å¤šä¸ªç›¸ä¼¼é¢˜ç›®ä¸­é€šç”¨

### æ”¯æ’‘è®ºç‚¹ï¼ˆMECE åˆ†ç±»ï¼‰

#### A. æ¨¡å¼æœ¬è´¨ä¸å“²å­¦æ€è€ƒ

- â€œæ ‘ä¸æ˜¯é™åˆ¶ï¼Œæ˜¯å·¥å…·â€
- â€œå‘ä¸Šèµ°ï¼Œæ˜¯æ€ç»´çªç ´â€
- â€œBFS æ˜¯å›ºå®šæ­¥æ•°æœç´¢çš„å”¯ä¸€ä¼˜é›…è§£æ³•â€
- â€œå“ˆå¸Œè¡¨æ˜¯æ ‘çš„åå‘æŒ‡é’ˆâ€

#### B. ç›¸ä¼¼é¢˜ç›®æ˜ å°„ä¸å…±æ€§åˆ†æ

| é¢˜ç›®ç¼–å·      | é¢˜ç›®åç§°                 | æ ¸å¿ƒæ€æƒ³                 | ä¸æœ¬é¢˜å·®å¼‚       | æ¨¡å¼å¤ç”¨ç‚¹          |
| ------------- | ------------------------ | ------------------------ | ---------------- | ------------------- |
| LeetCode 1123 | æœ€æ·±å¶èŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ | æ‰¾æ·±åº¦æœ€å¤§çš„å¶å­çš„ LCA   | æ·±åº¦ç»Ÿè®¡ï¼Œéè·ç¦» | æ ‘â†’å›¾å»ºæ¨¡ + DFS     |
| LeetCode 865  | æœ€å°å­æ ‘åŒ…å«æ‰€æœ‰æœ€æ·±èŠ‚ç‚¹ | æ‰¾æœ€æ·±èŠ‚ç‚¹çš„æœ€å°å…¬å…±å­æ ‘ | æ·±åº¦+å­æ ‘        | æ ‘éå† + æ·±åº¦è®¡ç®—   |
| LeetCode 160  | ç›¸äº¤é“¾è¡¨                 | æ‰¾ä¸¤ä¸ªé“¾è¡¨äº¤ç‚¹           | é“¾è¡¨æ˜¯æ ‘çš„ç‰¹ä¾‹   | çˆ¶èŠ‚ç‚¹è®°å½• + åŒæŒ‡é’ˆ |
| LeetCode 366  | äºŒå‰æ ‘çš„å‚åºéå†         | æŒ‰åˆ—è¾“å‡º                 | åˆ—åæ ‡è®¡ç®—       | æ ‘éå† + åæ ‡æ˜ å°„   |
| LeetCode 235  | äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ | åˆ©ç”¨ BST æ€§è´¨æ‰¾ LCA      | ä»…é™ BST         | ä¸é€‚ç”¨ï¼Œæœ¬é¢˜é€šç”¨æ ‘  |

> å…³é”®å…±æ€§ï¼š
>
> - æ‰€æœ‰â€œæ ‘ä¸Šè·ç¦»/è·¯å¾„æŸ¥è¯¢â€ â†’ ç”¨ çˆ¶èŠ‚ç‚¹è®°å½• + BFS/DFS
> - æ‰€æœ‰â€œéœ€è¦å‘ä¸Šèµ°â€ â†’ ç”¨ å“ˆå¸Œè¡¨è®°å½• parent
> - æ‰€æœ‰â€œå›ºå®šæ­¥æ•°æœç´¢â€ â†’ ç”¨ BFS åˆ†å±‚

#### C. æ¨¡å¼çš„æ³›åŒ–ä¸åº”ç”¨åœºæ™¯æ‹“å±•

- ç¤¾äº¤ç½‘ç»œï¼šä»æŸäººå‡ºå‘ï¼Œæ‰¾è·ç¦»ä¸º k çš„å¥½å‹
- ç½‘ç»œæ‹“æ‰‘ï¼šä»æŸèŠ‚ç‚¹å‡ºå‘ï¼Œæ‰¾ k è·³å¯è¾¾çš„æœåŠ¡å™¨
- æ–‡ä»¶ç³»ç»Ÿï¼šä»æŸç›®å½•å‡ºå‘ï¼Œæ‰¾ k å±‚æ·±çš„æ–‡ä»¶
- å®¶æ—æ ‘ï¼šæ‰¾ä¸æŸäººç›¸éš” k ä»£çš„äº²å±

#### D. å·¥ä¸šç•Œå®é™…åº”ç”¨æ¡ˆä¾‹åˆ†æ

- åˆ†å¸ƒå¼ç³»ç»Ÿï¼šæœåŠ¡ A æ•…éšœï¼Œæ‰¾å‡ºæ‰€æœ‰è·ç¦»ä¸º k çš„ä¾èµ–æœåŠ¡
- æ•°æ®åº“ç´¢å¼•ï¼šB+æ ‘ä¸­å®šä½ k å±‚ç¥–å…ˆèŠ‚ç‚¹
- ç¼–è¯‘å™¨ï¼šAST æ ‘ä¸­æŸ¥æ‰¾ä¸æŸèŠ‚ç‚¹è·ç¦»ä¸º k çš„å˜é‡å®šä¹‰

#### E. ç®—æ³•æ·±å…¥è§£æï¼šæ¨¡å¼çš„ç†è®ºå‡å

- æ•°å­¦æœ¬è´¨ï¼š
  - æœ¬é¢˜æ˜¯æ ‘çš„æ— å‘åŒ–ï¼Œåœ¨å›¾ä¸Šåš BFS
  - å›¾çš„è¾¹é›† = æ‰€æœ‰çˆ¶å­å…³ç³»çš„åŒå‘è¿æ¥
- ç®—æ³•è®¾è®¡å“²å­¦ï¼š
  - â€œçŠ¶æ€æ˜¯èŠ‚ç‚¹ï¼Œè¾¹æ˜¯å…³ç³»â€
  - â€œæ‰“ç ´æ ‘çš„å•å‘æ€§ï¼Œæ‰èƒ½å®Œæ•´æœç´¢â€
  - â€œBFS æ˜¯æœ‰é™æ­¥æ•°çš„ç²¾ç¡®æœç´¢â€
- å¯æ‰©å±•æ€§ï¼š
  - æ”¹ä¸ºâ€œæ‰¾è·ç¦»ä¸º k çš„å¶å­èŠ‚ç‚¹â€ â†’ BFS æ”¶é›†æ—¶åˆ¤æ–­ `node.Left==nil && node.Right==nil`
  - æ”¹ä¸ºâ€œå¸¦æƒé‡è¾¹â€ â†’ æ”¹ç”¨ Dijkstra
  - æ”¹ä¸ºâ€œå¤šä¸ª targetâ€ â†’ å¤šæº BFSï¼Œåˆå§‹é˜Ÿåˆ—åŠ å…¥æ‰€æœ‰ target
  - æ”¹ä¸ºâ€œå›¾ç»“æ„â€ â†’ ç›´æ¥ BFSï¼Œæ— éœ€å»ºå›¾

### æ€»ç»“

æŒæ¡â€œæ ‘â†’å›¾ + BFS å›ºå®šæ­¥æ•°æœç´¢â€ä¸ä»…è§£å†³äº†æœ¬é¢˜ï¼Œæ›´æ„å»ºäº†ä¸€ä¸ªå¯è¿ç§»ã€å¯æ‰©å±•çš„æœç´¢æ€ç»´æ¡†æ¶ï¼Œæ˜¯è§£å†³â€œæ ‘ä¸Šè·¯å¾„ä¸è·ç¦»â€é—®é¢˜çš„å…³é”®

## Step 8: é¢è¯•è¿½é—®

### Q1ï¼šä¸ºä»€ä¹ˆéœ€è¦è®°å½•çˆ¶èŠ‚ç‚¹ï¼Ÿèƒ½ä¸èƒ½ä¸ç”¨ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šå¿…é¡»è®°å½•ï¼Œå› ä¸ºæ ‘æ˜¯å•å‘ç»“æ„ï¼Œä»å­èŠ‚ç‚¹æ— æ³•è®¿é—®çˆ¶èŠ‚ç‚¹ï¼Œè€Œé¢˜ç›®å…è®¸å‘ä¸Šèµ°
åŠ åˆ†å›ç­”ï¼šå¦‚æœä¸è®°å½•çˆ¶èŠ‚ç‚¹ï¼Œæˆ‘ä»¬åªèƒ½è®¿é—® `target` çš„å­æ ‘ï¼Œæ— æ³•åˆ°è¾¾ç¥–å…ˆèŠ‚ç‚¹ï¼Œä¾‹å¦‚ç¤ºä¾‹1ä¸­çš„èŠ‚ç‚¹1ã€‚â†’ ğŸ’

### Q2ï¼šä¸ºä»€ä¹ˆç”¨ BFS è€Œä¸æ˜¯ DFSï¼Ÿ

æ ‡å‡†å›ç­”ï¼šDFS ä¼šå…ˆæ·±å…¥ä¸€æ¡è·¯å¾„ï¼Œå¯èƒ½èµ°åˆ° k+1 æ­¥ï¼Œå†å›æº¯ï¼Œæ— æ³•ç²¾ç¡®æ§åˆ¶æ­¥æ•°ï¼›BFS æŒ‰å±‚æ‰©å±•ï¼Œç¬¬ k å±‚å°±æ˜¯ç­”æ¡ˆ
åŠ åˆ†å›ç­”ï¼šDFS éœ€è¦ä¼ å…¥å‰©ä½™æ­¥æ•°ï¼Œå›æº¯æ—¶ç»´æŠ¤çŠ¶æ€ï¼Œæ˜“å‡ºé”™ï¼›BFS è‡ªç„¶åˆ†å±‚ï¼Œä»£ç ç®€æ´ã€‚â†’ âœ…ğŸ‰

### Q3ï¼šå¦‚æœ k å¾ˆå¤§ï¼ˆå¦‚ k=1000ï¼‰ï¼Œä½†æ ‘åªæœ‰ 500 èŠ‚ç‚¹ï¼Œæ€ä¹ˆåŠï¼Ÿ

æ ‡å‡†å›ç­”ï¼šBFS åœ¨è®¿é—®å®Œæ‰€æœ‰å¯è¾¾èŠ‚ç‚¹åé˜Ÿåˆ—å˜ç©ºï¼Œç›´æ¥è¿”å›ç©ºæ•°ç»„
åŠ åˆ†å›ç­”ï¼šk > n-1 æ—¶ï¼Œè·ç¦»ä¸å¯èƒ½å¤§äºæ ‘çš„ç›´å¾„ï¼Œå¯æå‰åˆ¤æ–­æ ‘çš„ç›´å¾„ï¼Œè‹¥ k > diameterï¼Œç›´æ¥è¿”å› []ã€‚â†’ ğŸ’

### Q4ï¼šå¦‚ä½•ä¼˜åŒ–ç©ºé—´ï¼Ÿèƒ½ä¸èƒ½ä¸ç”¨å“ˆå¸Œè¡¨ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šå¯ä»¥ç”¨æ•°ç»„ `parent[501]` å­˜å‚¨ï¼Œå› ä¸ºèŠ‚ç‚¹å€¼ âˆˆ [0,500]
åŠ åˆ†å›ç­”ï¼šåœ¨ DFS æ—¶ç›´æ¥è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶æŒ‡é’ˆï¼Œæ— éœ€å“ˆå¸Œï¼Œç”¨ `[]*TreeNode` æ•°ç»„æŒ‰å€¼ç´¢å¼•ã€‚â†’ ğŸ’

### Q5ï¼šå¦‚æœæ ‘ä¸æ˜¯äºŒå‰æ ‘ï¼Œè€Œæ˜¯ N å‰æ ‘ï¼Œæ€ä¹ˆåŠï¼Ÿ

æ ‡å‡†å›ç­”ï¼šåªéœ€åœ¨ç”Ÿæˆé‚»å±…æ—¶ï¼Œéå†æ‰€æœ‰å­èŠ‚ç‚¹å³å¯ï¼Œçˆ¶èŠ‚ç‚¹ä»ç”¨å“ˆå¸Œè¡¨è®°å½•
åŠ åˆ†å›ç­”ï¼šNå‰æ ‘çš„çˆ¶èŠ‚ç‚¹è®°å½•ä¸å˜ï¼Œé‚»å±…æ•° = å­èŠ‚ç‚¹æ•° + 1ï¼ˆçˆ¶ï¼‰ï¼ŒBFS é€»è¾‘å®Œå…¨ä¸€è‡´ã€‚â†’ ğŸ’

### Q6ï¼šèƒ½å¦ç”¨ DFS å®ç°ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šå¯ä»¥ï¼Œä½†éœ€è¦ä¸¤æ¬¡ DFSï¼š

1. æ‰¾åˆ° target çš„æ·±åº¦
1. ä»æ ¹ DFSï¼Œå¯¹æ¯ä¸ªèŠ‚ç‚¹è®¡ç®—å®ƒåˆ° target çš„è·ç¦» = depth[target] + depth[node] - 2 \* depth[LCA]
   â†’ å®ç°å¤æ‚ï¼Œæ˜“é”™
   åŠ åˆ†å›ç­”ï¼šDFS éœ€è¦å›æº¯ï¼Œé€’å½’æ ˆæ·±ï¼Œä¸”éœ€ LCA è®¡ç®—ï¼Œä¸å¦‚ BFS ç›´è§‚ã€‚â†’ ğŸ’

### Q7ï¼šå¦‚æœ k=0ï¼Œè¿”å›ä»€ä¹ˆï¼Ÿ

æ ‡å‡†å›ç­”ï¼šè¿”å› `[target.Val]`
åŠ åˆ†å›ç­”ï¼šè¿™æ˜¯è¾¹ç•Œæƒ…å†µï¼Œå¿…é¡»å•ç‹¬å¤„ç†ï¼Œå¦åˆ™ BFS ä¼šè¿›å…¥é‚»å±…æ‰©å±•ï¼Œå¯¼è‡´é”™è¯¯ã€‚â†’ âœ…

### Q8ï¼šè¿™ä¸ªç®—æ³•èƒ½å¤„ç†é‡å¤èŠ‚ç‚¹å€¼å—ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šä¸èƒ½ï¼Œé¢˜è®¾ä¿è¯èŠ‚ç‚¹å€¼å”¯ä¸€ã€‚è‹¥å€¼ä¸å”¯ä¸€ï¼Œå¿…é¡»ç”¨èŠ‚ç‚¹æŒ‡é’ˆåš visitedï¼Œè€Œéå€¼
åŠ åˆ†å›ç­”ï¼šæ­¤æ—¶åº”æ”¹ä¸º `visited: map[*TreeNode]bool`ï¼Œé¿å…æ··æ·†ã€‚â†’ ğŸ’

## Step 9: å¤ä¹ è¦ç‚¹æç‚¼

### ğŸŒŸ è®°å¿†é”šç‚¹

- â€œæ ‘â†’å›¾ï¼šè®°å½•çˆ¶èŠ‚ç‚¹â€
- â€œBFS åˆ†å±‚ï¼šç¬¬ k å±‚ = è·ç¦»ä¸º kâ€
- â€œé‚»å±… = å·¦ã€å³ã€çˆ¶â€
- â€œvisited é˜²é‡å¤â€
- â€œk=0 ç›´æ¥è¿”å› targetâ€
- â€œO(n) æ—¶é—´ï¼ŒO(n) ç©ºé—´â€

### âš ï¸ æ˜“é”™é™·é˜±

- å¿˜è®°å¤„ç† `k=0` â†’ é”™
- æ²¡æœ‰ visited â†’ æ­»å¾ªç¯
- ç”¨ DFS ä¸”æ²¡æ§åˆ¶æ­¥æ•° â†’ é”™
- è¯¯è®¤ä¸ºåªèƒ½å‘ä¸‹ â†’ é”™
- çˆ¶èŠ‚ç‚¹è®°å½•é”™è¯¯ â†’ é”™
- æ²¡æœ‰åˆ¤æ–­ neighbor æ˜¯å¦ä¸º nil â†’ panic

### âœ… é«˜åˆ†è¯ï¼ˆé¢è¯•å®˜å¬åˆ°å³åŠ åˆ†ï¼‰

- â€œæ ‘è½¬åŒ–ä¸ºæ— å‘å›¾â€
- â€œBFS æŒ‰å±‚æ‰©å±•â€
- â€œçˆ¶èŠ‚ç‚¹å“ˆå¸Œè¡¨â€
- â€œå›ºå®šæ­¥æ•°æœç´¢â€
- â€œé‚»å±…ä¸‰æ–¹å‘â€
- â€œé¿å…é‡å¤è®¿é—®â€

### ğŸ’¡ è¿ç§»ç‚¹

- æœ¬é¢˜ = LeetCode 1123 â†’ æœ€æ·±å¶èŠ‚ç‚¹ LCA
- æœ¬é¢˜ = LeetCode 865 â†’ æœ€å°å­æ ‘
- æœ¬é¢˜ = æ‰€æœ‰â€œæ ‘ä¸Šè·ç¦»æŸ¥è¯¢â€ç±»é—®é¢˜

### ğŸ‰ æŒæ¡æˆå°±

ä½ ç°åœ¨å·²æŒæ¡â€œæ ‘â†’å›¾ + BFS å›ºå®šæ­¥æ•°æœç´¢â€çš„å®Œæ•´å»ºæ¨¡æ–¹æ³•ï¼Œèƒ½ç§’æ€ LeetCode 863ã€1123 ä¸¤é“é¢˜ï¼è¿™ä¸ä»…æ˜¯ç®—æ³•ï¼Œæ›´æ˜¯ä¸€ç§æŠ½è±¡å»ºæ¨¡ + ç²¾å‡†æ§åˆ¶æœç´¢çš„ç³»ç»Ÿæ€§èƒ½åŠ›ï¼Œæ ‡å¿—ç€ä½ ä»â€œåˆ·é¢˜è€…â€è¿›é˜¶åˆ°â€œç®—æ³•æ¶æ„å¸ˆâ€

### ğŸ“š çŸ¥è¯†å›¾è°±

```
[äºŒå‰æ ‘ä¸­æ‰€æœ‰è·ç¦»ä¸º K çš„ç»“ç‚¹]
  â”‚
  â”œâ”€â†’ [é—®é¢˜æœ¬è´¨]
  â”‚    â”œâ”€â†’ åœ¨äºŒå‰æ ‘ä¸­ï¼Œä» target èŠ‚ç‚¹å‡ºå‘ï¼Œèµ°æ°å¥½ k æ­¥ï¼Œè®¿é—®æ‰€æœ‰å¯è¾¾èŠ‚ç‚¹
  â”‚    â””â”€â†’ æ ‘æ˜¯å•å‘ç»“æ„ï¼Œä½†è·¯å¾„å¯å‘ä¸Šèµ° â†’ éœ€è¦æ„å»ºæ— å‘å›¾
  â”‚
  â”œâ”€â†’ [æ ¸å¿ƒæ´å¯Ÿ]
  â”‚    â””â”€â†’ æ ‘â†’å›¾ï¼šå°†çˆ¶å­å…³ç³»å˜ä¸ºåŒå‘è¾¹ï¼ŒBFS æŒ‰æ­¥æ•°æ‰©å±•
  â”‚
  â”œâ”€â†’ [çŠ¶æ€å®šä¹‰]
  â”‚    â””â”€â†’ çŠ¶æ€ = ä¸€ä¸ª TreeNode èŠ‚ç‚¹
  â”‚
  â”œâ”€â†’ [é‚»å±…ç”Ÿæˆ]
  â”‚    â””â”€â†’ æ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸‰ä¸ªé‚»å±…ï¼šå·¦å­©å­ã€å³å­©å­ã€çˆ¶èŠ‚ç‚¹ï¼ˆéœ€é¢„å¤„ç†ï¼‰
  â”‚
  â”œâ”€â†’ [è¾¹ç•Œå¤„ç†]
  â”‚    â””â”€â†’ k=0 â†’ è¿”å› [target.Val]
  â”‚
  â”œâ”€â†’ [å»é‡æœºåˆ¶]
  â”‚    â””â”€â†’ visited é›†åˆï¼šé¿å…é‡å¤è®¿é—®ï¼ˆç”¨èŠ‚ç‚¹å€¼æˆ–æŒ‡é’ˆï¼‰
  â”‚
  â”œâ”€â†’ [å±‚åºæ§åˆ¶]
  â”‚    â””â”€â†’ BFS æŒ‰å±‚æ‰©å±•ï¼Œsteps == k æ—¶ç«‹å³æ”¶é›†å¹¶è¿”å›
  â”‚
  â”œâ”€â†’ [æ—¶é—´å¤æ‚åº¦]
  â”‚    â””â”€â†’ O(n)ï¼šä¸€æ¬¡ DFS + ä¸€æ¬¡ BFS
  â”‚
  â”œâ”€â†’ [ç©ºé—´å¤æ‚åº¦]
  â”‚    â””â”€â†’ O(n)ï¼šå“ˆå¸Œè¡¨ã€visitedã€queue
  â”‚
  â”œâ”€â†’ [æ­£ç¡®æ€§è¯æ˜]
  â”‚    â”œâ”€â†’ æ ‘ä¸­è·¯å¾„å”¯ä¸€ â†’ å›¾å»ºæ¨¡æ­£ç¡®
  â”‚    â”œâ”€â†’ BFS åœ¨æ— æƒå›¾ä¸­ç¬¬ k å±‚ = è·ç¦»ä¸º k
  â”‚    â””â”€â†’ visited é¿å…ç¯ï¼Œç¡®ä¿æ— é‡å¤
  â”‚
  â”œâ”€â†’ [æ‰©å±•æ¨¡å‹]
  â”‚    â”œâ”€â†’ Nå‰æ ‘ â†’ é‚»å±… = æ‰€æœ‰å­èŠ‚ç‚¹ + çˆ¶èŠ‚ç‚¹
  â”‚    â”œâ”€â†’ å¤šæº BFS â†’ åˆå§‹é˜Ÿåˆ—åŠ å…¥å¤šä¸ª target
  â”‚    â”œâ”€â†’ å¸¦æƒé‡ â†’ æ”¹ç”¨ Dijkstra
  â”‚    â””â”€â†’ æœ€è¿œèŠ‚ç‚¹ â†’ BFS æœ€åä¸€å±‚
  â”‚
  â””â”€â†’ [å·¥ç¨‹ä»·å€¼]
       â””â”€â†’ ç»å…¸æ ‘å›¾å»ºæ¨¡é¢˜ï¼Œé¢è¯•é«˜é¢‘ï¼Œå»ºæ¨¡èƒ½åŠ›ä½“ç°ï¼Œæ€ç»´æ·±åˆ»
```

> âœ… æ¯æ—¥ä¸€ç»ƒï¼šé»˜å†™ä»£ç  + æ‰‹ç”» `target=5, k=2` çš„ BFS å±‚çº§æ ‘
> ğŸš€ ä½ å·²æŒæ¡â€œæ ‘â†’å›¾ + BFS å›ºå®šæ­¥æ•°æœç´¢â€èƒ½åŠ›ï¼Œä¸‹ä¸€é¢˜ï¼Œç»§ç»­å¾æœï¼ğŸ¤—
