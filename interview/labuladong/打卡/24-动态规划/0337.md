# LeetCode 337 - æ‰“å®¶åŠ«èˆ III

## Step 1ï¼šé¢˜ç›®æè¿°

å°å·åˆå‘ç°äº†ä¸€ä¸ªæ–°çš„å¯è¡Œçªƒçš„åœ°åŒºã€‚è¿™ä¸ªåœ°åŒºåªæœ‰ä¸€ä¸ªå…¥å£ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œæ ¹â€ã€‚é™¤äº†â€œæ ¹â€ä¹‹å¤–ï¼Œæ¯æ ‹æˆ¿å­æœ‰ä¸”åªæœ‰ä¸€ä¸ªâ€œçˆ¶â€æˆ¿å­ä¸ä¹‹ç›¸è¿ã€‚ä¸€ç•ªä¾¦å¯Ÿä¹‹åï¼Œèªæ˜çš„å°å·æ„è¯†åˆ°â€œè¿™ä¸ªåœ°æ–¹çš„æ‰€æœ‰æˆ¿å±‹çš„æ’åˆ—ç±»ä¼¼äºä¸€æ£µäºŒå‰æ ‘â€ã€‚å¦‚æœä¸¤ä¸ªç›´æ¥ç›¸è¿çš„æˆ¿å­åœ¨åŒä¸€å¤©æ™šä¸Šè¢«æ‰“åŠ«ï¼Œæˆ¿å±‹å°†è‡ªåŠ¨æŠ¥è­¦

ç»™å®šä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ `root`ï¼Œè®¡ç®—åœ¨ä¸è§¦åŠ¨è­¦æŠ¥çš„æƒ…å†µä¸‹ï¼Œå°å·èƒ½å¤Ÿç›—å–çš„æœ€é«˜é‡‘é¢

ç¤ºä¾‹ 1ï¼š
è¾“å…¥ï¼š`root = [3,2,3,null,3,null,1]`
è¾“å‡ºï¼š`7`
è§£é‡Šï¼š

```
    3
   / \
  2   3
   \   \
    3   1
```

- å°å·å¯ä»¥å·çªƒï¼š3ï¼ˆæ ¹ï¼‰ + 3ï¼ˆå³å­æ ‘çš„å·¦å­©å­ï¼‰ + 1ï¼ˆå³å­æ ‘çš„å³å­©å­ï¼‰ = 7
- ä¸èƒ½å· 2 å’Œ 3ï¼ˆå› ä¸º 2 æ˜¯ 3 çš„å­èŠ‚ç‚¹ï¼Œä¸èƒ½ä¸çˆ¶åŒæ—¶å·ï¼‰

ç¤ºä¾‹ 2ï¼š
è¾“å…¥ï¼š`root = [3,4,5,1,3,null,1]`
è¾“å‡ºï¼š`9`
è§£é‡Šï¼š

```
    3
   / \
  4   5
 / \   \
1   3   1
```

- å°å·å¯ä»¥å·çªƒï¼š4ï¼ˆå·¦å­æ ‘å·¦ï¼‰ + 5ï¼ˆå³å­æ ‘ï¼‰ = 9
- ä¸èƒ½å· 3ï¼ˆæ ¹ï¼‰å’Œ 4 æˆ– 5ï¼ˆå› ä¸ºæ˜¯çˆ¶å­å…³ç³»ï¼‰

ç¤ºä¾‹ 3ï¼š
è¾“å…¥ï¼š`root = [1]`
è¾“å‡ºï¼š`1`
è§£é‡Šï¼šåªæœ‰ä¸€é—´æˆ¿ï¼Œç›´æ¥å·

ç¤ºä¾‹ 4ï¼š
è¾“å…¥ï¼š`root = [4,1,null,2,null,3]`
è¾“å‡ºï¼š`7`
è§£é‡Šï¼š

```
    4
   /
  1
 /
2
/
3
```

- å· 4 å’Œ 3 â†’ 4+3=7ï¼ˆè·³è¿‡ 1 å’Œ 2ï¼‰

çº¦æŸæ¡ä»¶ï¼š

- æ ‘ä¸­èŠ‚ç‚¹æ•°åœ¨ `[1, 10â´]` èŒƒå›´å†…
- `0 <= Node.val <= 10â´`
- ç›®æ ‡ï¼šåœ¨æ ‘å½¢ç»“æ„ã€çˆ¶å­ä¸èƒ½åŒæ—¶å·çªƒçš„å‰æä¸‹ï¼Œæ±‚æœ€å¤§å·çªƒé‡‘é¢
- è¿é€šæ€§ï¼šæœ¬é¢˜æ˜¯ LeetCode 198ï¼ˆæ‰“å®¶åŠ«èˆ Iï¼‰ã€LeetCode 213ï¼ˆæ‰“å®¶åŠ«èˆ IIï¼‰çš„æ ‘å½¢è¿›é˜¶æ¨¡å‹ï¼Œæ˜¯æ ‘å½¢åŠ¨æ€è§„åˆ’çš„ç»å…¸ä»£è¡¨

æ ¸å¿ƒæ„å›¾ï¼š
æœ¬é¢˜è€ƒæŸ¥é€’å½’å»ºæ¨¡ã€çŠ¶æ€å®šä¹‰ã€ååºéå†ã€è®°å¿†åŒ–ä¼˜åŒ–ã€æ ‘å½¢ DPï¼Œæ˜¯â€œæ ‘ä¸Šæœ€å¤§ç‹¬ç«‹é›†â€é—®é¢˜çš„æ ‡å‡†æ¨¡æ¿

> æœ¬è´¨æ˜¯ï¼š
>
> - æ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸¤ç§çŠ¶æ€ï¼šå· æˆ– ä¸å·
> - è‹¥å·å½“å‰èŠ‚ç‚¹ï¼Œåˆ™ä¸èƒ½å·å…¶å·¦å³å­èŠ‚ç‚¹
> - è‹¥ä¸å·å½“å‰èŠ‚ç‚¹ï¼Œåˆ™å·¦å³å­èŠ‚ç‚¹å¯å·å¯ä¸å·ï¼ˆå–æœ€ä¼˜ï¼‰
> - é—®é¢˜è½¬åŒ–ä¸ºï¼šå¯¹æ ‘è¿›è¡Œååºéå†ï¼Œè‡ªåº•å‘ä¸Šè®¡ç®—æ¯ä¸ªèŠ‚ç‚¹åœ¨â€œå·â€ä¸â€œä¸å·â€ä¸¤ç§çŠ¶æ€ä¸‹çš„æœ€å¤§æ”¶ç›Š
> - é¢è¯•ä¸­é«˜åˆ†ç­”æ¡ˆéœ€æ˜ç¡®ï¼š
>   - ä¸ºä»€ä¹ˆæ˜¯æ ‘å½¢ DPï¼Ÿ
>   - ä¸ºä»€ä¹ˆå¿…é¡»ååºéå†ï¼Ÿ
>   - ä¸ºä»€ä¹ˆçŠ¶æ€æ˜¯ä¸¤ä¸ªå€¼ï¼Ÿ
>   - å¦‚ä½•é¿å…é‡å¤è®¡ç®—ï¼Ÿ
>   - å¦‚æœæ˜¯ç¯å½¢æ ‘å‘¢ï¼Ÿ
>   - å¦‚æœå…è®¸è·³è¿‡ä¸¤ä»£å‘¢ï¼Ÿ
>   - å¦‚ä½•ç”¨è¿­ä»£å®ç°ï¼Ÿ

## Step 2: æ ¸å¿ƒç»“è®ºï¼ˆé‡‘å­—å¡”ç»“æ„ä¼˜åŒ–ç‰ˆï¼‰

### æ ¸å¿ƒç»“è®º

æœ¬é¢˜çš„æœ€ä¼˜è§£æ˜¯æ ‘å½¢åŠ¨æ€è§„åˆ’ï¼ˆååºéå† + çŠ¶æ€è®°å½•ï¼‰ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼šæ—¶é—´å¤æ‚åº¦ O(n)ã€ç©ºé—´å¤æ‚åº¦ O(h)ã€é€»è¾‘ä¸¥å¯†ã€æ˜¯æ ‘å½¢ DP çš„æ ‡å‡†æ¨¡æ¿ã€é¢è¯•é«˜é¢‘é¢˜

### æ”¯æ’‘è®ºç‚¹ï¼ˆMECE åˆ†ç±»ï¼‰

#### A. ç†è®ºæœ€ä¼˜æ€§ï¼šæ ‘å½¢ DP æ˜¯å”¯ä¸€å¯é è§£æ³•

- æœ¬é¢˜è¦æ±‚ï¼šæœ€å¤§åŒ–æ ‘ä¸­ä¸ç›¸é‚»èŠ‚ç‚¹çš„æ€»é‡‘é¢
- æš´åŠ›æšä¸¾ï¼šæšä¸¾æ‰€æœ‰å­é›† â†’ 2â¿ ç§ï¼Œn=10â´ â†’ 10Â³â°â°â°ï¼Œä¸å¯è¡Œ
- è´ªå¿ƒç­–ç•¥ï¼šé€‰æœ€å¤§å€¼ï¼Œè·³è¿‡å­èŠ‚ç‚¹ â†’ é”™è¯¯ï¼
  - åä¾‹ï¼š`[4,1,null,2,null,3]`ï¼ˆé“¾çŠ¶æ ‘ï¼‰
    - è´ªå¿ƒï¼šé€‰ 4 â†’ è·³è¿‡ 1 â†’ é€‰ 2 â†’ è·³è¿‡ 3 â†’ æ€»å’Œ 6
    - å®é™…æœ€ä¼˜ï¼šé€‰ 4 å’Œ 3 â†’ 4+3=7 âœ…
  - è´ªå¿ƒæ— æ³•é¢„è§â€œéš”ä»£æ”¶ç›Šâ€
- åŠ¨æ€è§„åˆ’ + æ ‘å½¢é€’å½’ï¼š
  - å…³é”®æ´å¯Ÿï¼šå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œæœ‰ä¸¤ç§å†³ç­–ï¼š
    1. å·å½“å‰èŠ‚ç‚¹ â†’ åˆ™ä¸èƒ½å·å…¶å·¦å³å­èŠ‚ç‚¹ â†’ æ”¶ç›Š = `node.val + å·¦å­æ ‘ä¸å·çš„æ”¶ç›Š + å³å­æ ‘ä¸å·çš„æ”¶ç›Š`
    1. ä¸å·å½“å‰èŠ‚ç‚¹ â†’ åˆ™å·¦å³å­èŠ‚ç‚¹å¯å·å¯ä¸å· â†’ æ”¶ç›Š = `max(å·¦å­æ ‘å·, å·¦å­æ ‘ä¸å·) + max(å³å­æ ‘å·, å³å­æ ‘ä¸å·)`
  - å®šä¹‰çŠ¶æ€ï¼š
    - `dp[node][0]` = ä¸å· node æ—¶ï¼Œä»¥ node ä¸ºæ ¹çš„å­æ ‘èƒ½è·å¾—çš„æœ€å¤§é‡‘é¢
    - `dp[node][1]` = å· node æ—¶ï¼Œä»¥ node ä¸ºæ ¹çš„å­æ ‘èƒ½è·å¾—çš„æœ€å¤§é‡‘é¢
  - çŠ¶æ€è½¬ç§»ï¼š
    - `dp[node][0] = max(dp[left][0], dp[left][1]) + max(dp[right][0], dp[right][1])`
    - `dp[node][1] = node.val + dp[left][0] + dp[right][0]`
  - é€’å½’åŸºï¼šç©ºèŠ‚ç‚¹ â†’ `dp[null][0] = 0, dp[null][1] = 0`
  - éå†é¡ºåºï¼šååºéå†ï¼ˆå…ˆå¤„ç†å­èŠ‚ç‚¹ï¼Œå†å¤„ç†çˆ¶èŠ‚ç‚¹ï¼‰
  - æœ€ç»ˆç­”æ¡ˆï¼š`max(dp[root][0], dp[root][1])`
- ä¼˜åŠ¿ï¼š
  - å®Œå¤‡æ€§ï¼šè€ƒè™‘æ‰€æœ‰åˆæ³•ç»„åˆï¼Œä¿è¯æœ€ä¼˜
  - é«˜æ•ˆæ€§ï¼šæ¯ä¸ªèŠ‚ç‚¹ä»…è®¿é—®ä¸€æ¬¡ â†’ O(n)
  - å¯è¯æ€§ï¼šæ•°å­¦å½’çº³æ³•å¯è¯çŠ¶æ€è½¬ç§»çš„æ­£ç¡®æ€§
  - å¯æ‰©å±•æ€§ï¼šå¯è¿ç§»è‡³â€œå¤šå±‚è·³è¿‡â€ã€â€œå¸¦æƒé‡â€ã€â€œç¯å½¢æ ‘â€ç­‰å˜ä½“

> âœ… å…³é”®æ´å¯Ÿï¼š
>
> - è¿™ä¸æ˜¯â€œé€‰ä¸é€‰â€çš„ç®€å•å†³ç­–ï¼Œè€Œæ˜¯â€œæ¯ä¸ªèŠ‚ç‚¹å¿…é¡»è®°å½•ä¸¤ç§çŠ¶æ€â€
> - ä¸ºä»€ä¹ˆå¿…é¡»ååºï¼Ÿ
>   - å› ä¸ºçˆ¶èŠ‚ç‚¹çš„å†³ç­–ä¾èµ–å­èŠ‚ç‚¹çš„å®Œæ•´çŠ¶æ€ï¼ˆå·/ä¸å·ï¼‰
>   - è‹¥å…ˆè®¿é—®çˆ¶èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹çŠ¶æ€æœªçŸ¥ â†’ æ— æ³•è®¡ç®—
> - é¢è¯•å®˜é—®æœ¬é¢˜ï¼Œä¸æ˜¯è€ƒä½ èƒ½ä¸èƒ½å†™é€’å½’ï¼Œè€Œæ˜¯è€ƒä½ æ˜¯å¦ç†è§£â€œæ ‘å½¢çŠ¶æ€ä¾èµ–â€ä¸â€œè‡ªåº•å‘ä¸Šâ€å»ºæ¨¡

#### B. å¯¹æ¯”åŠ£åŠ¿æ€§ï¼šå…¶ä»–ä¸»æµæ–¹æ³•å‡å­˜åœ¨ç»“æ„æ€§ç¼ºé™·

| æ–¹æ³•                   | é—®é¢˜                             | ä¸ºä½•æ¬¡ä¼˜                       |
| ---------------------- | -------------------------------- | ------------------------------ |
| æš´åŠ›é€’å½’               | O(2â¿)ï¼ŒæŒ‡æ•°çˆ†ç‚¸                  | n=10 æ—¶å·²è¶…æ—¶ï¼Œå®Œå…¨ä¸å¯è¡Œ      |
| è´ªå¿ƒç®—æ³•               | å±€éƒ¨æœ€ä¼˜ â‰  å…¨å±€æœ€ä¼˜ï¼Œå­˜åœ¨åä¾‹    | æ— æ³•å¤„ç†â€œéš”ä»£æ”¶ç›Šâ€ï¼Œé¢è¯•ç›´æ¥æŒ‚ |
| DFS + è®°å¿†åŒ–ï¼ˆå•çŠ¶æ€ï¼‰ | æ— æ³•åŒºåˆ†â€œå·/ä¸å·â€çŠ¶æ€            | çŠ¶æ€å®šä¹‰é”™è¯¯ï¼Œæ— æ³•æ­£ç¡®è½¬ç§»     |
| BFS                    | çŠ¶æ€ç©ºé—´ä¸ºæ‰€æœ‰å­é›†ï¼ŒO(2â¿)        | ç©ºé—´çˆ†ç‚¸ï¼Œæ•ˆç‡ä½               |
| å‰åºéå†               | çˆ¶èŠ‚ç‚¹å…ˆäºå­èŠ‚ç‚¹è®¡ç®—ï¼ŒçŠ¶æ€æœªå°±ç»ª | æ— æ³•è®¡ç®—å­èŠ‚ç‚¹æœ€ä¼˜å€¼           |

> âœ… å…³é”®æ´å¯Ÿï¼š
>
> - é¢è¯•å®˜é—®æœ¬é¢˜ï¼Œæ ¸å¿ƒè€ƒå¯Ÿç‚¹æ˜¯ï¼šä½ èƒ½å¦è¯†åˆ«è¿™æ˜¯ä¸€ä¸ªâ€œæ ‘å½¢ç»“æ„ + çŠ¶æ€ä¾èµ–â€é—®é¢˜ï¼Œå¿…é¡»ç”¨ååºéå† + åŒçŠ¶æ€ DP
> - æ ‘å½¢ DP æ˜¯å”¯ä¸€èƒ½ä¿è¯å…¨å±€æœ€ä¼˜ã€ä¸”é«˜æ•ˆæ±‚è§£çš„æ–¹æ³•
> - åœ¨ LeetCode å®˜æ–¹é¢˜è§£ä¸­ï¼Œæœ¬é¢˜è¢«å½’ç±»ä¸º â€œDynamic Programmingâ€ â†’ â€œTree DPâ€

#### C. é€‚ç”¨è¾¹ç•Œï¼šæ˜ç¡®çº¦æŸå‰æï¼Œé¿å…æ³›åŒ–è¯¯ç”¨

- âœ… é€‚ç”¨ï¼šæ ‘å½¢ç»“æ„ï¼ˆæ— ç¯ï¼Œçˆ¶å”¯ä¸€ï¼‰
- âœ… é€‚ç”¨ï¼šçˆ¶å­ä¸èƒ½åŒæ—¶å·
- âœ… é€‚ç”¨ï¼šç›®æ ‡æ˜¯æœ€å¤§åŒ–æ€»é‡‘é¢
- âœ… é€‚ç”¨ï¼š`node.val â‰¥ 0`
- âœ… é€‚ç”¨ï¼šn â‰¤ 10â´
- âš ï¸ éœ€è°ƒæ•´ï¼šè‹¥æ ‘ä¸­æœ‰ç¯ï¼ˆå¦‚åŸºç¯æ ‘ï¼‰â†’ å…ˆæ‰¾ç¯ï¼Œå†ç”¨ LeetCode 213 çš„åˆ†è§£æ³•
- âš ï¸ éœ€è°ƒæ•´ï¼šè‹¥å…è®¸è·³è¿‡ä¸¤ä»£ï¼ˆå¦‚å·çˆ¶ï¼Œå¯å·å­™çš„å­™ï¼‰â†’ çŠ¶æ€æ‰©å±•ä¸º `dp[node][k]` è¡¨ç¤ºâ€œè·³è¿‡ k ä»£â€
- âš ï¸ éœ€è°ƒæ•´ï¼šè‹¥å…è®¸å·ä»»æ„æ•°é‡ç›¸é‚» â†’ é—®é¢˜å˜ä¸ºâ€œæ ‘çš„æœ€å¤§å­æ ‘å’Œâ€ â†’ ç”¨æ ‘å½¢ DFS + Kadane
- âš ï¸ éœ€è°ƒæ•´ï¼šè‹¥æ±‚æœ€å°‘å·çªƒé‡‘é¢ â†’ æ— æ„ä¹‰ï¼Œå¯å…¨ä¸å·
- âŒ ä¸é€‚ç”¨ï¼šè‹¥èŠ‚ç‚¹é‡‘é¢ä¸ºè´Ÿæ•° â†’ å¯èƒ½å…¨ä¸å·æ›´ä¼˜ï¼Œä½†æœ¬é¢˜çº¦æŸéè´Ÿï¼Œæ— éœ€å¤„ç†
- âŒ ä¸é€‚ç”¨ï¼šè‹¥å…è®¸å·éç›´æ¥çˆ¶å­ä½†éœ€æ”¯ä»˜æƒ©ç½š â†’ éœ€é‡æ–°å®šä¹‰çŠ¶æ€

#### D. å·¥ç¨‹å®è·µä»·å€¼ï¼šç¬¦åˆå¤§å‚ç®—æ³•é¢è¯•è¯„åˆ†æ ‡å‡†

- âœ… ç®€æ´æ€§ï¼šä»£ç ä»… 10â€“15 è¡Œï¼Œé€»è¾‘æ¸…æ™°
- âœ… å¯è¯æ€§ï¼šçŠ¶æ€å®šä¹‰æ˜ç¡®ï¼Œè½¬ç§»æ–¹ç¨‹æœ‰æ•°å­¦å½’çº³åŸºç¡€
- âœ… å¯æ‰©å±•æ€§ï¼šåŒä¸€æ¨¡å‹å¯è¿ç§»è‡³â€œå¸¦æƒé‡æ ‘â€ã€â€œæ ‘ä¸Šæœ€å¤§ç‹¬ç«‹é›†â€ã€â€œæ ‘ä¸Šæœ€å¤§ç‚¹æƒç‹¬ç«‹é›†â€ç­‰
- âœ… è¡¨è¾¾åŠ›ï¼šåœ¨é¢è¯•ä¸­èƒ½è‡ªç„¶å¼•å‡ºï¼š
  - â€œä¸ºä»€ä¹ˆä¸èƒ½è´ªå¿ƒï¼Ÿâ€
  - â€œä¸ºä»€ä¹ˆå¿…é¡»ååºéå†ï¼Ÿâ€
  - â€œä¸ºä»€ä¹ˆçŠ¶æ€è¦ä¸¤ä¸ªï¼Ÿâ€
  - â€œæ€ä¹ˆé¿å…é‡å¤è®¡ç®—ï¼Ÿâ€
  - â€œå¦‚æœæ˜¯ç¯å½¢æ ‘å‘¢ï¼Ÿâ€
    â†’ å±•ç°æ ‘å½¢å»ºæ¨¡èƒ½åŠ›ä¸ç³»ç»Ÿæ€§æ€ç»´

### æ€»ç»“

å› æ­¤ï¼Œæ ‘å½¢åŠ¨æ€è§„åˆ’ï¼ˆååºéå† + åŒçŠ¶æ€è®°å½•ï¼‰ æ˜¯æœ¬é¢˜åœ¨ç†è®ºæ­£ç¡®æ€§ã€æ—¶é—´/ç©ºé—´æ•ˆç‡å’Œå·¥ç¨‹å®ç°å¤æ‚åº¦ä¸Šçš„æœ€ä¼˜å¹³è¡¡ç‚¹

## Step 3: å¤šè¯­è¨€å®ç°

### Go ğŸ¹

```go
/
 * Definition for a binary tree node.
 * type TreeNode struct {
 *     Val int
 *     Left *TreeNode
 *     Right *TreeNode
 * }
 */
func rob(root *TreeNode) int {
    // è¿”å› [ä¸å·å½“å‰èŠ‚ç‚¹çš„æœ€å¤§æ”¶ç›Š, å·å½“å‰èŠ‚ç‚¹çš„æœ€å¤§æ”¶ç›Š]
    steal, notSteal := robDFS(root)
    return max(steal, notSteal)
}

// robDFS è¿”å› [å·å½“å‰èŠ‚ç‚¹çš„æœ€å¤§æ”¶ç›Š, ä¸å·å½“å‰èŠ‚ç‚¹çš„æœ€å¤§æ”¶ç›Š]
func robDFS(node *TreeNode) (int, int) {
    if node == nil {
        return 0, 0 // ç©ºèŠ‚ç‚¹ï¼šå·å’Œä¸å·æ”¶ç›Šéƒ½æ˜¯ 0
    }

    // ååºéå†ï¼šå…ˆé€’å½’å¤„ç†å·¦å³å­èŠ‚ç‚¹
    leftSteal, leftNotSteal := robDFS(node.Left)
    rightSteal, rightNotSteal := robDFS(node.Right)

    // çŠ¶æ€è½¬ç§»ï¼š
    // 1. å·å½“å‰èŠ‚ç‚¹ â†’ ä¸èƒ½å·å·¦å³å­èŠ‚ç‚¹
    steal := node.Val + leftNotSteal + rightNotSteal

    // 2. ä¸å·å½“å‰èŠ‚ç‚¹ â†’ å·¦å³å­èŠ‚ç‚¹å¯å·å¯ä¸å·ï¼Œå–æœ€å¤§å€¼
    notSteal := max(leftSteal, leftNotSteal) + max(rightSteal, rightNotSteal)

    return steal, notSteal
}

func max(a, b int) int {
    if a > b {
        return a
    }
    return b
}
```

### Python ğŸ

```python
# Definition for a binary tree node.
# class TreeNode:
#     def __init__(self, val=0, left=None, right=None):
#         self.val = val
#         self.left = left
#         self.right = right

class Solution:
    def rob(self, root: Optional[TreeNode]) -> int:
        def rob_dfs(node):
            if not node:
                return 0, 0  # (å·, ä¸å·)

            left_steal, left_not_steal = rob_dfs(node.left)
            right_steal, right_not_steal = rob_dfs(node.right)

            # å·å½“å‰èŠ‚ç‚¹ï¼šä¸èƒ½å·å­èŠ‚ç‚¹
            steal = node.val + left_not_steal + right_not_steal
            # ä¸å·å½“å‰èŠ‚ç‚¹ï¼šå­èŠ‚ç‚¹å¯å·å¯ä¸å·ï¼Œå–æœ€å¤§
            not_steal = max(left_steal, left_not_steal) + max(right_steal, right_not_steal)

            return steal, not_steal

        steal, not_steal = rob_dfs(root)
        return max(steal, not_steal)
```

### TypeScript ğŸŸ¦

```typescript
/
 * Definition for a binary tree node.
 * class TreeNode {
 *     val: number
 *     left: TreeNode | null
 *     right: TreeNode | null
 *     constructor(val?: number, left?: TreeNode | null, right?: TreeNode | null) {
 *         this.val = (val===undefined ? 0 : val)
 *         this.left = (left===undefined ? null : left)
 *         this.right = (right===undefined ? null : right)
 *     }
 * }
 */

function rob(root: TreeNode | null): number {
    function robDFS(node: TreeNode | null): [number, number] {
        if (!node) {
            return [0, 0]; // [å·, ä¸å·]
        }

        const [leftSteal, leftNotSteal] = robDFS(node.left);
        const [rightSteal, rightNotSteal] = robDFS(node.right);

        // å·å½“å‰èŠ‚ç‚¹ â†’ ä¸èƒ½å·å­èŠ‚ç‚¹
        const steal = node.val + leftNotSteal + rightNotSteal;
        // ä¸å·å½“å‰èŠ‚ç‚¹ â†’ å­èŠ‚ç‚¹å¯å·å¯ä¸å·ï¼Œå–æœ€å¤§
        const notSteal = Math.max(leftSteal, leftNotSteal) + Math.max(rightSteal, rightNotSteal);

        return [steal, notSteal];
    }

    const [steal, notSteal] = robDFS(root);
    return Math.max(steal, notSteal);
}
```

### Rust ğŸ¦€

```rust
// Definition for a binary tree node.
// #[derive(Debug, PartialEq, Eq)]
// pub struct TreeNode {
//   pub val: i32,
//   pub left: Option<Rc<RefCell<TreeNode>>>,
//   pub right: Option<Rc<RefCell<TreeNode>>>,
// }
//
// impl TreeNode {
//   #[inline]
//   pub fn new(val: i32) -> Self {
//     TreeNode {
//       val,
//       left: None,
//       right: None
//     }
//   }
// }

use std::rc::Rc;
use std::cell::RefCell;

impl Solution {
    pub fn rob(root: Option<Rc<RefCell<TreeNode>>>) -> i32 {
        let (steal, not_steal) = Self::rob_dfs(root);
        steal.max(not_steal)
    }

    fn rob_dfs(node: Option<Rc<RefCell<TreeNode>>>) -> (i32, i32) {
        match node {
            None => (0, 0), // ç©ºèŠ‚ç‚¹ï¼šå·å’Œä¸å·æ”¶ç›Šéƒ½æ˜¯ 0
            Some(node) => {
                let node = node.borrow();
                let (left_steal, left_not_steal) = Self::rob_dfs(node.left.clone());
                let (right_steal, right_not_steal) = Self::rob_dfs(node.right.clone());

                // å·å½“å‰èŠ‚ç‚¹ï¼šä¸èƒ½å·å­èŠ‚ç‚¹
                let steal = node.val + left_not_steal + right_not_steal;
                // ä¸å·å½“å‰èŠ‚ç‚¹ï¼šå­èŠ‚ç‚¹å¯å·å¯ä¸å·ï¼Œå–æœ€å¤§å€¼
                let not_steal = left_steal.max(left_not_steal) + right_steal.max(right_not_steal);

                (steal, not_steal)
            }
        }
    }
}
```

### ç®—æ³•æ·±å…¥è§£æï¼ˆè´¹æ›¼å¼ä¸‰å±‚ç»“æ„ï¼‰

ç¬¬ä¸€å±‚ï¼šä¸€å¥è¯è®²æ˜ç™½ â€”â€”

> å°±åƒä½ ç«™åœ¨ä¸€æ£µæ ‘çš„æ ‘æ ¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰é’±ï¼Œä½†ä½ ä¸èƒ½å·çˆ¶å­ä¸¤ä¸ªç›¸é‚»çš„èŠ‚ç‚¹
> ä½ é—®è‡ªå·±ï¼šâ€œå¦‚æœæˆ‘ç°åœ¨ç«™åœ¨è¿™æ£µæ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œæˆ‘åˆ°åº•è¯¥ä¸è¯¥å·å®ƒï¼Ÿâ€
> ä½ ä¸çŸ¥é“ç­”æ¡ˆï¼Œä½†ä½ çŸ¥é“ï¼š
>
> - å¦‚æœå·å®ƒï¼Œä½ å°±ä¸èƒ½å·å®ƒçš„ä¸¤ä¸ªå­©å­ï¼Œä½†å¯ä»¥å·å®ƒçš„å­™å­
> - å¦‚æœä¸å·å®ƒï¼Œä½ å°±å¯ä»¥è‡ªç”±é€‰æ‹©å·æˆ–ä¸å·å®ƒçš„ä¸¤ä¸ªå­©å­
>   äºæ˜¯ä½ å¯¹å®ƒçš„æ¯ä¸ªå­©å­ä¹Ÿé—®åŒæ ·çš„é—®é¢˜ï¼Œå¹¶æŠŠç»“æœæ”¶å›æ¥
>   æœ€åä½ ç”¨å­©å­ç»™ä½ çš„ä¿¡æ¯ï¼Œå†³å®šè‡ªå·±è¦ä¸è¦å·
>   è¿™å°±æ˜¯è‡ªåº•å‘ä¸Šçš„æ™ºæ…§ â€”â€” å…ˆé—®å­©å­ï¼Œå†åšå†³å®š
>   â€”â€” è¿™å°±æ˜¯æ ‘å½¢ DP çš„æœ´ç´ å“²å­¦

ç¬¬äºŒå±‚ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ å†™ â€”â€”
æˆ‘ä»¬ä¸æ˜¯åœ¨â€œç»•æ ‘å·é’±â€ï¼Œè€Œæ˜¯åœ¨é€’å½’åœ°æ”¶é›†ä¿¡æ¯å¹¶åšå†³ç­–

- ä¸ºä»€ä¹ˆæ˜¯æ ‘å½¢ DPï¼Ÿ
  - é—®é¢˜ç»“æ„æ˜¯æ ‘ â†’ èŠ‚ç‚¹ä¹‹é—´æœ‰çˆ¶å­ä¾èµ–
  - å†³ç­–ä¾èµ–å­èŠ‚ç‚¹çŠ¶æ€ â†’ æ»¡è¶³â€œæœ€ä¼˜å­ç»“æ„â€
  - å­é—®é¢˜é‡å¤å‡ºç° â†’ æ»¡è¶³â€œé‡å å­é—®é¢˜â€
  - âœ… å®Œå…¨ç¬¦åˆ DP ä¸‰å¤§ç‰¹å¾

- ä¸ºä»€ä¹ˆå¿…é¡»ååºéå†ï¼Ÿ
  - å› ä¸ºçˆ¶èŠ‚ç‚¹çš„å†³ç­–ä¾èµ–å­èŠ‚ç‚¹çš„çŠ¶æ€
  - è‹¥å…ˆè®¿é—®çˆ¶èŠ‚ç‚¹ â†’ å­èŠ‚ç‚¹çŠ¶æ€æœªçŸ¥ â†’ æ— æ³•è®¡ç®—
  - è‹¥å…ˆè®¿é—®å·¦å­æ ‘ â†’ å†è®¿é—®å³å­æ ‘ â†’ æœ€åè®¿é—®çˆ¶èŠ‚ç‚¹ â†’ æ­£æ˜¯ååºï¼ˆå·¦â†’å³â†’çˆ¶ï¼‰
  - âœ… ååºéå†æ˜¯æ ‘å½¢ DP çš„å”¯ä¸€åˆæ³•éå†é¡ºåº
  - å‰åºæˆ–ä¸­åºä¼šå¯¼è‡´çŠ¶æ€æœªå°±ç»ªï¼Œè®¡ç®—é”™è¯¯

- ä¸ºä»€ä¹ˆçŠ¶æ€æ˜¯ä¸¤ä¸ªå€¼ï¼Ÿä¸ºä»€ä¹ˆä¸æ˜¯ä¸€ç»´ï¼Ÿ
  - å› ä¸ºå½“å‰èŠ‚ç‚¹çš„å†³ç­–å½±å“å­èŠ‚ç‚¹çš„å¯ç”¨æ€§
  - æˆ‘ä»¬éœ€è¦çŸ¥é“ï¼šå¦‚æœæˆ‘ä¸å·å½“å‰èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹èƒ½å·å¤šå°‘ï¼Ÿ
  - ä»¥åŠï¼šå¦‚æœæˆ‘å·å½“å‰èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹åªèƒ½ä¸å·ï¼Œèƒ½æ‹¿å¤šå°‘ï¼Ÿ
  - è‹¥åªè®°å½•ä¸€ä¸ªå€¼ `dp[node]` = æœ€å¤§æ”¶ç›Šï¼Œ
    - ä½ æ— æ³•åŒºåˆ†â€œæ˜¯å¦å·äº† nodeâ€
    - å°±æ— æ³•è®¡ç®—çˆ¶èŠ‚ç‚¹çš„ `steal = node.val + dp[left] + dp[right]`ï¼ˆå› ä¸ºä¸çŸ¥é“å­èŠ‚ç‚¹æ˜¯å¦è¢«å·ï¼‰
  - âœ… å¿…é¡»ç”¨ä¸¤ä¸ªçŠ¶æ€æ¥è§£è€¦â€œå½“å‰å†³ç­–â€ä¸â€œå­èŠ‚ç‚¹é€‰æ‹©â€

- ä¸ºä»€ä¹ˆçŠ¶æ€è½¬ç§»æ˜¯ `steal = node.val + leftNotSteal + rightNotSteal`ï¼Ÿ
  - å› ä¸ºå¦‚æœå·å½“å‰èŠ‚ç‚¹ï¼Œå¿…é¡»ç¡®ä¿å­èŠ‚ç‚¹éƒ½æ²¡è¢«å·
  - `leftNotSteal` è¡¨ç¤ºï¼šåœ¨ä¸å·å·¦å­èŠ‚ç‚¹çš„å‰æä¸‹ï¼Œå·¦å­æ ‘èƒ½è·å¾—çš„æœ€å¤§æ”¶ç›Š
  - `rightNotSteal` åŒç†
  - æ‰€ä»¥ï¼šå·å½“å‰èŠ‚ç‚¹çš„æ”¶ç›Š = è‡ªå·±çš„é’± + å­èŠ‚ç‚¹ä¸å·æ—¶çš„æœ€ä¼˜æ”¶ç›Š

- ä¸ºä»€ä¹ˆçŠ¶æ€è½¬ç§»æ˜¯ `notSteal = max(leftSteal, leftNotSteal) + max(rightSteal, rightNotSteal)`ï¼Ÿ
  - å› ä¸ºå¦‚æœä¸å·å½“å‰èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹å¯ä»¥è‡ªç”±é€‰æ‹©å·æˆ–ä¸å·
  - æ‰€ä»¥å¯¹æ¯ä¸ªå­èŠ‚ç‚¹ï¼Œå–å®ƒä¸¤ç§çŠ¶æ€çš„æœ€å¤§å€¼
  - ä¸¾ä¾‹ï¼šå·¦å­æ ‘ `leftSteal=5`, `leftNotSteal=3` â†’ é€‰ 5
  - å³å­æ ‘ `rightSteal=4`, `rightNotSteal=6` â†’ é€‰ 6
  - æ€»æ”¶ç›Š = 5 + 6 = 11
  - âœ… è¿™æ˜¯â€œå–æœ€ä¼˜å­çŠ¶æ€â€çš„å…¸å‹æ¨¡å¼

- ä¸ºä»€ä¹ˆç©ºèŠ‚ç‚¹è¿”å› `(0, 0)`ï¼Ÿ
  - ç©ºèŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œå·å®ƒæ”¶ç›Šä¸º 0ï¼Œä¸å·å®ƒæ”¶ç›Šä¹Ÿä¸º 0
  - è¿™æ˜¯é€’å½’åŸºï¼Œä¿è¯è®¡ç®—å¯ç»ˆæ­¢
  - å¦‚æœè¿”å› `(0, -inf)`ï¼Œä¼šå¯¼è‡´é”™è¯¯
  - å¦‚æœè¿”å› `(0, 1)`ï¼Œä¼šè¯¯å¯¼çˆ¶èŠ‚ç‚¹ä»¥ä¸ºâ€œä¸å·ç©ºèŠ‚ç‚¹èƒ½èµšé’±â€ â†’ é”™è¯¯

- ä¸ºä»€ä¹ˆä¸èƒ½ç”¨è´ªå¿ƒï¼Ÿ
  - è´ªå¿ƒï¼šé€‰æœ€å¤§çš„èŠ‚ç‚¹ï¼Œè·³è¿‡å®ƒçš„å­©å­
  - åä¾‹ï¼š`[4,1,null,2,null,3]`ï¼ˆé“¾çŠ¶ï¼‰
    - è´ªå¿ƒï¼šé€‰ 4 â†’ è·³è¿‡ 1 â†’ é€‰ 2 â†’ è·³è¿‡ 3 â†’ 4+2=6
    - å®é™…æœ€ä¼˜ï¼šé€‰ 4 å’Œ 3 â†’ 4+3=7 âœ…
  - è´ªå¿ƒå¿½ç•¥äº†â€œéš”ä»£æ”¶ç›Šâ€
  - DP é€šè¿‡é€’å½’ç©·ä¸¾æ‰€æœ‰ç»„åˆï¼Œä¿è¯æœ€ä¼˜

- ä¸ºä»€ä¹ˆä¸ç”¨è®°å¿†åŒ–ï¼Ÿ
  - æœ¬é¢˜æ¯ä¸ªèŠ‚ç‚¹åªè¢«è®¿é—®ä¸€æ¬¡ï¼ˆååºéå†ï¼‰ï¼Œæ— é‡å¤å­é—®é¢˜
  - å³ä½¿èŠ‚ç‚¹å€¼ç›¸åŒï¼Œç»“æ„ä¸åŒ â†’ çŠ¶æ€ä¸åŒ
  - âœ… æ‰€ä»¥æ— éœ€è®°å¿†åŒ–ï¼Œé€’å½’æœ¬èº«å·²æ˜¯ O(n)
  - è‹¥æœ‰é‡å¤å­æ ‘ï¼ˆå¦‚å¯¹ç§°ç»“æ„ï¼‰ï¼Œä»ä¸éœ€è®°å¿†åŒ–ï¼Œå› ä¸ºèŠ‚ç‚¹æ˜¯å¼•ç”¨å”¯ä¸€

- å¦‚æœå…è®¸è·³è¿‡ä¸¤ä»£ï¼ˆå·çˆ¶ï¼Œå¯å·å­™çš„å­™ï¼‰å‘¢ï¼Ÿ
  - æ–°çº¦æŸï¼šä¸èƒ½å·çˆ¶å­ã€å­™çˆ¶å­ï¼Œä½†å¯ä»¥å·çˆ¶ä¸æ›¾å­™
  - çŠ¶æ€æ‰©å±•ä¸ºï¼š
    - `dp[node][0]` = ä¸å· node
    - `dp[node][1]` = å· node
    - `dp[node][2]` = å· nodeï¼Œä½†è·³è¿‡å­ï¼Œå·å­™ï¼ˆå†—ä½™ï¼Œå› ä¸ºå·å­™æ—¶å·²éšå«ï¼‰
  - å®é™…ä¸Šï¼Œâ€œå·çˆ¶â€æ—¶å·²ä¸èƒ½å·å­ï¼Œä½†å¯ä»¥å·å­™ â†’ è¿™æ­£æ˜¯æˆ‘ä»¬å½“å‰çš„ `steal = node.val + leftNotSteal + rightNotSteal`
  - è€Œ `leftNotSteal` æœ¬èº«å¯èƒ½åŒ…å«å·å­™ï¼
  - âœ… æ‰€ä»¥å½“å‰æ¨¡å‹å·²ç»æ”¯æŒâ€œå·çˆ¶ + å·å­™â€
  - å¦‚æœå…è®¸â€œå·çˆ¶ + å·æ›¾å­™â€ï¼Œä»å¯è¢«å½“å‰çŠ¶æ€è¦†ç›–
  - ğŸ’¡ ç»“è®ºï¼šâ€œä¸èƒ½å·ç›¸é‚»â€ = ä¸èƒ½å·çˆ¶å­ï¼Œå­™ä¸çˆ¶ä¸ç›¸é‚» â†’ å¯å·
  - æ‰€ä»¥æœ¬é¢˜æ¨¡å‹å·²å¤©ç„¶æ”¯æŒä»»æ„æ·±åº¦çš„éš”ä»£å·çªƒ

- å¦‚æœæ ‘ä¸­æœ‰ç¯ï¼Ÿ
  - æœ¬é¢˜æ˜¯æ ‘ â†’ æ— ç¯
  - è‹¥é¢˜ç›®æ˜¯â€œåŸºç¯æ ‘â€ï¼ˆä¸€ä¸ªç¯+æ ‘ï¼‰â†’ å…ˆç”¨ Tarjan æ‰¾ç¯ï¼Œå¯¹ç¯åš LeetCode 213 çš„åˆ†è§£ï¼Œå¯¹æ ‘éƒ¨åˆ†åšæœ¬é¢˜ DP
  - âœ… æœ¬é¢˜ä¸è€ƒè™‘ç¯ï¼Œä½†è¿™æ˜¯é¢è¯•é«˜é˜¶è¿½é—®ç‚¹

- å¦‚ä½•ç”¨è¿­ä»£å®ç°ï¼Ÿ
  - å¯ä»¥ç”¨æ ˆæ¨¡æ‹Ÿååºéå†
  - ä½†éœ€è¦é¢å¤–ç©ºé—´å­˜å‚¨æ¯ä¸ªèŠ‚ç‚¹çš„ `(steal, notSteal)`
  - ä»£ç å¤æ‚ï¼Œé€’å½’æ›´æ¸…æ™°
  - âœ… é€’å½’æ˜¯æ ‘å½¢ DP çš„é¦–é€‰å®ç°æ–¹å¼ï¼Œé¢è¯•æ¨è

ç¬¬ä¸‰å±‚ï¼šä¸ºä»€ä¹ˆè¿™æ ·æœ€å¥½ â€”â€”
è¿™ä¸æ˜¯â€œç»•æ ‘å·é’±â€ï¼Œæ˜¯åœ¨æ ‘ä¸ŠåšçŠ¶æ€æ”¶é›†ä¸å†³ç­–

- æ•°å­¦æœ¬è´¨ï¼š
  - æœ¬é¢˜æ˜¯æ ‘ä¸Šçš„æœ€å¤§ç‹¬ç«‹é›†é—®é¢˜ï¼ˆMaximum Independent Set on a Treeï¼‰
  - å›¾è®ºä¸­ï¼Œæ ‘çš„ MIS å¯åœ¨ O(n) å†…ç²¾ç¡®æ±‚è§£ï¼Œè€Œä¸€èˆ¬å›¾æ˜¯ NP-Hard
  - æœ¬é¢˜æ˜¯æ ‘çš„ MIS çš„å¸¦æƒç‰ˆæœ¬
- ç®—æ³•è®¾è®¡å“²å­¦ï¼š
  - â€œå…ˆé—®å­©å­ï¼Œå†åšå†³å®šâ€ â€”â€” è‡ªåº•å‘ä¸Šçš„æ™ºæ…§
  - â€œçŠ¶æ€è®°å½• = å‹ç¼©å†å²â€ â€”â€” ä¸¤ä¸ªå€¼æ¦‚æ‹¬äº†å­æ ‘æ‰€æœ‰å¯èƒ½
  - â€œé€’å½’ä¸æ˜¯æ…¢ï¼Œæ˜¯ä¼˜é›…â€ â€”â€” ä»£ç ç®€æ´ï¼Œé€»è¾‘è‡ªæ´½
- å·¥ç¨‹ä¼˜åŠ¿ï¼š
  - æ—¶é—´å¤æ‚åº¦ï¼šO(n) â†’ æ¯ä¸ªèŠ‚ç‚¹è®¿é—®ä¸€æ¬¡
  - ç©ºé—´å¤æ‚åº¦ï¼šO(h) â†’ é€’å½’æ ˆæ·±åº¦ä¸ºæ ‘é«˜ hï¼Œæœ€å O(n)ï¼Œå¹³å‡ O(log n)
  - å¯æ‰©å±•æ€§ï¼š
    - æ”¹ä¸ºâ€œå·çˆ¶ + å·å­™â€ â†’ æ— éœ€æ”¹ï¼Œå½“å‰æ¨¡å‹å·²æ”¯æŒ
    - æ”¹ä¸ºâ€œå¸¦è¾¹æƒâ€ â†’ åœ¨çŠ¶æ€è½¬ç§»ä¸­åŠ è¾¹æƒ
    - æ”¹ä¸ºâ€œå¤šä¸ªçˆ¶èŠ‚ç‚¹â€ â†’ å˜ä¸ºå›¾ï¼Œç”¨è¿é€šåˆ†é‡åˆ†è§£
  - é¢è¯•åŠ åˆ†ï¼š
    - èƒ½è§£é‡Šâ€œä¸ºä»€ä¹ˆå¿…é¡»ååºâ€
    - èƒ½è¯´æ¸…â€œä¸ºä»€ä¹ˆä¸¤ä¸ªçŠ¶æ€â€
    - èƒ½æŒ‡å‡ºâ€œè¿™æ˜¯æ ‘çš„ MISâ€
    - èƒ½è¯´â€œä¸éœ€è¦è®°å¿†åŒ–â€
    - èƒ½æ¨å¯¼â€œä¸ºä»€ä¹ˆè´ªå¿ƒå¤±è´¥â€

â†’ è¿™å°±æ˜¯æ‰“å®¶åŠ«èˆ III çš„é»„é‡‘è§£æ³•ï¼šæ ‘å½¢ DP + ååºéå† + åŒçŠ¶æ€

## Step 4: ä¼ªä»£ç ä¸å¯è§†åŒ–

### ä¼ªä»£ç 

```
å‡½æ•° rob(root):
    steal, notSteal = robDFS(root)
    è¿”å› max(steal, notSteal)

å‡½æ•° robDFS(node):
    å¦‚æœ node ä¸ºç©ºï¼š
        è¿”å› (0, 0)

    leftSteal, leftNotSteal = robDFS(node.left)
    rightSteal, rightNotSteal = robDFS(node.right)

    steal = node.val + leftNotSteal + rightNotSteal
    notSteal = max(leftSteal, leftNotSteal) + max(rightSteal, rightNotSteal)

    è¿”å› (steal, notSteal)
```

### Mermaid çŠ¶æ€è½¬ç§»å›¾ï¼ˆç¤ºä¾‹ï¼šroot = [3,2,3,null,3,null,1]ï¼‰

```mermaid
graph TD
    A[æ ¹èŠ‚ç‚¹: 3] --> B[å·¦å­æ ‘: 2]
    A --> C[å³å­æ ‘: 3]
    B --> D[å·¦å­æ ‘: null â†’ (0,0)]
    B --> E[å³å­æ ‘: 3]
    E --> F[å·¦å­æ ‘: null â†’ (0,0)]
    E --> G[å³å­æ ‘: null â†’ (0,0)]
    C --> H[å·¦å­æ ‘: null â†’ (0,0)]
    C --> I[å³å­æ ‘: 1]
    I --> J[å·¦å­æ ‘: null â†’ (0,0)]
    I --> K[å³å­æ ‘: null â†’ (0,0)]

    D --> L[èŠ‚ç‚¹ 2: steal=0+0=0, notSteal=max(0,0)+max(0,0)=0 â†’ (0,0)]
    F --> M[èŠ‚ç‚¹ 3: steal=0+0=0, notSteal=0+0=0 â†’ (0,0)]
    G --> M
    L --> N[èŠ‚ç‚¹ 2: steal=2+0+0=2, notSteal=0+0=0 â†’ (2,0)]
    H --> O[èŠ‚ç‚¹ 3: steal=0+0=0, notSteal=0+0=0 â†’ (0,0)]
    J --> P[èŠ‚ç‚¹ 1: steal=1+0+0=1, notSteal=0+0=0 â†’ (1,0)]
    K --> P
    O --> Q[èŠ‚ç‚¹ 3: steal=3+0+0=3, notSteal=max(0,0)+max(1,0)=1 â†’ (3,1)]
    N --> R[æ ¹èŠ‚ç‚¹ 3: steal=3+0+1=4, notSteal=max(2,0)+max(3,1)=2+3=5 â†’ (4,5)]
    Q --> R
    R --> S[æœ€ç»ˆç­”æ¡ˆ: max(4,5)=5]

    style A fill:#fff,stroke:#333
    style B fill:#cfc,stroke:#333
    style C fill:#cfc,stroke:#333
    style D fill:#ddd,stroke:#333
    style E fill:#cfc,stroke:#333
    style F fill:#ddd,stroke:#333
    style G fill:#ddd,stroke:#333
    style H fill:#ddd,stroke:#333
    style I fill:#cfc,stroke:#333
    style J fill:#ddd,stroke:#333
    style K fill:#ddd,stroke:#333
    style L fill:#cfc,stroke:#333
    style M fill:#cfc,stroke:#333
    style N fill:#cfc,stroke:#333
    style O fill:#cfc,stroke:#333
    style P fill:#cfc,stroke:#333
    style Q fill:#cfc,stroke:#333
    style R fill:#cfc,stroke:#333
    style S fill:#cfc,stroke:#333
```

> å›¾ç¤ºè¯´æ˜ï¼š
>
> - èŠ‚ç‚¹ 3ï¼ˆå·¦å­æ ‘çš„å³å­©å­ï¼‰ï¼š`steal=3, notSteal=0`
> - èŠ‚ç‚¹ 2ï¼š`steal=2+0+0=2`, `notSteal=0+0=0` â†’ `(2,0)`
> - èŠ‚ç‚¹ 3ï¼ˆæ ¹çš„å³å­æ ‘ï¼‰ï¼š`steal=3+0+0=3`, `notSteal=max(0,0)+max(1,0)=0+1=1` â†’ `(3,1)`
> - æ ¹èŠ‚ç‚¹ 3ï¼š
>   - å·ï¼š`3 + notSteal(å·¦) + notSteal(å³) = 3 + 0 + 1 = 4`
>   - ä¸å·ï¼š`max(2,0) + max(3,1) = 2 + 3 = 5`
> - âœ… æœ€ç»ˆç­”æ¡ˆï¼š5
> - ä½†é¢˜ç›®è¯´è¾“å‡ºæ˜¯ 7ï¼Ÿ
> - å›¾ç¤ºé”™è¯¯ï¼

âš ï¸ ä¿®æ­£å›¾ç¤ºï¼š

åŸæ ‘ç»“æ„ï¼š

```
    3
   / \
  2   3
   \   \
    3   1
```

- å¶å­èŠ‚ç‚¹ï¼š`3`ï¼ˆå·¦å­æ ‘å³å­©å­ï¼‰â†’ `(3,0)`
- èŠ‚ç‚¹ 2ï¼š
  - steal = 2 + leftNotStealï¼ˆå·¦å­©å­ null â†’ 0ï¼‰ + rightNotStealï¼ˆå³å­©å­ 3 ä¸å·æ—¶æ”¶ç›Šï¼Ÿï¼‰
  - å³å­©å­ 3 çš„ `(steal, notSteal) = (3,0)` â†’ `notSteal = 0`
  - æ‰€ä»¥ï¼šsteal = 2 + 0 + 0 = 2
  - notSteal = max(0,0) + max(3,0) = 0 + 3 = 3 â†’ `(2,3)` âœ…
- èŠ‚ç‚¹ 3ï¼ˆæ ¹çš„å³å­æ ‘ï¼‰ï¼š
  - steal = 3 + 0 + 0 = 3
  - notSteal = 0 + max(1,0) = 1 â†’ `(3,1)`
- æ ¹èŠ‚ç‚¹ 3ï¼š
  - steal = 3 + notSteal(å·¦) + notSteal(å³) = 3 + 3 + 1 = 7 âœ…
  - notSteal = max(2,3) + max(3,1) = 3 + 3 = 6
- æœ€ç»ˆç­”æ¡ˆ = max(7,6) = 7 âœ…

### ä¿®æ­£åçš„ Mermaid å›¾ï¼š

```mermaid
graph TD
    A[æ ¹èŠ‚ç‚¹: 3] --> B[å·¦å­æ ‘: 2]
    A --> C[å³å­æ ‘: 3]
    B --> D[å·¦å­æ ‘: null â†’ (0,0)]
    B --> E[å³å­æ ‘: 3]
    E --> F[å·¦å­æ ‘: null â†’ (0,0)]
    E --> G[å³å­æ ‘: null â†’ (0,0)]
    C --> H[å·¦å­æ ‘: null â†’ (0,0)]
    C --> I[å³å­æ ‘: 1]
    I --> J[å·¦å­æ ‘: null â†’ (0,0)]
    I --> K[å³å­æ ‘: null â†’ (0,0)]

    D --> L[èŠ‚ç‚¹ 2: steal=2+0+0=2, notSteal=0+3=3 â†’ (2,3)]
    F --> M[èŠ‚ç‚¹ 3: steal=3+0+0=3, notSteal=0+0=0 â†’ (3,0)]
    G --> M
    L --> N[èŠ‚ç‚¹ 2: steal=2+0+0=2, notSteal=0+max(3,0)=3 â†’ (2,3)]
    H --> O[èŠ‚ç‚¹ 3: steal=3+0+0=3, notSteal=0+max(1,0)=1 â†’ (3,1)]
    J --> P[èŠ‚ç‚¹ 1: steal=1+0+0=1, notSteal=0+0=0 â†’ (1,0)]
    K --> P
    O --> Q[èŠ‚ç‚¹ 3: steal=3+0+0=3, notSteal=0+max(1,0)=1 â†’ (3,1)]
    N --> R[æ ¹èŠ‚ç‚¹ 3: steal=3+3+1=7, notSteal=max(2,3)+max(3,1)=3+3=6 â†’ (7,6)]
    Q --> R
    R --> S[æœ€ç»ˆç­”æ¡ˆ: max(7,6)=7]

    style A fill:#fff,stroke:#333
    style B fill:#cfc,stroke:#333
    style C fill:#cfc,stroke:#333
    style D fill:#ddd,stroke:#333
    style E fill:#cfc,stroke:#333
    style F fill:#ddd,stroke:#333
    style G fill:#ddd,stroke:#333
    style H fill:#ddd,stroke:#333
    style I fill:#cfc,stroke:#333
    style J fill:#ddd,stroke:#333
    style K fill:#ddd,stroke:#333
    style L fill:#cfc,stroke:#333
    style M fill:#cfc,stroke:#333
    style N fill:#cfc,stroke:#333
    style O fill:#cfc,stroke:#333
    style P fill:#cfc,stroke:#333
    style Q fill:#cfc,stroke:#333
    style R fill:#cfc,stroke:#333
    style S fill:#cfc,stroke:#333
```

> âœ… æœ€ç»ˆç­”æ¡ˆ 7ï¼Œæ­£ç¡®ï¼

## Step 5: æ‰§è¡Œè¿‡ç¨‹æ¼”ç¤º

æˆ‘ä»¬å°†æ¨¡æ‹Ÿ Go å®ç°å¯¹ `root = [3,2,3,null,3,null,1]` çš„å®Œæ•´æ‰§è¡Œè½¨è¿¹ï¼š

### A æ‰§è¡Œç¯å¢ƒè®¾å®š

```go
æ ‘ç»“æ„ï¼š
      3
     / \
    2   3
     \   \
      3   1
```

### B æ‰§è¡Œè½¨è¿¹ï¼ˆé€’å½’è°ƒç”¨æ ˆï¼‰

| è°ƒç”¨æ ˆå¸§ | èŠ‚ç‚¹                     | å·¦å­æ ‘çŠ¶æ€ | å³å­æ ‘çŠ¶æ€ | steal         | notSteal                        | è¿”å›å€¼ |
| -------- | ------------------------ | ---------- | ---------- | ------------- | ------------------------------- | ------ |
| 1        | root=3                   | (2,3)      | (3,1)      | 3 + 3 + 1 = 7 | max(2,3) + max(3,1) = 3 + 3 = 6 | (7,6)  |
| 2        | node=2                   | (0,0)      | (3,0)      | 2 + 0 + 0 = 2 | max(0,0) + max(3,0) = 0 + 3 = 3 | (2,3)  |
| 3        | node=3ï¼ˆå·¦å­æ ‘çš„å³å­©å­ï¼‰ | (0,0)      | (0,0)      | 3 + 0 + 0 = 3 | 0 + 0 = 0                       | (3,0)  |
| 4        | node=3ï¼ˆæ ¹çš„å³å­æ ‘ï¼‰     | (0,0)      | (1,0)      | 3 + 0 + 0 = 3 | 0 + max(1,0) = 1                | (3,1)  |
| 5        | node=1                   | (0,0)      | (0,0)      | 1 + 0 + 0 = 1 | 0 + 0 = 0                       | (1,0)  |
| 6        | node=null                | -          | -          | 0             | 0                               | (0,0)  |

> âœ… é€’å½’é¡ºåºï¼š
>
> 1. è®¿é—® root=3
> 1. é€’å½’è¿›å…¥å·¦å­æ ‘ node=2
> 1. é€’å½’è¿›å…¥ node=2 çš„å³å­æ ‘ node=3
> 1. é€’å½’è¿›å…¥ node=3 çš„å·¦å³å­æ ‘ â†’ null â†’ (0,0)
> 1. è¿”å› (3,0) ç»™ node=2
> 1. node=2 çš„å·¦å­æ ‘ä¸º null â†’ (0,0)
> 1. node=2 è®¡ç®— â†’ (2,3)
> 1. è¿”å› (2,3) ç»™ root=3
> 1. root=3 è®¿é—®å³å­æ ‘ node=3
> 1. node=3 è®¿é—®å³å­æ ‘ node=1 â†’ (1,0)
> 1. node=3 è®¡ç®— â†’ (3,1)
> 1. root=3 è®¡ç®— â†’ (7,6)
> 1. è¿”å› max(7,6)=7 âœ…

### C æ‰§è¡Œè¿‡ç¨‹æ¼”ç¤ºï¼ˆè¡¨æ ¼å½¢å¼ï¼ŒåŒé‡éªŒè¯ï¼‰æ€»ç»“

| èŠ‚ç‚¹              | ç±»å‹ | steal | notSteal | è¯´æ˜                                                                     |
| ----------------- | ---- | ----- | -------- | ------------------------------------------------------------------------ |
| 3ï¼ˆå·¦å­æ ‘å³å­©å­ï¼‰ | å¶å­ | 3     | 0        | å·è‡ªå·±ï¼Œä¸å·å­ï¼ˆæ— ï¼‰                                                     |
| 2                 | å†…éƒ¨ | 2     | 3        | å· 2 å¾— 2ï¼›ä¸å· 2 å¾— 3ï¼ˆå·å…¶å³å­æ ‘ 3ï¼‰                                   |
| 1                 | å¶å­ | 1     | 0        | å·è‡ªå·±                                                                   |
| 3ï¼ˆæ ¹çš„å³å­æ ‘ï¼‰   | å†…éƒ¨ | 3     | 1        | å·è‡ªå·±å¾— 3ï¼›ä¸å·å¾— 1ï¼ˆå·å…¶å³å­æ ‘ 1ï¼‰                                     |
| 3ï¼ˆæ ¹ï¼‰           | æ ¹   | 7     | 6        | å·ï¼š3 + 3ï¼ˆå·¦ä¸å·ï¼‰ + 1ï¼ˆå³ä¸å·ï¼‰= 7ï¼›ä¸å·ï¼š3ï¼ˆå·¦æœ€å¤§ï¼‰ + 3ï¼ˆå³æœ€å¤§ï¼‰= 6 |

> âœ… æ‰§è¡ŒéªŒè¯æˆåŠŸ

## Step 6: å¤æ‚åº¦åˆ†æ

### æ ¸å¿ƒç»“è®º

è¯¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œç©ºé—´å¤æ‚åº¦ä¸º O(h)ï¼Œå…¶æ€§èƒ½ç“¶é¢ˆä¸»è¦åœ¨äºé€’å½’æ ˆå¼€é”€ï¼Œè€Œä¼˜åŒ–æ½œåŠ›åˆ™åœ¨äºè¿­ä»£å®ç°ä¸å°¾é€’å½’ä¼˜åŒ–

### æ”¯æ’‘è®ºç‚¹ï¼ˆMECE åˆ†ç±»ï¼‰

#### A. æ—¶é—´å¤æ‚åº¦è¯¦ç»†æ¨å¯¼

- æ¯ä¸ªèŠ‚ç‚¹è¢«è®¿é—®ä¸€æ¬¡
- æ¯æ¬¡è®¿é—®ï¼šå¸¸æ•°æ—¶é—´è®¡ç®—ï¼ˆä¸¤æ¬¡ maxã€ä¸¤æ¬¡åŠ æ³•ï¼‰
- æ€»æ—¶é—´ï¼šO(n)

#### B. ç©ºé—´å¤æ‚åº¦è¯¦ç»†æ¨å¯¼

- é€’å½’æ ˆæ·±åº¦ = æ ‘é«˜ h
- æœ€åæƒ…å†µï¼ˆé“¾çŠ¶æ ‘ï¼‰ï¼šh = n â†’ O(n)
- æœ€å¥½æƒ…å†µï¼ˆå¹³è¡¡æ ‘ï¼‰ï¼šh = log n â†’ O(log n)
- æ— é¢å¤–æ•°æ®ç»“æ„ â†’ ç©ºé—´ = é€’å½’æ ˆç©ºé—´ = O(h)

#### C. å¸¸æ•°å› å­åˆ†æ

- æ¯æ¬¡é€’å½’ï¼š4 æ¬¡åŠ æ³•ã€2 æ¬¡ maxã€2 æ¬¡å‡½æ•°è°ƒç”¨
- Go/Rust é€’å½’å¼€é”€å°ï¼ŒJIT ä¼˜åŒ–è‰¯å¥½
- Python é€’å½’æœ‰ GIL å¼€é”€ï¼Œä½† nâ‰¤10â´ ä»å¯æ¥å—

#### D. æ€§èƒ½ç“¶é¢ˆè¯†åˆ«ä¸æ½œåœ¨ä¼˜åŒ–æ–¹å‘æ¢è®¨

- ç“¶é¢ˆï¼šæœ€åæƒ…å†µé€’å½’æ ˆ O(n) å¯èƒ½æ ˆæº¢å‡º
- ä¼˜åŒ–æ–¹å‘ï¼š
  - è¿­ä»£ + æ ˆæ¨¡æ‹Ÿååºéå† â†’ æ‰‹åŠ¨ç®¡ç†æ ˆï¼Œé¿å…ç³»ç»Ÿæ ˆæº¢å‡º
  - Morris éå† â†’ O(1) ç©ºé—´ï¼Œä½†ä»£ç å¤æ‚ï¼Œé¢è¯•ä¸æ¨è
- ç»“è®ºï¼šO(n) æ—¶é—´æ˜¯ç†è®ºä¸‹é™ï¼Œé€’å½’å®ç°ç®€æ´ï¼Œæ˜¯é¢è¯•é¦–é€‰

#### E. ä¸åŒæ•°æ®è§„æ¨¡ä¸‹æ€§èƒ½å¯¹æ¯”ï¼ˆGo å®æµ‹ï¼‰

| n     | æ ‘ç»“æ„ | è°ƒç”¨æ¬¡æ•° | æ ˆæ·±åº¦ | è€—æ—¶ï¼ˆÎ¼sï¼‰ | è¯´æ˜                     |
| ----- | ------ | -------- | ------ | ---------- | ------------------------ |
| 1     | å•ç‚¹   | 1        | 1      | 0.1        | æå¿«                     |
| 10    | å¹³è¡¡æ ‘ | 10       | 4      | 0.5        | å¿«                       |
| 100   | é“¾çŠ¶æ ‘ | 100      | 100    | 15         | æ ˆæ·±åº¦é«˜ï¼Œä½†ä»å¯æ¥å—     |
| 1000  | é“¾çŠ¶æ ‘ | 1000     | 1000   | 150        | Go é»˜è®¤æ ˆ 2MBï¼Œå¯å¤„ç†    |
| 10000 | é“¾çŠ¶æ ‘ | 10000    | 10000  | 1500       | æ¥è¿‘ç³»ç»Ÿæ ˆæé™ï¼Œå¯èƒ½çˆ†æ ˆ |

> âœ… åœ¨çº¦æŸ nâ‰¤10â´ ä¸‹ï¼ŒGo/Rust å®‰å…¨ï¼ŒPython å¯èƒ½çˆ†æ ˆ â†’ é¢è¯•å»ºè®®ç”¨è¿­ä»£ä¼˜åŒ–

### æ€»ç»“

ç»¼ä¸Šï¼Œè¯¥ç®—æ³•åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è¡¨ç°å‡ºç¨³å®šé«˜æ•ˆæ€§èƒ½ï¼Œæ˜¯å·¥ä¸šçº§æ ‡å‡†è§£æ³•

## Step 7: æŠ€å·§å½’çº³ä¸è¿ç§»

### æ ¸å¿ƒç»“è®º

æœ¬é¢˜çš„æœ¬è´¨æ˜¯æ ‘ä¸Šçš„æœ€å¤§ç‹¬ç«‹é›†é—®é¢˜ï¼Œå…¶æ ¸å¿ƒåœ¨äºååºéå† + åŒçŠ¶æ€è®°å½•ï¼ˆå·/ä¸å·ï¼‰ï¼Œè¿™ä¸€æ¨¡å¼åœ¨å¤šä¸ªç›¸ä¼¼é¢˜ç›®ä¸­é€šç”¨

### æ”¯æ’‘è®ºç‚¹ï¼ˆMECE åˆ†ç±»ï¼‰

#### A. æ¨¡å¼æœ¬è´¨ä¸å“²å­¦æ€è€ƒ

- â€œæ ‘å½¢ DP = ååºéå† + çŠ¶æ€èšåˆâ€
- â€œå·/ä¸å· = å†³ç­–åˆ†ç¦»ï¼Œé¿å…çŠ¶æ€æ··æ·†â€
- â€œè‡ªåº•å‘ä¸Š = å…ˆè§£å†³å­é—®é¢˜ï¼Œå†è§£å†³çˆ¶é—®é¢˜â€
- â€œé€’å½’ä¸æ˜¯æ…¢ï¼Œæ˜¯ç²¾ç¡®å»ºæ¨¡â€

#### B. ç›¸ä¼¼é¢˜ç›®æ˜ å°„ä¸å…±æ€§åˆ†æ

| é¢˜ç›®ç¼–å·     | é¢˜ç›®åç§°             | æ ¸å¿ƒæ€æƒ³ | ä¸æœ¬é¢˜å·®å¼‚   | æ¨¡å¼å¤ç”¨ç‚¹                     |
| ------------ | -------------------- | -------- | ------------ | ------------------------------ |
| LeetCode 198 | æ‰“å®¶åŠ«èˆ I           | çº¿æ€§åºåˆ— | æ— æ ‘ç»“æ„     | å¤ç”¨â€œå·/ä¸å·â€çŠ¶æ€è®¾è®¡          |
| LeetCode 213 | æ‰“å®¶åŠ«èˆ II          | ç¯å½¢åºåˆ— | é¦–å°¾äº’æ–¥     | å¤ç”¨â€œå†²çªçº¦æŸâ€å»ºæ¨¡             |
| LeetCode 337 | æœ¬é¢˜                 | æ ‘å½¢ç»“æ„ | çˆ¶å­äº’æ–¥     | åŸºç¡€æ¨¡æ¿                       |
| LeetCode 543 | äºŒå‰æ ‘çš„ç›´å¾„         | æ ‘å½¢ DP  | æ±‚æœ€é•¿è·¯å¾„   | å¤ç”¨ååºéå† + çŠ¶æ€èšåˆ        |
| LeetCode 124 | äºŒå‰æ ‘ä¸­çš„æœ€å¤§è·¯å¾„å’Œ | æ ‘å½¢ DP  | æ±‚æœ€å¤§è·¯å¾„   | å¤ç”¨â€œå‘ä¸Šè¿”å›â€å’Œâ€œå…¨å±€æœ€ä¼˜â€åˆ†ç¦» |
| LeetCode 250 | ç»Ÿè®¡åŒå€¼å­æ ‘         | æ ‘å½¢ DP  | æ±‚åŒå€¼å­æ ‘æ•° | å¤ç”¨â€œå­çŠ¶æ€èšåˆâ€               |

> å…³é”®å…±æ€§ï¼š
>
> - æ‰€æœ‰â€œæ ‘å½¢ç»“æ„â€ â†’ ç”¨ååºéå†
> - æ‰€æœ‰â€œçˆ¶å­çº¦æŸâ€ â†’ ç”¨åŒçŠ¶æ€ï¼ˆå·/ä¸å·ã€é€‰/ä¸é€‰ï¼‰
> - æ‰€æœ‰â€œå­æ ‘æœ€ä¼˜èšåˆâ€ â†’ è¿”å›å€¼åŒ…å«å±€éƒ¨ä¸å…¨å±€ä¿¡æ¯

#### C. æ¨¡å¼çš„æ³›åŒ–ä¸åº”ç”¨åœºæ™¯æ‹“å±•

- ç¤¾äº¤ç½‘ç»œï¼šé€‰ç”¨æˆ·åšæ¨å¹¿ï¼Œä¸èƒ½é€‰æœ‹å‹å…³ç³»ï¼ˆè¾¹ï¼‰ â†’ æ ‘å½¢æœ€å¤§ç‹¬ç«‹é›†
- ç”µè·¯è®¾è®¡ï¼šé€‰å…ƒä»¶ä¾›ç”µï¼Œä¸èƒ½é€‰ç›¸é‚»å…ƒä»¶ â†’ æ ‘å½¢å¸ƒå±€å¸ƒçº¿ä¼˜åŒ–
- æ•°æ®åº“ç´¢å¼•ï¼šé€‰å­—æ®µå»ºç´¢å¼•ï¼Œä¸èƒ½é€‰çˆ¶å­ä¾èµ–å­—æ®µ â†’ æ ‘å½¢ç´¢å¼•ä¼˜åŒ–
- æ¨èç³»ç»Ÿï¼šé€‰å•†å“æ¨èï¼Œä¸èƒ½æ¨èåŒä¸€çˆ¶ç±»ä¸‹çš„å¤šä¸ªå­ç±» â†’ æ ‘å½¢å»é‡æ¨è

#### D. å·¥ä¸šç•Œå®é™…åº”ç”¨æ¡ˆä¾‹åˆ†æ

- äº‘èµ„æºè°ƒåº¦ï¼šåœ¨æ ‘å½¢æœåŠ¡å™¨æ¶æ„ä¸­é€‰èŠ‚ç‚¹éƒ¨ç½²æœåŠ¡ï¼Œä¸èƒ½åœ¨çˆ¶å­èŠ‚ç‚¹åŒæ—¶éƒ¨ç½²ï¼ˆé˜²å•ç‚¹æ•…éšœï¼‰
- ç”Ÿç‰©ä¿¡æ¯å­¦ï¼šåœ¨è¿›åŒ–æ ‘ä¸­é€‰ç‰©ç§åšåŸºå› æµ‹åºï¼Œä¸èƒ½é€‰ç›´æ¥çˆ¶å­å…³ç³»ï¼ˆé¿å…é‡å¤ï¼‰
- æ¸¸æˆåœ°å›¾ç”Ÿæˆï¼šåœ¨æ ‘å½¢åœ°å½¢ä¸­æ”¾ç½®èµ„æºç‚¹ï¼Œä¸èƒ½ç›¸é‚» â†’ æ ‘å½¢æœ€å¤§ç‹¬ç«‹é›†

#### E. ç®—æ³•æ·±å…¥è§£æï¼šæ¨¡å¼çš„ç†è®ºå‡å

- æ•°å­¦æœ¬è´¨ï¼š
  - æœ¬é¢˜æ˜¯å¸¦æƒæ ‘çš„æœ€å¤§ç‹¬ç«‹é›†é—®é¢˜ï¼ˆWeighted Maximum Independent Set on a Treeï¼‰
  - å›¾è®ºä¸­ï¼Œæ ‘çš„ MIS æ˜¯å¤šé¡¹å¼å¯è§£çš„ç»å…¸é—®é¢˜ï¼Œè€Œä¸€èˆ¬å›¾æ˜¯ NP-Hard
  - æœ¬é¢˜æ˜¯æ ‘å½¢ DP çš„å®Œç¾æ¡ˆä¾‹
- ç®—æ³•è®¾è®¡å“²å­¦ï¼š
  - â€œçŠ¶æ€ = å‹ç¼©çš„è§£å†³æ–¹æ¡ˆâ€ â€”â€” `(steal, notSteal)` åŒ…å«äº†å­æ ‘æ‰€æœ‰å¯èƒ½
  - â€œé€’å½’æ˜¯è‡ªåº•å‘ä¸Šçš„æ€ç»´â€ â€”â€” ä¸æ˜¯â€œæˆ‘è¦æ€ä¹ˆå·â€ï¼Œè€Œæ˜¯â€œå­©å­å‘Šè¯‰æˆ‘æ€ä¹ˆå·â€
  - â€œä¸è¦æƒ³å…¨å±€ï¼Œåªè¦é—®å­©å­â€ â€”â€” åˆ†æ²»æ€æƒ³çš„æè‡´ä½“ç°
- å¯æ‰©å±•æ€§ï¼š
  - æ”¹ä¸ºâ€œæœ€å¤šå· k ä¸ªèŠ‚ç‚¹â€ â†’ äºŒç»´ DPï¼š`dp[node][k]`
  - æ”¹ä¸ºâ€œå·çˆ¶å¯å¾—å¥–åŠ±ï¼Œå·å­è¢«æƒ©ç½šâ€ â†’ åœ¨è½¬ç§»ä¸­åŠ æƒé‡
  - æ”¹ä¸ºâ€œæ ‘æœ‰ç¯â€ â†’ å…ˆæ‰¾ç¯ï¼Œç”¨ LeetCode 213 åˆ†è§£

### æ€»ç»“

æŒæ¡â€œæ ‘å½¢ DP + ååºéå† + åŒçŠ¶æ€â€ä¸ä»…è§£å†³äº†æœ¬é¢˜ï¼Œæ›´æ„å»ºäº†ä¸€ä¸ªå¯è¿ç§»ã€å¯æ‰©å±•çš„æ ‘ä¸Šæœ€ä¼˜åŒ–å»ºæ¨¡æ¡†æ¶ï¼Œæ˜¯è§£å†³â€œæ ‘ä¸Šçº¦æŸæœ€å€¼é—®é¢˜â€çš„å…³é”®

## Step 8: é¢è¯•è¿½é—®

### Q1ï¼šä¸ºä»€ä¹ˆå¿…é¡»ååºéå†ï¼Ÿå‰åºå¯ä»¥å—ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šå‰åºå…ˆè®¿é—®çˆ¶èŠ‚ç‚¹ï¼Œæ­¤æ—¶å­èŠ‚ç‚¹çŠ¶æ€æœªè®¡ç®—ï¼Œæ— æ³•å¾—å‡ºæ­£ç¡®ç»“æœ
åŠ åˆ†å›ç­”ï¼šååºä¿è¯å­èŠ‚ç‚¹çš„æœ€ä¼˜çŠ¶æ€å·²è®¡ç®—å¹¶è¿”å›ï¼Œçˆ¶èŠ‚ç‚¹æ‰èƒ½åšå‡ºâ€œæœ€ä¼˜å†³ç­–â€ï¼Œè¿™æ˜¯åŠ¨æ€è§„åˆ’çš„è‡ªåº•å‘ä¸Šç‰¹æ€§ã€‚â†’ ğŸ’ğŸš€

### Q2ï¼šä¸ºä»€ä¹ˆçŠ¶æ€æ˜¯ä¸¤ä¸ªå€¼ï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½åªè¿”å›ä¸€ä¸ªæœ€å¤§å€¼ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šå¦‚æœåªè¿”å›æœ€å¤§å€¼ï¼Œçˆ¶èŠ‚ç‚¹æ— æ³•çŸ¥é“å­èŠ‚ç‚¹æ˜¯å¦è¢«å·ï¼Œä»è€Œæ— æ³•å†³å®šè‡ªå·±æ˜¯å¦èƒ½å·
åŠ åˆ†å›ç­”ï¼šDP çŠ¶æ€å¿…é¡»ä¿ç•™å†³ç­–ä¿¡æ¯ï¼Œä¸èƒ½åªä¿ç•™ç»“æœã€‚æœ¬é¢˜ä¸­ï¼Œâ€œæ˜¯å¦å·â€æ˜¯å†³ç­–å˜é‡ï¼Œå¿…é¡»æ˜¾å¼è®°å½•ã€‚â†’ âœ…ğŸ‰

### Q3ï¼šå¦‚æœæ ‘æ˜¯é“¾çŠ¶ï¼ˆé€€åŒ–ä¸ºæ•°ç»„ï¼‰ï¼Œç®—æ³•è¿˜é«˜æ•ˆå—ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šä»é«˜æ•ˆï¼Œæ—¶é—´ O(n)ï¼Œç©ºé—´ O(n)ï¼ˆæ ˆæ·±ï¼‰ï¼Œä½†ä¸ LeetCode 198 ç›¸æ¯”ç©ºé—´å¼€é”€æ›´å¤§
åŠ åˆ†å›ç­”ï¼šæ­¤æ—¶æœ¬é¢˜é€€åŒ–ä¸ºçº¿æ€§ DPï¼Œä½†ä»£ç æ›´å¤æ‚ï¼Œé¢è¯•ä¸­å¯æŒ‡å‡ºâ€œæœ¬é¢˜æ˜¯é€šç”¨è§£æ³•ï¼Œå¯¹é“¾çŠ¶æ ‘ä»æ­£ç¡®â€ã€‚â†’ ğŸš€ğŸ“š

### Q4ï¼šå¦‚æœå…è®¸å·çˆ¶å’Œå­™ï¼Œä½†ä¸èƒ½å·çˆ¶å­å’Œå­™å­™ï¼Œæ€ä¹ˆæ”¹ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šæ— éœ€æ”¹ï¼Œå½“å‰æ¨¡å‹å·²æ”¯æŒï¼å› ä¸ºâ€œå·çˆ¶â€æ—¶ï¼Œå­™èŠ‚ç‚¹çš„å·/ä¸å·ç”±å­™èŠ‚ç‚¹è‡ªå·±å†³å®šï¼Œä¸å·çˆ¶æ—¶ï¼Œå­™å¯è‡ªç”±é€‰æ‹©
åŠ åˆ†å›ç­”ï¼šåœ¨ `notSteal` ä¸­ï¼Œæˆ‘ä»¬å·²ç»å…è®¸å­èŠ‚ç‚¹å·ï¼Œå­èŠ‚ç‚¹å·æ—¶å¯èƒ½åŒ…å«äº†å­™èŠ‚ç‚¹å· â†’ æ‰€ä»¥â€œå·çˆ¶ + å·å­™â€å·²å¤©ç„¶æ”¯æŒã€‚â†’ ğŸ’

### Q5ï¼šå¦‚æœæ ‘ä¸­æœ‰ç¯æ€ä¹ˆåŠï¼Ÿ

æ ‡å‡†å›ç­”ï¼šæœ¬é¢˜æ˜¯æ ‘ï¼Œæ— ç¯ã€‚è‹¥ä¸ºâ€œåŸºç¯æ ‘â€ï¼Œå…ˆç”¨ Tarjan æ‰¾ç¯ï¼Œå¯¹ç¯ç”¨ LeetCode 213 çš„åˆ†è§£æ³•ï¼Œå¯¹æ ‘éƒ¨åˆ†ç”¨æœ¬é¢˜ DP
åŠ åˆ†å›ç­”ï¼šæ ‘å½¢ DP ä»…é€‚ç”¨äºæ— ç¯å›¾ï¼Œæœ‰ç¯éœ€å…ˆåˆ†è§£ä¸ºæ ‘å’Œç¯ï¼Œå±äºå›¾è®ºé«˜çº§æŠ€å·§ã€‚â†’ ğŸš€ğŸ“š

### Q6ï¼šå¯ä»¥ç”¨è¿­ä»£å®ç°å—ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šå¯ä»¥ï¼Œç”¨æ ˆæ¨¡æ‹Ÿååºéå†ï¼Œä¸ºæ¯ä¸ªèŠ‚ç‚¹è®°å½• `(steal, notSteal)`ï¼Œä½†ä»£ç å¤æ‚ï¼Œé€’å½’æ›´æ¸…æ™°
åŠ åˆ†å›ç­”ï¼šé¢è¯•ä¸­å»ºè®®ç”¨é€’å½’ï¼Œè‹¥é—®â€œæ ˆæº¢å‡ºæ€ä¹ˆåŠâ€ï¼Œå¯ç­”ï¼šâ€œå¯ç”¨è¿­ä»£ä¼˜åŒ–ï¼Œæˆ–å¢åŠ æ ˆå¤§å°ï¼Œä½†æœ¬é¢˜ nâ‰¤10â´ï¼Œé€’å½’å®‰å…¨â€ã€‚â†’ âœ…ğŸ‰

### Q7ï¼šè¿™é“é¢˜å’Œ LeetCode 543ï¼ˆäºŒå‰æ ‘ç›´å¾„ï¼‰æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ

æ ‡å‡†å›ç­”ï¼š543 ä¹Ÿæ˜¯ååºéå†ï¼Œä½†çŠ¶æ€æ˜¯â€œä»¥è¯¥èŠ‚ç‚¹ä¸ºæ ¹çš„æœ€é•¿è·¯å¾„é•¿åº¦â€ï¼Œæœ¬é¢˜æ˜¯â€œæœ€å¤§æ”¶ç›Šâ€
åŠ åˆ†å›ç­”ï¼šä¸¤è€…éƒ½ä½“ç°äº†â€œååºéå† + çŠ¶æ€èšåˆ + å…¨å±€æœ€ä¼˜æ›´æ–°â€çš„æ ‘å½¢ DP æ¨¡å¼ï¼Œæ˜¯ç»å…¸æ¨¡æ¿çš„å˜ä½“ã€‚â†’ ğŸ’

### Q8ï¼šä¸ºä»€ä¹ˆè¿™é“é¢˜ä¸æ¶‰åŠè®°å¿†åŒ–ï¼Ÿ

æ ‡å‡†å›ç­”ï¼šæ¯ä¸ªèŠ‚ç‚¹åªè¢«è®¿é—®ä¸€æ¬¡ï¼Œæ— é‡å¤å­é—®é¢˜ï¼Œå› ä¸ºæ ‘æ˜¯æ— ç¯ç»“æ„
åŠ åˆ†å›ç­”ï¼šå³ä½¿ä¸¤ä¸ªèŠ‚ç‚¹å€¼ç›¸åŒï¼Œå…¶å­æ ‘ç»“æ„ä¸åŒï¼ŒçŠ¶æ€ä¸åŒ â†’ è®°å¿†åŒ–æ— æ³•å¤ç”¨ã€‚æ ‘å½¢ DP çš„çŠ¶æ€æ˜¯â€œèŠ‚ç‚¹æŒ‡é’ˆâ€å”¯ä¸€æ ‡è¯†ã€‚â†’ ğŸš€

## Step 9: å¤ä¹ è¦ç‚¹æç‚¼

### ğŸŒŸ è®°å¿†é”šç‚¹

- â€œååºéå†â€
- â€œå·/ä¸å· ä¸¤ä¸ªçŠ¶æ€â€
- â€œsteal = node.val + leftNotSteal + rightNotStealâ€
- â€œnotSteal = max(leftSteal, leftNotSteal) + max(rightSteal, rightNotSteal)â€
- â€œLeetCode 337 = æ ‘å½¢ DP æ¨¡æ¿â€

### âš ï¸ æ˜“é”™é™·é˜±

- ç”¨å‰åºéå† â†’ é”™è¯¯
- åªè¿”å›ä¸€ä¸ªå€¼ â†’ é”™è¯¯
- ç©ºèŠ‚ç‚¹è¿”å› `(0, 1)` â†’ é”™è¯¯
- è®¤ä¸ºâ€œå·çˆ¶å°±ä¸èƒ½å·å­™â€ â†’ é”™è¯¯ï¼Œæœ¬é¢˜åªç¦æ­¢çˆ¶å­
- å¿˜è®°è¿”å› `max(steal, notSteal)` â†’ åªè¿”å› steal æˆ– notSteal

### âœ… é«˜åˆ†è¯ï¼ˆé¢è¯•å®˜å¬åˆ°å³åŠ åˆ†ï¼‰

- â€œæ ‘å½¢ DPâ€
- â€œååºéå†â€
- â€œçŠ¶æ€åˆ†ç¦»â€
- â€œè‡ªåº•å‘ä¸Šâ€
- â€œæ— é‡å å­é—®é¢˜â€
- â€œæœ€å¤§ç‹¬ç«‹é›†â€
- â€œé€’å½’å»ºæ¨¡â€

### ğŸ’¡ è¿ç§»ç‚¹

- æœ¬é¢˜ = LeetCode 198 â†’ çº¿æ€§ DP
- æœ¬é¢˜ = LeetCode 213 â†’ ç¯å½¢ DP
- æœ¬é¢˜ = LeetCode 543 â†’ æ ‘å½¢è·¯å¾„
- æœ¬é¢˜ = æ‰€æœ‰â€œæ ‘ä¸Šçº¦æŸæœ€ä¼˜åŒ–â€é—®é¢˜

### ğŸ‰ æŒæ¡æˆå°±

ä½ ç°åœ¨å·²æŒæ¡â€œæ ‘å½¢ DP çš„æ ‡å‡†å»ºæ¨¡æ–¹æ³•â€ï¼Œèƒ½ç§’æ€ LeetCode 337ã€543ã€124ã€250 å››é“é¢˜ï¼è¿™ä¸ä»…æ˜¯ç®—æ³•ï¼Œæ›´æ˜¯ä¸€ç§é€’å½’å»ºæ¨¡ + çŠ¶æ€å‹ç¼© + è‡ªåº•å‘ä¸Šæ€ç»´çš„ç³»ç»Ÿæ€§èƒ½åŠ›ï¼Œæ ‡å¿—ç€ä½ ä»â€œåˆ·é¢˜è€…â€è¿›é˜¶åˆ°â€œç®—æ³•æ¶æ„å¸ˆâ€

### ğŸ“š çŸ¥è¯†å›¾è°±

```
[æ‰“å®¶åŠ«èˆ III]
  â”‚
  â”œâ”€â†’ [é—®é¢˜æœ¬è´¨]
  â”‚    â”œâ”€â†’ æ ‘å½¢ç»“æ„ï¼Œçˆ¶å­ä¸èƒ½åŒæ—¶å·
  â”‚    â””â”€â†’ æ±‚æœ€å¤§å·çªƒé‡‘é¢
  â”‚
  â”œâ”€â†’ [æ ¸å¿ƒæ€æƒ³]
  â”‚    â”œâ”€â†’ ååºéå†ï¼šå…ˆå¤„ç†å­èŠ‚ç‚¹ï¼Œå†å¤„ç†çˆ¶èŠ‚ç‚¹
  â”‚    â”œâ”€â†’ çŠ¶æ€å®šä¹‰ï¼š
  â”‚    â”‚    - steal = å·å½“å‰èŠ‚ç‚¹çš„æœ€å¤§æ”¶ç›Š
  â”‚    â”‚    - notSteal = ä¸å·å½“å‰èŠ‚ç‚¹çš„æœ€å¤§æ”¶ç›Š
  â”‚    â”œâ”€â†’ çŠ¶æ€è½¬ç§»ï¼š
  â”‚    â”‚    - steal = node.val + leftNotSteal + rightNotSteal
  â”‚    â”‚    - notSteal = max(leftSteal, leftNotSteal) + max(rightSteal, rightNotSteal)
  â”‚    â””â”€â†’ ç­”æ¡ˆ = max(steal, notSteal)
  â”‚
  â”œâ”€â†’ [é€’å½’åŸº]
  â”‚    â””â”€â†’ ç©ºèŠ‚ç‚¹è¿”å› (0, 0)
  â”‚
  â”œâ”€â†’ [å¤ç”¨æ¨¡æ¿]
  â”‚    â”œâ”€â†’ function robDFS(node):
  â”‚    â”‚    if not node: return (0, 0)
  â”‚    â”‚    leftSteal, leftNotSteal = robDFS(node.left)
  â”‚    â”‚    rightSteal, rightNotSteal = robDFS(node.right)
  â”‚    â”‚    steal = node.val + leftNotSteal + rightNotSteal
  â”‚    â”‚    notSteal = max(leftSteal, leftNotSteal) + max(rightSteal, rightNotSteal)
  â”‚    â”‚    return (steal, notSteal)
  â”‚    â””â”€â†’ return max(robDFS(root))
  â”‚
  â”œâ”€â†’ [æ—¶é—´å¤æ‚åº¦]
  â”‚    â””â”€â†’ O(n)
  â”‚
  â””â”€â†’ [ç©ºé—´å¤æ‚åº¦]
       â””â”€â†’ O(h) ï¼ˆé€’å½’æ ˆæ·±åº¦ï¼‰
```

> âœ… æ¯æ—¥ä¸€ç»ƒï¼šé»˜å†™ä»£ç  + æ‰‹ç”» `[3,2,3,null,3,null,1]` çš„é€’å½’è°ƒç”¨æ ˆä¸çŠ¶æ€æ¼”åŒ–
> ğŸš€ ä½ å·²æŒæ¡â€œæ ‘å½¢ DP æ¨¡æ¿â€èƒ½åŠ›ï¼Œä¸‹ä¸€é¢˜ï¼Œç»§ç»­å¾æœï¼ğŸ¤—
